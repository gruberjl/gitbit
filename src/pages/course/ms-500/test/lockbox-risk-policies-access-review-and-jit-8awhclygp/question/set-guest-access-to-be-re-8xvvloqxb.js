import {h, Component} from 'preact'
import Page from '../../../../../../components/page'
import {onAuthStateChanged} from '../../../../../../components/firebase/on-auth-state-changed'
import {getDoc} from '../../../../../../components/firebase/get-doc'
import saveDoc from '../../../../../../components/firebase/save-doc'
import Header from '../../../../../../components/test-question/header'
import Footer from '../../../../../../components/test-question/footer'
import Choice from '../../../../../../components/test-question/choice'
import HotArea from '../../../../../../components/test-question/hot-area'
import BuildList from '../../../../../../components/test-question/build-list'
import DragDrop from '../../../../../../components/test-question/drag-drop'
import Container from '@mui/material/Container'
import Grid from '@mui/material/Grid'
import Button from '@mui/material/Button'
import DialogTitle from '@mui/material/DialogTitle'
import Dialog from '@mui/material/Dialog'
import DialogContent from '@mui/material/DialogContent'
import DialogContentText from '@mui/material/DialogContentText'
import DialogActions from '@mui/material/DialogActions'
import Table from '@mui/material/Table'
import TableBody from '@mui/material/TableBody'
import TableCell from '@mui/material/TableCell'
import TableContainer from '@mui/material/TableContainer'
import TableHead from '@mui/material/TableHead'
import TableRow from '@mui/material/TableRow'
import debounce from 'debounce'
import Snackbar from '@mui/material/Snackbar'
import Checkbox from '@mui/material/Checkbox'
import Typography from '@mui/material/Typography'
const clone = require('clone')

const isBrowser = () => typeof window !== 'undefined'

class EditPage extends Component {
  constructor(props) {
    super(props)
    this.setUid = this.setUid.bind(this)
    this.toggleEndExam = this.toggleEndExam.bind(this)
    this.toggleShowAnswer = this.toggleShowAnswer.bind(this)
    this.toggleQuestionList = this.toggleQuestionList.bind(this)
    this.gotoQuestion = this.gotoQuestion.bind(this)
    this.setAnswer = this.setAnswer.bind(this)
    this.beforeUnload = this.beforeUnload.bind(this)
    this.save = this.save.bind(this)
    this.endExam = this.endExam.bind(this)
    this.navigateTo = this.navigateTo.bind(this)

    this.state = {
      uid: '',
      unsavedChanges: false,
      alert: '',
      answerShown: false,
      showQuestionList: false,
      question: {answerOptions: {'4uter2lma': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5r2ds', text: 'Grant John Gruber the Guest inviter role.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Grant John Gruber the Guest inviter role.</p>\n', id: '4uter2lma'}, dq7kscnpc: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9vpg4', text: 'Grant John Gruber the global admin role.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Grant John Gruber the global admin role.</p>\n', id: 'dq7kscnpc'}, gidetzqax: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8cvmh', text: 'In Azure Active Directory admin center modify the external collaboration settings.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>In Azure Active Directory admin center modify the external collaboration settings.</p>\n', id: 'gidetzqax'}, yszatxhb2: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5hl34', text: 'Create an access review policy.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Create an access review policy.</p>\n', id: 'yszatxhb2'}}, answerText: 'Grant John Gruber the Guest inviter role.Create an access review policy.', id: '8xvvloqxb', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'e3agd', text: 'Your manager has asked you to configure the following in Microsoft 365.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'fqck0', text: 'Set guest access to be reviewed every 30 days.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'o9i3', text: 'Grant John Gruber the ability to invite guests to the Microsoft 365 tenant.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '75qhl', text: 'Your organization adheres to the principle of least privilege.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '94n0d', text: 'What should you do?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your manager has asked you to configure the following in Microsoft 365.</p>\n<ul>\n<li>Set guest access to be reviewed every 30 days.</li>\n<li>Grant John Gruber the ability to invite guests to the Microsoft 365 tenant.</li>\n</ul>\n<p>Your organization adheres to the principle of least privilege.</p>\n<p>What should you do?</p>\n', questionText: 'Your manager has asked you to configure the following in Microsoft 365. Set guest access to be reviewed every 30 days. Grant John Gruber the ability to invite guests to the Microsoft 365 tenant. Your organization adheres to the principle of least privilege. What should you do?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '186gg', text: 'To configure guest access review you must create an access review policy.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 94, offset: 0}], inlineStyleRanges: [], key: 'd2pq3', text: 'https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'fspac', text: 'Assigning the Guest invited role to John Gruber will give him the ability to invite guests. Global admins can also invite guests but that would give John Gruber way too many permissions.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 95, offset: 0}], inlineStyleRanges: [], key: '874ud', text: 'https://www.gitbit.org/course/ms-500/learn/Creating-and-managing-admins-through-roles-7CpqFkPZU', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 2, length: 144, offset: 0}], inlineStyleRanges: [], key: 'd9rod', text: 'https://docs.microsoft.com/en-us/microsoft-365/solutions/create-secure-guest-sharing-environment?view=o365-worldwide#set-up-guest-access-reviews', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Creating-and-managing-admins-through-roles-7CpqFkPZU', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Creating-and-managing-admins-through-roles-7CpqFkPZU'}, mutability: 'MUTABLE', type: 'LINK'}, 2: {data: {href: 'https://docs.microsoft.com/en-us/microsoft-365/solutions/create-secure-guest-sharing-environment?view=o365-worldwide#set-up-guest-access-reviews', target: '_blank', url: 'https://docs.microsoft.com/en-us/microsoft-365/solutions/create-secure-guest-sharing-environment?view=o365-worldwide#set-up-guest-access-reviews'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>To configure guest access review you must create an access review policy.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2" target="_self">https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2</a></p>\n<p>Assigning the Guest invited role to John Gruber will give him the ability to invite guests. Global admins can also invite guests but that would give John Gruber way too many permissions.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Creating-and-managing-admins-through-roles-7CpqFkPZU" target="_self">https://www.gitbit.org/course/ms-500/learn/Creating-and-managing-admins-through-roles-7CpqFkPZU</a></p>\n<p><a href="https://docs.microsoft.com/en-us/microsoft-365/solutions/create-secure-guest-sharing-environment?view=o365-worldwide#set-up-guest-access-reviews" target="_self">https://docs.microsoft.com/en-us/microsoft-365/solutions/create-secure-guest-sharing-environment?view=o365-worldwide#set-up-guest-access-reviews</a></p>\n', slug: 'set-guest-access-to-be-re-8xvvloqxb', title: 'Set guest access to be reviewed every 30 days & Grant a user the ability to invite guests to the Microsoft 365 tenant', type: 'multiple-choice'},
      test: {answers: {'8xvvloqxb': {'4uter2lma': {id: '4uter2lma', isCorrect: true}, dq7kscnpc: {id: 'dq7kscnpc', isCorrect: false}, gidetzqax: {id: 'gidetzqax', isCorrect: false}, yszatxhb2: {id: 'yszatxhb2', isCorrect: true}}, _wkfzsmlj: {'n-dcsvk8j': {czl5okuce: {id: 'czl5okuce', isCorrect: true}, id: 'n-dcsvk8j', 'oawjfh-e5': {id: 'oawjfh-e5', isCorrect: false}, p8fwvr7oh: {id: 'p8fwvr7oh', isCorrect: false}, rfqqgxxak: {id: 'rfqqgxxak', isCorrect: false}}, ytrqore01: {'45kitamkl': {id: '45kitamkl', isCorrect: false}, id: 'ytrqore01', k6iqxfk0c: {id: 'k6iqxfk0c', isCorrect: false}, uauyt1kwb: {id: 'uauyt1kwb', isCorrect: true}}}, d2xfh6kdh: {qj1rri7ec: {id: 'qj1rri7ec', isCorrect: false}, ticowl39o: {id: 'ticowl39o', isCorrect: true}, yxat1iciv: {id: 'yxat1iciv', isCorrect: false}, z3ie0spo9: {id: 'z3ie0spo9', isCorrect: false}}, d9onv4eoh: {jiaiqw5zo: {id: 'jiaiqw5zo', isCorrect: false}, njione_ia: {id: 'njione_ia', isCorrect: false}, wbcazvg6e: {id: 'wbcazvg6e', isCorrect: true}}, hwhfyqcei: {gjtws5xo3: {id: 'gjtws5xo3', isCorrect: false}, idiphyemn: {id: 'idiphyemn', isCorrect: false}, jv8l8tmsr: {id: 'jv8l8tmsr', isCorrect: true}}, 'n-7rh0qa2': {'1julw1zzs': {id: '1julw1zzs', isCorrect: true}, '7lgq6-ecm': {id: '7lgq6-ecm', isCorrect: true}, jyen2ixoe: {id: 'jyen2ixoe', isCorrect: false}}, n0tzj6wii: {'djcn-i2we': {egmrilg4q: {id: 'egmrilg4q', isCorrect: true}, hxqovvrdi: {id: 'hxqovvrdi', isCorrect: false}, id: 'djcn-i2we', kyiwbb0mv: {id: 'kyiwbb0mv', isCorrect: false}}, ydonfbuee: {'2upimh13c': {id: '2upimh13c', isCorrect: false}, gwz0fmlor: {id: 'gwz0fmlor', isCorrect: true}, id: 'ydonfbuee', qmo0krlwl: {id: 'qmo0krlwl', isCorrect: false}}}, qd9rkqurd: {'0df6woemi': {id: '0df6woemi', 'ljm-uzhl3': {id: 'ljm-uzhl3', isCorrect: true}, lszjdwwvf: {id: 'lszjdwwvf', isCorrect: false}}, '5-iqelofh': {'9zaukw5b2': {id: '9zaukw5b2', isCorrect: false}, id: '5-iqelofh', w9qllrpiy: {id: 'w9qllrpiy', isCorrect: true}}, bkjo0uaaa: {dljwvn0xv: {id: 'dljwvn0xv', isCorrect: true}, id: 'bkjo0uaaa', kqrwgmblr: {id: 'kqrwgmblr', isCorrect: false}}}, ru52ojpin: {'bm0ijrh1-': {czzfyawp8: {id: 'czzfyawp8', isCorrect: false}, id: 'bm0ijrh1-', igadhmfbm: {id: 'igadhmfbm', isCorrect: false}, picutnnzv: {id: 'picutnnzv', isCorrect: false}, 'zxmf0k8u-': {id: 'zxmf0k8u-', isCorrect: true}}, vmqszle4ay: {'6dxckx1vlc': {id: '6dxckx1vlc', isCorrect: true}, alcg2s3o5: {id: 'alcg2s3o5', isCorrect: false}, bmrl4cvtk: {id: 'bmrl4cvtk', isCorrect: false}, id: 'vmqszle4ay', mbrgf5ba_a: {id: 'mbrgf5ba_a', isCorrect: false}}}}, datePublished: '2022/10/11', description: 'Microsoft 365 security administrator certificate (MS-500). Everything you need to know about lockbox, risk policies, access review, and JIT to pass the MS-500.', featuredImage: 'https://i.ibb.co/fNb2w5d/Users-At-Risk.png', id: '8awhclygp', images: ['https://i.ibb.co/x2c7qKJ/admins-and-roles.png', 'https://i.ibb.co/fNb2w5d/Users-At-Risk.png'], publish: true, questions: {'8xvvloqxb': {answerOptions: {'4uter2lma': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5r2ds', text: 'Grant John Gruber the Guest inviter role.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Grant John Gruber the Guest inviter role.</p>\n', id: '4uter2lma'}, dq7kscnpc: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9vpg4', text: 'Grant John Gruber the global admin role.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Grant John Gruber the global admin role.</p>\n', id: 'dq7kscnpc'}, gidetzqax: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8cvmh', text: 'In Azure Active Directory admin center modify the external collaboration settings.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>In Azure Active Directory admin center modify the external collaboration settings.</p>\n', id: 'gidetzqax'}, yszatxhb2: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5hl34', text: 'Create an access review policy.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Create an access review policy.</p>\n', id: 'yszatxhb2'}}, answerText: 'Grant John Gruber the Guest inviter role.Create an access review policy.', id: '8xvvloqxb', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'e3agd', text: 'Your manager has asked you to configure the following in Microsoft 365.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'fqck0', text: 'Set guest access to be reviewed every 30 days.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'o9i3', text: 'Grant John Gruber the ability to invite guests to the Microsoft 365 tenant.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '75qhl', text: 'Your organization adheres to the principle of least privilege.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '94n0d', text: 'What should you do?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your manager has asked you to configure the following in Microsoft 365.</p>\n<ul>\n<li>Set guest access to be reviewed every 30 days.</li>\n<li>Grant John Gruber the ability to invite guests to the Microsoft 365 tenant.</li>\n</ul>\n<p>Your organization adheres to the principle of least privilege.</p>\n<p>What should you do?</p>\n', questionText: 'Your manager has asked you to configure the following in Microsoft 365. Set guest access to be reviewed every 30 days. Grant John Gruber the ability to invite guests to the Microsoft 365 tenant. Your organization adheres to the principle of least privilege. What should you do?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '186gg', text: 'To configure guest access review you must create an access review policy.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 94, offset: 0}], inlineStyleRanges: [], key: 'd2pq3', text: 'https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'fspac', text: 'Assigning the Guest invited role to John Gruber will give him the ability to invite guests. Global admins can also invite guests but that would give John Gruber way too many permissions.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 95, offset: 0}], inlineStyleRanges: [], key: '874ud', text: 'https://www.gitbit.org/course/ms-500/learn/Creating-and-managing-admins-through-roles-7CpqFkPZU', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 2, length: 144, offset: 0}], inlineStyleRanges: [], key: 'd9rod', text: 'https://docs.microsoft.com/en-us/microsoft-365/solutions/create-secure-guest-sharing-environment?view=o365-worldwide#set-up-guest-access-reviews', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Creating-and-managing-admins-through-roles-7CpqFkPZU', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Creating-and-managing-admins-through-roles-7CpqFkPZU'}, mutability: 'MUTABLE', type: 'LINK'}, 2: {data: {href: 'https://docs.microsoft.com/en-us/microsoft-365/solutions/create-secure-guest-sharing-environment?view=o365-worldwide#set-up-guest-access-reviews', target: '_blank', url: 'https://docs.microsoft.com/en-us/microsoft-365/solutions/create-secure-guest-sharing-environment?view=o365-worldwide#set-up-guest-access-reviews'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>To configure guest access review you must create an access review policy.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2" target="_self">https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2</a></p>\n<p>Assigning the Guest invited role to John Gruber will give him the ability to invite guests. Global admins can also invite guests but that would give John Gruber way too many permissions.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Creating-and-managing-admins-through-roles-7CpqFkPZU" target="_self">https://www.gitbit.org/course/ms-500/learn/Creating-and-managing-admins-through-roles-7CpqFkPZU</a></p>\n<p><a href="https://docs.microsoft.com/en-us/microsoft-365/solutions/create-secure-guest-sharing-environment?view=o365-worldwide#set-up-guest-access-reviews" target="_self">https://docs.microsoft.com/en-us/microsoft-365/solutions/create-secure-guest-sharing-environment?view=o365-worldwide#set-up-guest-access-reviews</a></p>\n', slug: 'set-guest-access-to-be-re-8xvvloqxb', title: 'Set guest access to be reviewed every 30 days & Grant a user the ability to invite guests to the Microsoft 365 tenant', type: 'multiple-choice'}, _wkfzsmlj: {answerOptions: {'n-dcsvk8j': {answerHtml: '', answers: {czl5okuce: {id: 'czl5okuce', text: 'Upon completion settings'}, 'oawjfh-e5': {id: 'oawjfh-e5', text: 'Programs settings'}, p8fwvr7oh: {id: 'p8fwvr7oh', text: 'Advanced settings'}, rfqqgxxak: {id: 'rfqqgxxak', text: 'Reviewers settings'}}, id: 'n-dcsvk8j', text: 'To ensure that access is removed if an administrator fails to respond, configure the:'}, ytrqore01: {answerHtml: '', answers: {'45kitamkl': {id: '45kitamkl', text: 'one time'}, k6iqxfk0c: {id: 'k6iqxfk0c', text: 'weekly'}, uauyt1kwb: {id: 'uauyt1kwb', text: 'monthly'}}, id: 'ytrqore01', text: 'Set the frequency to'}}, id: '_wkfzsmlj', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8epvm', text: 'Access to the Azure AD admin center by any user administrators must be reviewed monthly. The user must lose access if they don\'t respond within 7 days of the access request.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'bg6eu', text: 'You create an access review policy and specify the scope and group.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'e574n', text: 'What other settings do you need to configure?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Access to the Azure AD admin center by any user administrators must be reviewed monthly. The user must lose access if they don\'t respond within 7 days of the access request.</p>\n<p>You create an access review policy and specify the scope and group.</p>\n<p>What other settings do you need to configure?</p>\n', questionText: 'Access to the Azure AD admin center by any user administrators must be reviewed monthly. The user must lose access if they don\'t respond within 7 days of the access request. You create an access review policy and specify the scope and group. What other settings do you need to configure?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'st1', text: 'A frequency of monthly allows you to set the number of days the user has to respond (between 1-30)', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7dmqh', text: 'The upon completion settings allows you to remove the permissions/role from a user if they don\'t respond in time.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 94, offset: 0}], inlineStyleRanges: [], key: 'al7h4', text: 'https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>A frequency of monthly allows you to set the number of days the user has to respond (between 1-30)</p>\n<p>The upon completion settings allows you to remove the permissions/role from a user if they don\'t respond in time.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2" target="_self">https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2</a></p>\n', slug: 'what-settings-do-you-need-_wkfzsmlj', title: 'What settings do you need to configure to create an access review policy?', type: 'hot-area'}, d2xfh6kdh: {answerOptions: {qj1rri7ec: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9900k', text: 'The Data subject requests in the Microsoft Compliance admin center', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>The Data subject requests in the Microsoft Compliance admin center</p>\n', id: 'qj1rri7ec'}, ticowl39o: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'bu1up', text: 'The Customer lockbox requests section in the Microsoft 365 admin center', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>The Customer lockbox requests section in the Microsoft 365 admin center</p>\n', id: 'ticowl39o'}, yxat1iciv: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2976l', text: 'The Supervision section in the Microsoft Defender admin center', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>The Supervision section in the Microsoft Defender admin center</p>\n', id: 'yxat1iciv'}, z3ie0spo9: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4adn3', text: 'The Security & privacy section in the Microsoft 365 admin center', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>The Security &amp; privacy section in the Microsoft 365 admin center</p>\n', id: 'z3ie0spo9'}}, id: 'd2xfh6kdh', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'akmdd', text: 'Your organization uses Microsoft 365. Your organization has recently purchased and applied Microsoft 365 E5 licenses for every user.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1ku2s', text: 'Your manager has been tasked with securing the Microsoft 365 tenant. He has configured Customer Lockbox to require Microsoft 365 engineers to request your permission to access data in your tenant. Your manager has asked you to teach everyone how to approve Customer Lockbox requests.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'drsc9', text: '', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1lp3n', text: 'Where can you go to approve Customer Lockbox requests?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your organization uses Microsoft 365. Your organization has recently purchased and applied Microsoft 365 E5 licenses for every user.</p>\n<p>Your manager has been tasked with securing the Microsoft 365 tenant. He has configured Customer Lockbox to require Microsoft 365 engineers to request your permission to access data in your tenant. Your manager has asked you to teach everyone how to approve Customer Lockbox requests.</p>\n<p></p>\n<p>Where can you go to approve Customer Lockbox requests?</p>\n', questionText: 'Your organization uses Microsoft 365. Your organization has recently purchased and applied Microsoft 365 E5 licenses for every user. Your manager has been tasked with securing the Microsoft 365 tenant. He has configured Customer Lockbox to require Microsoft 365 engineers to request your permission to access data in your tenant. Your manager has asked you to teach everyone how to approve Customer Lockbox requests. Where can you go to approve Customer Lockbox requests?', references: {blocks: [{data: {}, depth: 0, entityRanges: [{key: 0, length: 116, offset: 0}], inlineStyleRanges: [], key: '2797u', text: 'https://www.gitbit.org/course/ms-500/learn/Locking-down-your-Microsoft-365-tenant-from-Microsoft-engineers-FldNualGC', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3nu2j', text: 'Lockbox requests will appear in the Microsoft 365 admin center in the Customer lockbox requests section.', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Locking-down-your-Microsoft-365-tenant-from-Microsoft-engineers-FldNualGC', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Locking-down-your-Microsoft-365-tenant-from-Microsoft-engineers-FldNualGC'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p><a href="https://www.gitbit.org/course/ms-500/learn/Locking-down-your-Microsoft-365-tenant-from-Microsoft-engineers-FldNualGC" target="_self">https://www.gitbit.org/course/ms-500/learn/Locking-down-your-Microsoft-365-tenant-from-Microsoft-engineers-FldNualGC</a></p>\n<p>Lockbox requests will appear in the Microsoft 365 admin center in the Customer lockbox requests section.</p>\n', slug: 'where-can-you-go-to-appro-d2xfh6kdh', title: 'Where can you go to approve Customer Lockbox requests?', type: 'multiple-choice'}, d9onv4eoh: {answerOptions: {jiaiqw5zo: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'bck96', text: 'When UserC submits a request to activate the role, User3 can approve the request.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>When UserC submits a request to activate the role, User3 can approve the request.</p>\n', id: 'jiaiqw5zo'}, njione_ia: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1mand', text: 'When UserB submits a request to activate the role, User2 can approve the request.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>When UserB submits a request to activate the role, User2 can approve the request.</p>\n', id: 'njione_ia'}, wbcazvg6e: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '77dv0', text: 'When UserB submits a request to activate the role, User1 can approve the request.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>When UserB submits a request to activate the role, User1 can approve the request.</p>\n', id: 'wbcazvg6e'}}, answerText: 'When UserB submits a request to activate the role, User1 can approve the request.', id: 'd9onv4eoh', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5mb00', text: 'your organization has a Microsoft 365 tenant with the following users.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: '9eom6', text: '📷', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'b4gae', text: 'Your organization has implemented Azure Active Directory (Azure AD) Privileged Identity Management (PIM).', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3jah4', text: 'From PIM, you see the Application Administrator role has the following users.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 1, offset: 0}], inlineStyleRanges: [], key: '82h02', text: '📷', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'qrbn', text: 'PIM is configured to use the following settings for users with the Application Administrator role assigned.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2srd7', text: 'Require approval to activate: Yes', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9aua5', text: 'Approvers: None', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'b7mh6', text: 'Check the box next to each true statement.', type: 'unstyled'}], entityMap: {0: {data: {alt: 'Name Role Chart', src: 'https://i.ibb.co/Cs1cMM8/Chart5.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}, 1: {data: {alt: 'Name Assignment Type Chart', src: 'https://i.ibb.co/FVBbzdZ/Chart6.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>your organization has a Microsoft 365 tenant with the following users.</p>\n<p><img src="https://i.ibb.co/Cs1cMM8/Chart5.png" alt="Name Role Chart" style="height: undefined;width: undefined"/></p>\n<p>Your organization has implemented Azure Active Directory (Azure AD) Privileged Identity Management (PIM).</p>\n<p>From PIM, you see the Application Administrator role has the following users.</p>\n<p><img src="https://i.ibb.co/FVBbzdZ/Chart6.png" alt="Name Assignment Type Chart" style="height: undefined;width: undefined"/></p>\n<p>PIM is configured to use the following settings for users with the Application Administrator role assigned.</p>\n<ul>\n<li>Require approval to activate: Yes</li>\n<li>Approvers: None</li>\n</ul>\n<p>Check the box next to each true statement.</p>\n', questionText: 'your organization has a Microsoft 365 tenant with the following users. 📷 Your organization has implemented Azure Active Directory (Azure AD) Privileged Identity Management (PIM). From PIM, you see the Application Administrator role has the following users. 📷 PIM is configured to use the following settings for users with the Application Administrator role assigned. Require approval to activate: Yes Approvers: None Check the box next to each true statement.', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4kns', text: 'Only global administrators and privileged role administrators can approve the admin role assignments.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 124, offset: 0}], inlineStyleRanges: [], key: 'cden4', text: 'https://www.gitbit.org/course/ms-500/learn/Just-in-time-approval-and-notification-for-admin-roles-in-Microsoft-365-RHW1API2s', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Just-in-time-approval-and-notification-for-admin-roles-in-Microsoft-365-RHW1API2s', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Just-in-time-approval-and-notification-for-admin-roles-in-Microsoft-365-RHW1API2s'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>Only global administrators and privileged role administrators can approve the admin role assignments.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Just-in-time-approval-and-notification-for-admin-roles-in-Microsoft-365-RHW1API2s" target="_self">https://www.gitbit.org/course/ms-500/learn/Just-in-time-approval-and-notification-for-admin-roles-in-Microsoft-365-RHW1API2s</a></p>\n', slug: 'who-can-approve-the-pim-r-d9onv4eoh', title: 'Who can approve the PIM role activation?', type: 'multiple-choice'}, hwhfyqcei: {answerOptions: {gjtws5xo3: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7bvi7', text: 'User2', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>User2</p>\n', id: 'gjtws5xo3'}, idiphyemn: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'a0bao', text: 'User3', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>User3</p>\n', id: 'idiphyemn'}, jv8l8tmsr: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5354c', text: 'User1', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>User1</p>\n', id: 'jv8l8tmsr'}}, answerText: 'User1.', id: 'hwhfyqcei', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '30hmf', text: 'your organization has a Microsoft 365 tenant that contains the following users.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: 'ctmj', text: '📷', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5b7pn', text: 'You configure an Azure AD Identity Protection sign-in risk policy with the following settings:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '49b98', text: 'Assigned to Group1 and excludes Group2.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'er6lp', text: 'Only apply if the user risk level is medium or above.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'bqeq4', text: 'If the user risk level is medium or above allow access but require a password change.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '86njp', text: 'The risk level for each user is shown below.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 1, offset: 0}], inlineStyleRanges: [], key: 'fbs57', text: '📷', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7g9se', text: 'Which users will be required to change their password?', type: 'unstyled'}], entityMap: {0: {data: {alt: 'Chart showing users and groups', src: 'https://i.ibb.co/WVjQP2K/chart7.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}, 1: {data: {alt: 'Chart showing user risk level', src: 'https://i.ibb.co/LxsWp5S/Chart8.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>your organization has a Microsoft 365 tenant that contains the following users.</p>\n<p><img src="https://i.ibb.co/WVjQP2K/chart7.png" alt="Chart showing users and groups" style="height: undefined;width: undefined"/></p>\n<p>You configure an Azure AD Identity Protection sign-in risk policy with the following settings:</p>\n<ul>\n<li>Assigned to Group1 and excludes Group2.</li>\n<li>Only apply if the user risk level is medium or above.</li>\n<li>If the user risk level is medium or above allow access but require a password change.</li>\n</ul>\n<p>The risk level for each user is shown below.</p>\n<p><img src="https://i.ibb.co/LxsWp5S/Chart8.png" alt="Chart showing user risk level" style="height: undefined;width: undefined"/></p>\n<p>Which users will be required to change their password?</p>\n', questionText: 'your organization has a Microsoft 365 tenant that contains the following users. 📷 You configure an Azure AD Identity Protection sign-in risk policy with the following settings: Assigned to Group1 and excludes Group2. Only apply if the user risk level is medium or above. If the user risk level is medium or above allow access but require a password change. The risk level for each user is shown below. 📷 Which users will be required to change their password?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [{length: 45, offset: 0, style: 'BOLD'}], key: '8vu0h', text: 'User1 will be required to change his password', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'esp8n', text: 'User1 is in Group1 which the policy applies.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [{length: 49, offset: 0, style: 'BOLD'}], key: '5j92u', text: 'User2 will not be required to change his password', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'dhn1e', text: 'User2 is in Group2 which is excluded from the policy.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [{length: 49, offset: 0, style: 'BOLD'}], key: 'ak7bc', text: 'User3 will not be required to change his password', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'l6u6', text: 'User3 is in Group1 which is included in the policy but is also in Group2 which is excluded from the policy. In this case, the exclusion wins so the policy does not apply to User3.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 123, offset: 0}], inlineStyleRanges: [], key: 'bpucq', text: 'https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p><strong>User1 will be required to change his password</strong></p>\n<p>User1 is in Group1 which the policy applies.</p>\n<p><strong>User2 will not be required to change his password</strong></p>\n<p>User2 is in Group2 which is excluded from the policy.</p>\n<p><strong>User3 will not be required to change his password</strong></p>\n<p>User3 is in Group1 which is included in the policy but is also in Group2 which is excluded from the policy. In this case, the exclusion wins so the policy does not apply to User3.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ" target="_self">https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ</a></p>\n', slug: 'which-users-will-be-requi-hwhfyqcei', title: 'Which users will be required to change their password?', type: 'multiple-choice'}, 'n-7rh0qa2': {answerOptions: {'1julw1zzs': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8efap', text: 'User1', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>User1</p>\n', id: '1julw1zzs'}, '7lgq6-ecm': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'apbfj', text: 'User2', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>User2</p>\n', id: '7lgq6-ecm'}, jyen2ixoe: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '10kd5', text: 'User3', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>User3</p>\n', id: 'jyen2ixoe'}}, answerText: 'User2. User1.', id: 'n-7rh0qa2', images: ['https://i.ibb.co/x2c7qKJ/admins-and-roles.png'], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2t679', text: 'You have a Microsoft 365 E5 subscription that contains the users shown in the following table.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: 'abcrn', text: ' ', type: 'atomic'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5akmg', text: 'Your organization has Customer Lockbox enabled.\nWhich admins will receive a notification when a Microsoft engineer requests access to your organization?', type: 'unstyled'}], entityMap: {0: {data: {alt: 'Admins and their roles', src: 'https://i.ibb.co/x2c7qKJ/admins-and-roles.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>You have a Microsoft 365 E5 subscription that contains the users shown in the following table.</p>\n<img src="https://i.ibb.co/x2c7qKJ/admins-and-roles.png" alt="Admins and their roles" style="height: undefined;width: undefined"/>\n<p>Your organization has Customer Lockbox enabled.<br>Which admins will receive a notification when a Microsoft engineer requests access to your organization?</p>\n', questionText: 'You have a Microsoft 365 E5 subscription that contains the users shown in the following table. Your organization has Customer Lockbox enabled. Which admins will receive a notification when a Microsoft engineer requests access to your organization?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'fsgme', text: 'The following admins can approve Lockbox requests and will receive notifications when a Microsoft engineer requests access.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9h91g', text: 'Global administrators', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '402cp', text: 'Customer Lockbox access', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'dfgjr', text: 'https://www.gitbit.org/course/ms-500/learn/Locking-down-your-Microsoft-365-tenant-from-Microsoft-engineers-FldNualGC', type: 'unstyled'}], entityMap: {}}, referencesHtml: '<p>The following admins can approve Lockbox requests and will receive notifications when a Microsoft engineer requests access.</p>\n<ul>\n<li>Global administrators</li>\n<li>Customer Lockbox access</li>\n</ul>\n<p>https://www.gitbit.org/course/ms-500/learn/Locking-down-your-Microsoft-365-tenant-from-Microsoft-engineers-FldNualGC</p>\n', slug: 'which-admins-will-receive-n-7rh0qa2', title: 'Which admins will receive a notification when a Microsoft engineer requests access to your organization?', type: 'multiple-choice'}, n0tzj6wii: {answerOptions: {'djcn-i2we': {answerHtml: '', answers: {egmrilg4q: {id: 'egmrilg4q', text: 'Roles'}, hxqovvrdi: {id: 'hxqovvrdi', text: 'Access reviews'}, kyiwbb0mv: {id: 'kyiwbb0mv', text: 'Alerts'}}, id: 'djcn-i2we', text: 'Admins need to be informed when the Security administrator role is activated:'}, ydonfbuee: {answerHtml: '', answers: {'2upimh13c': {id: '2upimh13c', text: 'Roles'}, gwz0fmlor: {id: 'gwz0fmlor', text: 'Access reviews'}, qmo0krlwl: {id: 'qmo0krlwl', text: 'Alerts'}}, id: 'ydonfbuee', text: 'Users assigned the Security Administrator role need to be automatically removed if they don\'t log in for 30 days:'}}, answerText: 'Roles. Access reviews.', id: 'n0tzj6wii', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ee31g', text: 'Your organization has a Microsoft 365 tenant.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'c4p4b', text: 'Your manager has asked you to re-configure the Microsoft 365 tenant to meet the following security requirements:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2eu89', text: 'Admins need to be informed when the Security administrator role is activated.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '484nv', text: 'Users assigned the Security Administrator role need to be automatically removed if they don\'t log in for 30 days.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '47rtc', text: 'Which Azure AD PIM setting should you re-configure to meet the security requirements.', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant.</p>\n<p>Your manager has asked you to re-configure the Microsoft 365 tenant to meet the following security requirements:</p>\n<ul>\n<li>Admins need to be informed when the Security administrator role is activated.</li>\n<li>Users assigned the Security Administrator role need to be automatically removed if they don\'t log in for 30 days.</li>\n</ul>\n<p>Which Azure AD PIM setting should you re-configure to meet the security requirements.</p>\n', questionText: 'Your organization has a Microsoft 365 tenant. Your manager has asked you to re-configure the Microsoft 365 tenant to meet the following security requirements: Admins need to be informed when the Security administrator role is activated. Users assigned the Security Administrator role need to be automatically removed if they don\'t log in for 30 days. Which Azure AD PIM setting should you re-configure to meet the security requirements.', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'c23nd', text: '"Admins need to be informed when the Security administrator role is activated" is located under the Roles section.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'mefg', text: '"Users assigned the Security Administrator role need to be automatically removed if they don\'t log in for 30 days" is located in the Access reviews section.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 94, offset: 0}], inlineStyleRanges: [], key: 'f8jgb', text: 'https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 137, offset: 0}], inlineStyleRanges: [], key: '4ttob', text: 'https://docs.microsoft.com/bs-latn-ba/azure/active-directory/privileged-identity-management/pim-how-to-configure-security-alerts?tabs=new', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 2, length: 135, offset: 0}], inlineStyleRanges: [], key: '1ui7g', text: 'https://docs.microsoft.com/bs-latn-ba/azure/active-directory/privileged-identity-management/pim-how-to-change-default-settings?tabs=new', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/bs-latn-ba/azure/active-directory/privileged-identity-management/pim-how-to-configure-security-alerts?tabs=new', target: '_blank', url: 'https://docs.microsoft.com/bs-latn-ba/azure/active-directory/privileged-identity-management/pim-how-to-configure-security-alerts?tabs=new'}, mutability: 'MUTABLE', type: 'LINK'}, 2: {data: {href: 'https://docs.microsoft.com/bs-latn-ba/azure/active-directory/privileged-identity-management/pim-how-to-change-default-settings?tabs=new', target: '_blank', url: 'https://docs.microsoft.com/bs-latn-ba/azure/active-directory/privileged-identity-management/pim-how-to-change-default-settings?tabs=new'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>"Admins need to be informed when the Security administrator role is activated" is located under the Roles section.</p>\n<p>"Users assigned the Security Administrator role need to be automatically removed if they don\'t log in for 30 days" is located in the Access reviews section.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2" target="_self">https://www.gitbit.org/course/ms-500/learn/Automating-Access-Review-in-Microsoft-365-rK48f6iM2</a></p>\n<p><a href="https://docs.microsoft.com/bs-latn-ba/azure/active-directory/privileged-identity-management/pim-how-to-configure-security-alerts?tabs=new" target="_self">https://docs.microsoft.com/bs-latn-ba/azure/active-directory/privileged-identity-management/pim-how-to-configure-security-alerts?tabs=new</a></p>\n<p><a href="https://docs.microsoft.com/bs-latn-ba/azure/active-directory/privileged-identity-management/pim-how-to-change-default-settings?tabs=new" target="_self">https://docs.microsoft.com/bs-latn-ba/azure/active-directory/privileged-identity-management/pim-how-to-change-default-settings?tabs=new</a></p>\n', slug: 'which-azure-ad-pim-settin-n0tzj6wii', title: 'Which Azure AD PIM setting should you re-configure to meet the security requirements.', type: 'hot-area'}, qd9rkqurd: {answerOptions: {'0df6woemi': {answerHtml: '', answers: {'ljm-uzhl3': {id: 'ljm-uzhl3', text: 'No'}, lszjdwwvf: {id: 'lszjdwwvf', text: 'Yes'}}, id: '0df6woemi', text: 'User2 receives 3 email alerts from Azure AD Identity Protection'}, '5-iqelofh': {answerHtml: '', answers: {'9zaukw5b2': {id: '9zaukw5b2', text: 'Yes'}, w9qllrpiy: {id: 'w9qllrpiy', text: 'No'}}, id: '5-iqelofh', text: 'John Gruber receives 3 email alerts from Azure AD Identity Protection'}, bkjo0uaaa: {answerHtml: '', answers: {dljwvn0xv: {id: 'dljwvn0xv', text: 'No'}, kqrwgmblr: {id: 'kqrwgmblr', text: 'Yes'}}, id: 'bkjo0uaaa', text: 'User3 receives 2 email alerts from Azure AD Identity Protection'}}, answerText: 'No. No. No.', id: 'qd9rkqurd', images: ['https://i.ibb.co/fNb2w5d/Users-At-Risk.png'], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'f58gv', text: 'You have a Microsoft 365 tenant with Microsoft 365 E5 licenses.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3987v', text: 'A user named John Gruber is configured to receive alerts from Azure AD Identity Protection as shown below.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: '7pnjh', text: ' ', type: 'atomic'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '72aik', text: 'Your tenant contains the following users.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 1, offset: 0}], inlineStyleRanges: [], key: '8srp4', text: '📷', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5n8re', text: 'The user sign-in log is shown below', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 2, length: 1, offset: 0}], inlineStyleRanges: [], key: 'doaeu', text: '📷', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'fadsm', text: 'Select Yes if the statement is true. If the statement is not true select No.', type: 'unstyled'}], entityMap: {0: {data: {alt: 'Users at risk', src: 'https://i.ibb.co/fNb2w5d/Users-At-Risk.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}, 1: {data: {alt: 'User role chart', src: 'https://i.ibb.co/wzLBtGJ/user-role-chart.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}, 2: {data: {alt: 'User RIsk Chart', src: 'https://i.ibb.co/dDHb6VK/user-risk-chart.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>You have a Microsoft 365 tenant with Microsoft 365 E5 licenses.</p>\n<p>A user named John Gruber is configured to receive alerts from Azure AD Identity Protection as shown below.</p>\n<img src="https://i.ibb.co/fNb2w5d/Users-At-Risk.png" alt="Users at risk" style="height: undefined;width: undefined"/>\n<p>Your tenant contains the following users.</p>\n<p><img src="https://i.ibb.co/wzLBtGJ/user-role-chart.png" alt="User role chart" style="height: undefined;width: undefined"/></p>\n<p>The user sign-in log is shown below</p>\n<p><img src="https://i.ibb.co/dDHb6VK/user-risk-chart.png" alt="User RIsk Chart" style="height: undefined;width: undefined"/></p>\n<p>Select Yes if the statement is true. If the statement is not true select No.</p>\n', questionText: 'You have a Microsoft 365 tenant with Microsoft 365 E5 licenses. A user named John Gruber is configured to receive alerts from Azure AD Identity Protection as shown below. Your tenant contains the following users. 📷 The user sign-in log is shown below 📷 Select Yes if the statement is true. If the statement is not true select No.', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [{length: 9, offset: 0, style: 'BOLD'}], key: '3qma9', text: 'Box 1: No', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1aevu', text: 'John Gruber will receive two alerts.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3onug', text: 'Sign-ins from an infected device are classified as low. John Gruber will receive alerts on the unfamiliar location and anonymous IP address though.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [{length: 9, offset: 0, style: 'BOLD'}], key: '700l8', text: 'Box 2: No', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'd60rv', text: 'User2 will receive two alerts. Email alerts are sent to all global admins, security admins, and security readers', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'cmeqk', text: 'Sign-ins from the infected device are classified as low.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [{length: 9, offset: 0, style: 'BOLD'}], key: '1h9ue', text: 'Box 3: No', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'hl9n', text: 'User3 will not receive alerts. Email alerts are sent to all global admins, security admins, and security readers by default.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 123, offset: 0}], inlineStyleRanges: [], key: '8c02p', text: 'https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 104, offset: 0}], inlineStyleRanges: [], key: 'dua1q', text: 'https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/overview-identity-protection', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 2, length: 125, offset: 0}], inlineStyleRanges: [], key: '14v9o', text: 'https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/howto-identity-protection-configure-risk-policies', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/overview-identity-protection', target: '_blank', url: 'https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/overview-identity-protection'}, mutability: 'MUTABLE', type: 'LINK'}, 2: {data: {href: 'https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/overview-identity-protection', target: '_blank', url: 'https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/overview-identity-protection'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p><strong>Box 1: No</strong></p>\n<p>John Gruber will receive two alerts.</p>\n<p>Sign-ins from an infected device are classified as low. John Gruber will receive alerts on the unfamiliar location and anonymous IP address though.</p>\n<p><strong>Box 2: No</strong></p>\n<p>User2 will receive two alerts. Email alerts are sent to all global admins, security admins, and security readers</p>\n<p>Sign-ins from the infected device are classified as low.</p>\n<p><strong>Box 3: No</strong></p>\n<p>User3 will not receive alerts. Email alerts are sent to all global admins, security admins, and security readers by default.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ" target="_self">https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ</a></p>\n<p><a href="https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/overview-identity-protection" target="_self">https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/overview-identity-protection</a></p>\n<p><a href="https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/overview-identity-protection" target="_self">https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/howto-identity-protection-configure-risk-policies</a></p>\n', slug: 'what-users-and-how-many-a-qd9rkqurd', title: 'What users and how many alerts will the receive?', type: 'hot-area'}, ru52ojpin: {answerOptions: {'bm0ijrh1-': {answerHtml: '', answers: {czzfyawp8: {id: 'czzfyawp8', text: 'Both User1 and User2'}, igadhmfbm: {id: 'igadhmfbm', text: 'Neither User1 nor User2'}, picutnnzv: {id: 'picutnnzv', text: 'User2 only'}, 'zxmf0k8u-': {id: 'zxmf0k8u-', text: 'User1 only'}}, id: 'bm0ijrh1-', text: 'Must change their password'}, vmqszle4ay: {answerHtml: '', answers: {'6dxckx1vlc': {id: '6dxckx1vlc', text: 'User2 only'}, alcg2s3o5: {id: 'alcg2s3o5', text: 'User1 only'}, bmrl4cvtk: {id: 'bmrl4cvtk', text: 'Both User1 and User2'}, mbrgf5ba_a: {id: 'mbrgf5ba_a', text: 'Neither User1 nor User2'}}, id: 'vmqszle4ay', text: 'Prompted for MFA'}}, answerText: 'User2 only. User1 only.', id: 'ru52ojpin', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8342q', text: 'You have a Microsoft Azure Active Directory (Azure AD) tenant named contoso.com that contains the users shown in the following table.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: '4bv8i', text: '📷', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '23r3o', text: 'You create and enforce an Azure AD Identity Protection user risk policy that has the following settings:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'agad3', text: 'Assignments: Include Group1, Exclude Group2', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '842m0', text: 'Conditions: Sign-in risk of Low and above', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9r5h5', text: 'Access: Allow access, Require password change', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3u7g6', text: 'You need to identify how the policy affects User1 and User2.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'cdhuk', text: 'What occurs when User1 and User2 sign in from an unfamiliar location?', type: 'unstyled'}], entityMap: {0: {data: {alt: 'User, group, MFA status chart', src: 'https://i.ibb.co/ctNx9tq/Chart3.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>You have a Microsoft Azure Active Directory (Azure AD) tenant named contoso.com that contains the users shown in the following table.</p>\n<p><img src="https://i.ibb.co/ctNx9tq/Chart3.png" alt="User, group, MFA status chart" style="height: undefined;width: undefined"/></p>\n<p>You create and enforce an Azure AD Identity Protection user risk policy that has the following settings:</p>\n<ul>\n<li>Assignments: Include Group1, Exclude Group2</li>\n<li>Conditions: Sign-in risk of Low and above</li>\n<li>Access: Allow access, Require password change</li>\n</ul>\n<p>You need to identify how the policy affects User1 and User2.</p>\n<p>What occurs when User1 and User2 sign in from an unfamiliar location?</p>\n', questionText: 'You have a Microsoft Azure Active Directory (Azure AD) tenant named contoso.com that contains the users shown in the following table. 📷 You create and enforce an Azure AD Identity Protection user risk policy that has the following settings: Assignments: Include Group1, Exclude Group2 Conditions: Sign-in risk of Low and above Access: Allow access, Require password change You need to identify how the policy affects User1 and User2. What occurs when User1 and User2 sign in from an unfamiliar location?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'qabm', text: 'Unfamiliar location sign-in is considered a low risk so the user risk policy would initiate. Group1 is assigned in the user risk policy and Group2 is excluded so only User1 is affected by the policy so only User1 will be required to change their password.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7a4bi', text: 'User1 isn\'t configured for MFA but User2 is so only User2 will be prompted for MFA.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 123, offset: 0}], inlineStyleRanges: [], key: 'ak3e1', text: 'https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 128, offset: 0}], inlineStyleRanges: [], key: 'dh5iq', text: 'https://www.gitbit.org/course/ms-500/learn/The-many-ways-to-implement-multi-factor-authentication-MFA-in-Microsoft-365-nAAIvNbtk', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 2, length: 114, offset: 0}], inlineStyleRanges: [], key: 'bs73n', text: 'https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/concept-conditional-access-users-groups', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/The-many-ways-to-implement-multi-factor-authentication-MFA-in-Microsoft-365-nAAIvNbtk', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/The-many-ways-to-implement-multi-factor-authentication-MFA-in-Microsoft-365-nAAIvNbtk'}, mutability: 'MUTABLE', type: 'LINK'}, 2: {data: {href: 'https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/concept-conditional-access-users-groups', target: '_blank', url: 'https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/concept-conditional-access-users-groups'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>Unfamiliar location sign-in is considered a low risk so the user risk policy would initiate. Group1 is assigned in the user risk policy and Group2 is excluded so only User1 is affected by the policy so only User1 will be required to change their password.</p>\n<p>User1 isn\'t configured for MFA but User2 is so only User2 will be prompted for MFA.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ" target="_self">https://www.gitbit.org/course/ms-500/learn/Implementing-intelligent-security-using-risk-policies-in-Microsoft-365-NFQ6rYFeQ</a></p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/The-many-ways-to-implement-multi-factor-authentication-MFA-in-Microsoft-365-nAAIvNbtk" target="_self">https://www.gitbit.org/course/ms-500/learn/The-many-ways-to-implement-multi-factor-authentication-MFA-in-Microsoft-365-nAAIvNbtk</a></p>\n<p><a href="https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/concept-conditional-access-users-groups" target="_self">https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/concept-conditional-access-users-groups</a></p>\n', slug: 'what-occurs-when-user1-an-ru52ojpin', title: 'What occurs when User1 and User2 sign in from an unfamiliar location?', type: 'hot-area'}}, sectionId: 'AFV_acckJ', slug: 'lockbox-risk-policies-access-review-and-jit-8awhclygp', title: 'Lockbox, risk policies, access review, and JIT', type: 'test'},
      questionsShown: false
    }

    this.state.userAcct = {tests: {
      [this.state.test.id]: {
        [this.state.question.id]: {answers: {}}
      }
    }}

    this.state.questionIdx = Object.keys(this.state.test.questions).indexOf(this.state.question.id)
    this.state.previousQuestionSlug = this.state.questionIdx > 0 ? Object.values(this.state.test.questions)[this.state.questionIdx-1].slug : ''
    this.state.nextQuestionSlug = Object.values(this.state.test.questions).length-1 == this.state.questionIdx ? '' : Object.values(this.state.test.questions)[this.state.questionIdx+1].slug

    this.state.jsonLd = {
      datePublished: this.state.test.datePublished,
      keywords: [
        'Microsoft',
        'Microsoft 365',
        'Office 365',
        'MS-500',
        'Microsoft 365 Security Administration'
      ],
      mainEntity: {
        '@type': 'Question',
        name: this.state.question.title,
        text: this.state.question.questionText,
        answerCount: this.state.test.answers ? Object.keys(this.state.test.answers[this.state.question.id]).length : 0,
        dateCreated: this.state.test.datePublished,
        author: {
          '@type': 'Person',
          name: 'John Gruber',
          url: 'https://twitter.com/gruberjl'
        }
      }
    }

    if (this.state.test.answers) {
      this.state.jsonLd.mainEntity.acceptedAnswer = {
        '@type': 'Answer',
        url: `https://www.gitbit.org/course/ms-500/test/${this.state.test.slug}/question/${this.state.question.slug}`,
        author: {
          type: 'Person',
          name: 'John Gruber',
          url: 'https://twitter.com/gruberjl'
        },
        upvoteCount: 1,
        dateCreated: this.state.test.datePublished
      }

      this.state.jsonLd.mainEntity.acceptedAnswer.text = 'None'
    }
  }

  componentDidMount() {
    if (isBrowser()) {
      this.onAuthStateChangedListener = onAuthStateChanged(this.setUid)
      window.addEventListener('beforeunload', this.beforeUnload)
    }
  }

  componentWillUnmount() {
    this.onAuthStateChangedListener()
    window.removeEventListener('beforeunload', this.beforeUnload)
  }

  setUid(user) {
    if (user) {
      this.setState({
        uid: user.uid
      })

      getDoc('courses/MS-500/users', user.uid).then((userAcct) => {
        if (!userAcct.tests)
          userAcct.tests = {}

        if (!userAcct.tests[this.state.test.id])
          userAcct.tests[this.state.test.id] = {}

        if (!userAcct.tests[this.state.test.id][this.state.question.id]) {
          userAcct.tests[this.state.test.id][this.state.question.id] = {
            id: this.state.question.id,
            answers: {}
          }
        }

        this.setState({userAcct})
      })
    }
  }

  toggleEndExam() {
    const endExamShown = !this.state.endExamShown
    this.setState({endExamShown})
  }

  toggleShowAnswer() {
    const answerShown = !this.state.answerShown
    this.setState({answerShown})
  }

  toggleQuestionList() {
    const showQuestionList = !this.state.showQuestionList
    this.setState({showQuestionList})
  }

  gotoQuestion(question) {
    return () => {
      this.navigateTo(`/course/ms-500/test/${this.state.test.slug}/question/${question.slug}`)()
    }
  }

  setAnswer(answers) {
    const userAcct = clone(this.state.userAcct)
    userAcct.tests[this.state.test.id][this.state.question.id].answers = answers

    this.setState({userAcct, unsavedChanges: true})
    if (!this.debounceSave)
      this.debounceSave = debounce(this.save, 5000)

    this.debounceSave()
  }

  beforeUnload() {
    if (this.state.unsavedChanges) {
      const s = 'You have unsaved changes. Really leave?'
      this.save()

      event = event || window.event // eslint-disable-line no-global-assign
      if (event)
        event.returnValue = s

      return s
    }
  }

  save() {
    if (this.state.uid) {
      return saveDoc(`courses/MS-500/users`, this.state.userAcct, false).then(() => {
        return new Promise((resolve, reject) => {
          this.setState({
            alert: 'Content saved',
            unsavedChanges: false
          }, () => {
            return resolve()
          })

          setTimeout(() => {
            this.setState({alert: ''})
          }, 3000)
        })
      })
    } return new Promise((res) => res())
  }

  endExam() {
    this.navigateTo(`/course/ms-500/test/${this.state.test.slug}/summary`)()
  }

  navigateTo(url) {
    return (ev) => {
      if (this.state.unsavedChanges) {
        if (ev)
          ev.preventDefault()

        this.save().then(() => {
          window.location.href = url
        })
      } else
        window.location.href = url
    }
  }

  render() {
    return (
      <Page jsonLdType={'QAPage'} jsonLd={this.state.jsonLd} title={this.state.question.title} description={this.state.question.questionText}>
        <main>
          <Container>
            <Header uid={this.state.uid} questionIdx={this.state.questionIdx} previousQuestionSlug={this.state.previousQuestionSlug} nextQuestionSlug={this.state.nextQuestionSlug} testSlug={this.state.test.slug} toggleEndExam={this.toggleEndExam} numOfQuestions={Object.values(this.state.test.questions).length} navigateTo={this.navigateTo} />
            {
              {
                'multiple-choice': <Choice question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />,
                'hot-area': <HotArea question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />,
                'build-list': <BuildList question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />,
                'drag-drop': <DragDrop question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />
              }[this.state.question.type]
            }
            <Grid container>
              <Grid item xs={12} style={{display: this.state.answerShown ? 'block' : 'none'}} >
                <Typography variant="h5" component="h3" gutterBottom>Answer Explanation</Typography>
              </Grid>
              <Grid item xs={12}>
                <div dangerouslySetInnerHTML={{__html: this.state.question.referencesHtml}} style={{display: this.state.answerShown ? 'block' : 'none'}} />
              </Grid>
            </Grid>
            <Footer uid={this.state.uid} previousQuestionSlug={this.state.previousQuestionSlug} nextQuestionSlug={this.state.nextQuestionSlug} testSlug={this.state.test.slug} toggleEndExam={this.toggleEndExam} toggleShowAnswer={this.toggleShowAnswer} toggleQuestionList={this.toggleQuestionList} navigateTo={this.navigateTo} />
          </Container>

          <Dialog onClose={this.toggleQuestionList} open={this.state.showQuestionList}>
            <DialogTitle>Test Questions</DialogTitle>
            <TableContainer>
              <Table striped bordered hover>
                <TableHead>
                  <TableRow>
                    <TableCell>#</TableCell>
                    <TableCell>Answered</TableCell>
                    <TableCell>Question</TableCell>
                  </TableRow>
                </TableHead>
                <TableBody>
                  { Object.values(this.state.test.questions).map((question, idx) => (
                    <TableRow hover key={idx} onClick={this.gotoQuestion(question)} style={{cursor: 'pointer'}}>
                      <TableCell>{idx+1}</TableCell>
                      <TableCell><Checkbox checked={Object.values(this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers).length > 0} /></TableCell>
                      <TableCell>{question.title}</TableCell>
                    </TableRow>
                  ))}
                </TableBody>
              </Table>
            </TableContainer>
          </Dialog>

          <Dialog onClose={this.toggleEndExam} open={this.state.endExamShown}>
            <DialogTitle>Are you sure?</DialogTitle>
            <DialogContent>
              <DialogContentText>Are you sure you want to end the exam?</DialogContentText>
            </DialogContent>
            <DialogActions>
              <Button variant="contained" onClick={this.endExam}>
                Yes
              </Button>
              <Button variant="outlined" onClick={this.toggleEndExam}>
                No
              </Button>
            </DialogActions>
          </Dialog>
        </main>
        <Snackbar message={this.state.alert} open={this.state.alert !== ''} />
      </Page>
    )
  }
}

export default EditPage
