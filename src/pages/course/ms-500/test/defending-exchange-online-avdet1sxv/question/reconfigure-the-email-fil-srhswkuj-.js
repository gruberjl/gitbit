import {h, Component} from 'preact'
import Page from '../../../../../../components/page'
import {onAuthStateChanged} from '../../../../../../components/firebase/on-auth-state-changed'
import {getDoc} from '../../../../../../components/firebase/get-doc'
import saveDoc from '../../../../../../components/firebase/save-doc'
import Header from '../../../../../../components/test-question/header'
import Footer from '../../../../../../components/test-question/footer'
import Choice from '../../../../../../components/test-question/choice'
import HotArea from '../../../../../../components/test-question/hot-area'
import BuildList from '../../../../../../components/test-question/build-list'
import DragDrop from '../../../../../../components/test-question/drag-drop'
import Container from '@mui/material/Container'
import Grid from '@mui/material/Grid'
import Button from '@mui/material/Button'
import DialogTitle from '@mui/material/DialogTitle'
import Dialog from '@mui/material/Dialog'
import DialogContent from '@mui/material/DialogContent'
import DialogContentText from '@mui/material/DialogContentText'
import DialogActions from '@mui/material/DialogActions'
import Table from '@mui/material/Table'
import TableBody from '@mui/material/TableBody'
import TableCell from '@mui/material/TableCell'
import TableContainer from '@mui/material/TableContainer'
import TableHead from '@mui/material/TableHead'
import TableRow from '@mui/material/TableRow'
import debounce from 'debounce'
import Snackbar from '@mui/material/Snackbar'
import Checkbox from '@mui/material/Checkbox'
import Typography from '@mui/material/Typography'
const clone = require('clone')

const isBrowser = () => typeof window !== 'undefined'

class EditPage extends Component {
  constructor(props) {
    super(props)
    this.setUid = this.setUid.bind(this)
    this.toggleEndExam = this.toggleEndExam.bind(this)
    this.toggleShowAnswer = this.toggleShowAnswer.bind(this)
    this.toggleQuestionList = this.toggleQuestionList.bind(this)
    this.gotoQuestion = this.gotoQuestion.bind(this)
    this.setAnswer = this.setAnswer.bind(this)
    this.beforeUnload = this.beforeUnload.bind(this)
    this.save = this.save.bind(this)
    this.endExam = this.endExam.bind(this)
    this.navigateTo = this.navigateTo.bind(this)

    this.state = {
      uid: '',
      unsavedChanges: false,
      alert: '',
      answerShown: false,
      showQuestionList: false,
      question: {answerOptions: {'7xw3za-np': {answerHtml: '', answers: {eg4iuu61y: {id: 'eg4iuu61y', text: 'Safe Links'}, fbrox8jq5: {id: 'fbrox8jq5', text: 'Anti-malware'}, fc8svunnu: {id: 'fc8svunnu', text: 'Anti-spam'}, 'zo62sc-cb': {id: 'zo62sc-cb', text: 'Safe attachments'}}, id: '7xw3za-np', text: 'Policy to create'}, x9fnlb0ft: {answerHtml: '', answers: {'0mdsarney': {id: '0mdsarney', text: 'Monitor'}, '4etg5avvj': {id: '4etg5avvj', text: 'Replace'}, '5vswviwaj': {id: '5vswviwaj', text: 'Off'}, d1fghw4dc: {id: 'd1fghw4dc', text: 'Dynamic delivery'}}, id: 'x9fnlb0ft', text: 'Option to configure'}}, answerText: 'Safe attachments. Replace.', id: 'srhswkuj-', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '17cbg', text: 'Your organization has a Microsoft 365 tenant with Microsoft 365 E5 licenses.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'egvfb', text: '', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'hosr', text: 'Your manager has asked you to reconfigure the email filter to deliver any emails that contain malware without the attachment.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '52o8h', text: '', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6hb5i', text: 'What two options do you need to configure?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant with Microsoft 365 E5 licenses.</p>\n<p></p>\n<p>Your manager has asked you to reconfigure the email filter to deliver any emails that contain malware without the attachment.</p>\n<p></p>\n<p>What two options do you need to configure?</p>\n', questionText: 'Your organization has a Microsoft 365 tenant with Microsoft 365 E5 licenses. Your manager has asked you to reconfigure the email filter to deliver any emails that contain malware without the attachment. What two options do you need to configure?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8557h', text: 'You\'ll need to create a safe attachments policy with the replace option.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 105, offset: 0}], inlineStyleRanges: [], key: '9tpu7', text: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>You\'ll need to create a safe attachments policy with the replace option.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL" target="_self">https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL</a></p>\n', slug: 'reconfigure-the-email-fil-srhswkuj-', title: 'reconfigure the email filter to deliver any emails that contain malware without the attachment', type: 'hot-area'},
      test: {answers: {'5csvh6z2m': {i1rmuifbp: {id: 'i1rmuifbp', isCorrect: true}, lesnutfls: {id: 'lesnutfls', isCorrect: false}, qs1nuxx9m: {id: 'qs1nuxx9m', isCorrect: false}, wbwjczj0_: {id: 'wbwjczj0_', isCorrect: true}}, '7er7ccfts': {'9erkk0m7o': {id: '9erkk0m7o', idx: 2}, h53o3zva9: {id: 'h53o3zva9', idx: 0}, 'igwmi-qa8': {id: 'igwmi-qa8', idx: 4}, 'kkzxdba-z': {id: 'kkzxdba-z', idx: 3}, oe80gtdpz: {id: 'oe80gtdpz', idx: 1}}, a_jgp3riu: {'5maes1eop': {id: '5maes1eop', isCorrect: false}, _bgw0eup8: {id: '_bgw0eup8', isCorrect: false}, ayl6ht8jc: {id: 'ayl6ht8jc', isCorrect: false}, 'qj-4ct42p': {id: 'qj-4ct42p', isCorrect: true}}, bneaoi75l: {'1odjdcybu': {id: '1odjdcybu', idx: 5}, blnoy81b1: {id: 'blnoy81b1', idx: 3}, 'btbzo-rdy': {id: 'btbzo-rdy', idx: 4}, eljrx72kf: {id: 'eljrx72kf', idx: 1}, gnzfehbto: {id: 'gnzfehbto', idx: 0}, nabiyung3: {id: 'nabiyung3', idx: 6}, oz1ttc_ky: {id: 'oz1ttc_ky', idx: 2}}, hbv5zrkux: {'gg_n-0c9c': {'-jv1ufwxu': {id: '-jv1ufwxu', isCorrect: true}, 'gmadq-i60': {id: 'gmadq-i60', isCorrect: false}, id: 'gg_n-0c9c', uofnxhwi5: {id: 'uofnxhwi5', isCorrect: false}}, yczm0jujm: {'8fjsbkaz7': {id: '8fjsbkaz7', isCorrect: false}, dxmcmyxyu: {id: 'dxmcmyxyu', isCorrect: true}, fck3kbcns: {id: 'fck3kbcns', isCorrect: false}, id: 'yczm0jujm'}}, 'ir-uduemy': {'2jv5pvgvc': {id: '2jv5pvgvc', isCorrect: false}, fw9yn47ch: {id: 'fw9yn47ch', isCorrect: true}, oegnzlvuh: {id: 'oegnzlvuh', isCorrect: false}, rwticbdwn: {id: 'rwticbdwn', isCorrect: false}}, jsen6jm3b: {a3jgvawzf: {id: 'a3jgvawzf', isCorrect: false}, etbqiossh: {id: 'etbqiossh', isCorrect: true}, gpi59ulcs: {id: 'gpi59ulcs', isCorrect: false}, oejuxhxaw: {id: 'oejuxhxaw', isCorrect: true}}, lfyrmsyv6: {aofc6y_1y: {id: 'aofc6y_1y', isCorrect: false}, 'bhx5-2mtj': {id: 'bhx5-2mtj', isCorrect: true}, heoc676rq: {id: 'heoc676rq', isCorrect: false}, wusjeymg4: {id: 'wusjeymg4', isCorrect: false}}, lguagnb4a: {'05mjahec4': {id: '05mjahec4', isCorrect: false}, ae1fqnyee: {id: 'ae1fqnyee', isCorrect: true}, h_aaa6uz0: {id: 'h_aaa6uz0', isCorrect: false}, rw4b7tsul: {id: 'rw4b7tsul', isCorrect: true}, zqfgufznv: {id: 'zqfgufznv', isCorrect: false}}, nmek5r25f: {'7yckmvpec': {id: '7yckmvpec', isCorrect: true}, dpejpakgm: {id: 'dpejpakgm', isCorrect: false}, hnps2vxbq: {id: 'hnps2vxbq', isCorrect: false}, mywxw0c1c: {id: 'mywxw0c1c', isCorrect: false}}, 'srhswkuj-': {'7xw3za-np': {eg4iuu61y: {id: 'eg4iuu61y', isCorrect: false}, fbrox8jq5: {id: 'fbrox8jq5', isCorrect: false}, fc8svunnu: {id: 'fc8svunnu', isCorrect: false}, id: '7xw3za-np', 'zo62sc-cb': {id: 'zo62sc-cb', isCorrect: true}}, x9fnlb0ft: {'0mdsarney': {id: '0mdsarney', isCorrect: false}, '4etg5avvj': {id: '4etg5avvj', isCorrect: true}, '5vswviwaj': {id: '5vswviwaj', isCorrect: false}, d1fghw4dc: {id: 'd1fghw4dc', isCorrect: false}, id: 'x9fnlb0ft'}}, w6qjhx1dk: {'-w9ka6sl-': {id: '-w9ka6sl-', idx: 2}, '0ndvo21un': {id: '0ndvo21un', idx: 3}, '3y_hknryp': {id: '3y_hknryp', idx: 5}, iikluxhxh: {id: 'iikluxhxh', idx: 0}, iikvgdj2v: {id: 'iikvgdj2v', idx: 4}, t45zdjv4j: {id: 't45zdjv4j', idx: 1}, vq9hc9tzc: {id: 'vq9hc9tzc', idx: 6}}, 'zggn-nwun': {'7pucnt2u0': {id: '7pucnt2u0', idx: 4}, '9ix_wg3-l': {id: '9ix_wg3-l', idx: 0}, g035nlpt7: {id: 'g035nlpt7', idx: 1}, k1gjnfcjo: {id: 'k1gjnfcjo', idx: 3}, u0zz5kyo0: {id: 'u0zz5kyo0', idx: 2}}}, datePublished: '2022/9/28', description: 'All the information you need to know about Exchange Online to pass the MS-500. Pass your exam with Gitbit.', featuredImage: 'https://i.ibb.co/f2cRRn7/Block-URLs.png', id: 'avdet1sxv', images: ['https://i.ibb.co/f2cRRn7/Block-URLs.png'], publish: true, questions: {'5csvh6z2m': {answerOptions: {i1rmuifbp: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'f7ah9', text: 'malware.com', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>malware.com</p>\n', id: 'i1rmuifbp'}, lesnutfls: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'fnomj', text: 'GitBit.phishing.malware.com', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>GitBit.phishing.malware.com</p>\n', id: 'lesnutfls'}, qs1nuxx9m: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'eti2f', text: 'GitBit.malware.com', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>GitBit.malware.com</p>\n', id: 'qs1nuxx9m'}, wbwjczj0_: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5fh7b', text: 'malware.gitbit.org', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>malware.gitbit.org</p>\n', id: 'wbwjczj0_'}}, id: '5csvh6z2m', images: ['https://i.ibb.co/f2cRRn7/Block-URLs.png'], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'evf5t', text: 'Your organization has a Microsoft 365 tenant with a primary domain of gitbit.org', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4vq21', text: 'Your organization has the following safe links policy.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: '4s9l8', text: '📷', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4actj', text: 'Which URL can users access from Microsoft Office Online?', type: 'unstyled'}], entityMap: {0: {data: {alt: 'URL Block List', src: 'https://i.ibb.co/K7dqRB9/Block-URLs.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant with a primary domain of gitbit.org</p>\n<p>Your organization has the following safe links policy.</p>\n<p><img src="https://i.ibb.co/K7dqRB9/Block-URLs.png" alt="URL Block List" style="height: undefined;width: undefined"/></p>\n<p>Which URL can users access from Microsoft Office Online?</p>\n', questionText: 'Your organization has a Microsoft 365 tenant with a primary domain of gitbit.org Your organization has the following safe links policy. 📷 Which URL can users access from Microsoft Office Online?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2d5j1', text: '*.malware.com would block all subdomains of malware.com. It would block www.malware.com, ftp.malware.com, 1.www.malware .com, etc. It would not block malware.com.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 105, offset: 0}], inlineStyleRanges: [], key: 'd661t', text: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 161, offset: 0}], inlineStyleRanges: [], key: 'f0akq', text: 'https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/tenant-allow-block-list?view=o365-worldwide#url-syntax-for-the-tenant-allowblock-list', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/tenant-allow-block-list?view=o365-worldwide#url-syntax-for-the-tenant-allowblock-list', target: '_blank', url: 'https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/tenant-allow-block-list?view=o365-worldwide#url-syntax-for-the-tenant-allowblock-list'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>*.malware.com would block all subdomains of malware.com. It would block www.malware.com, ftp.malware.com, 1.www.malware .com, etc. It would not block malware.com.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL" target="_self">https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL</a></p>\n<p><a href="https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/tenant-allow-block-list?view=o365-worldwide#url-syntax-for-the-tenant-allowblock-list" target="_self">https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/tenant-allow-block-list?view=o365-worldwide#url-syntax-for-the-tenant-allowblock-list</a></p>\n', slug: 'which-url-can-users-acces-5csvh6z2m', title: 'Which URL can users access from Microsoft Office Online', type: 'multiple-choice'}, '7er7ccfts': {answerOptions: {'9erkk0m7o': {answer: 'Click Policy', answerHtml: '', id: '9erkk0m7o'}, h53o3zva9: {answer: 'Sign in to the Microsoft Defender admin center', answerHtml: '', id: 'h53o3zva9'}, 'igwmi-qa8': {answer: 'Enable the settings', answerHtml: '', id: 'igwmi-qa8'}, 'kkzxdba-z': {answer: 'Select Anti-phishing', answerHtml: '', id: 'kkzxdba-z'}, oe80gtdpz: {answer: 'Go to Threat Management', answerHtml: '', id: 'oe80gtdpz'}}, answerText: 'Sign in to the Microsoft Defender admin center. Go to Threat Management. Click Policy. Select Anti-phishing. Enable the settings.', id: '7er7ccfts', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '619on', text: 'You need to protect against phishing attacks. The solution must meet the following requirements:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6dp79', text: 'Phishing email messages must be quarantined if the messages are sent from a spoofed domain.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ef5kj', text: 'As many phishing email messages as possible must be identified.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9kp9e', text: 'The solution must apply to the current SMTP domain names and any domain names added later.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'f2dhr', text: 'What steps should you take to complete the task?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>You need to protect against phishing attacks. The solution must meet the following requirements:</p>\n<ul>\n<li>Phishing email messages must be quarantined if the messages are sent from a spoofed domain.</li>\n<li>As many phishing email messages as possible must be identified.</li>\n</ul>\n<p>The solution must apply to the current SMTP domain names and any domain names added later.</p>\n<p>What steps should you take to complete the task?</p>\n', questionText: 'You need to protect against phishing attacks. The solution must meet the following requirements: Phishing email messages must be quarantined if the messages are sent from a spoofed domain. As many phishing email messages as possible must be identified. The solution must apply to the current SMTP domain names and any domain names added later. What steps should you take to complete the task?', references: {blocks: [{data: {}, depth: 0, entityRanges: [{key: 0, length: 91, offset: 0}], inlineStyleRanges: [], key: 'akems', text: 'https://www.iorad.com/player/1797326/MS-500---You-need-to-protect-against-phishing-attacks-', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '794a7', text: 'Open the Security & Compliance Admin center', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5bbl5', text: 'Click Threat Management > Policy > Anti-Phishing > Default policy', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'bim5p', text: 'Click Edit impersonation policy', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7bq3v', text: 'Go to Add domains to protect.', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'aes10', text: 'Enable Automatically include the domains I own', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5ria7', text: 'Go to actions', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1dot3', text: 'Click Don\'t apply any action and set to Quarantine the message', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6cp58', text: 'Go to Mailbox Intelligence', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3e2u0', text: 'Click Enable mailbox intelligence-based impersonation protection.', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'bu8lp', text: 'Click If email is sent by an impersonated user. Set to Quarantine the message.', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'cib9q', text: 'Save', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 94, offset: 0}], inlineStyleRanges: [], key: 'afrdr', text: 'https://www.gitbit.org/course/ms-500/learn/Protecting-email-against-phishing-attacks-GCOOUsSBT', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 2, length: 146, offset: 0}], inlineStyleRanges: [], key: 'fojmv', text: 'https://support.office.com/en-us/article/protect-against-phishing-attempts-in-microsoft-365-86c425e1-1686-430a-9151-f7176cce4f2c#ID0EAABAAA=Try_it', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 3, length: 186, offset: 0}], inlineStyleRanges: [], key: '55pt2', text: 'https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/set-up-anti-phishing-policies?view=o365-worldwide#example-anti-phishing-policy-to- protect-a-user-and-a-domain', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.iorad.com/player/1797326/MS-500---You-need-to-protect-against-phishing-attacks-', target: '_blank', url: 'https://www.iorad.com/player/1797326/MS-500---You-need-to-protect-against-phishing-attacks-'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Protecting-email-against-phishing-attacks-GCOOUsSBT', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Protecting-email-against-phishing-attacks-GCOOUsSBT'}, mutability: 'MUTABLE', type: 'LINK'}, 2: {data: {href: 'https://support.office.com/en-us/article/protect-against-phishing-attempts-in-microsoft-365-86c425e1-1686-430a-9151-f7176cce4f2c#ID0EAABAAA=Try_it', target: '_blank', url: 'https://support.office.com/en-us/article/protect-against-phishing-attempts-in-microsoft-365-86c425e1-1686-430a-9151-f7176cce4f2c#ID0EAABAAA=Try_it'}, mutability: 'MUTABLE', type: 'LINK'}, 3: {data: {href: 'https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/set-up-anti-phishing-policies?view=o365-worldwide#example-anti-phishing-policy-to-', target: '_blank', url: 'https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/set-up-anti-phishing-policies?view=o365-worldwide#example-anti-phishing-policy-to-'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p><a href="https://www.iorad.com/player/1797326/MS-500---You-need-to-protect-against-phishing-attacks-" target="_self">https://www.iorad.com/player/1797326/MS-500---You-need-to-protect-against-phishing-attacks-</a></p>\n<ol>\n<li>Open the Security &amp; Compliance Admin center</li>\n<li>Click Threat Management &gt; Policy &gt; Anti-Phishing &gt; Default policy</li>\n<li>Click Edit impersonation policy</li>\n<li>Go to Add domains to protect.</li>\n<li>Enable Automatically include the domains I own</li>\n<li>Go to actions</li>\n<li>Click Don\'t apply any action and set to Quarantine the message</li>\n<li>Go to Mailbox Intelligence</li>\n<li>Click Enable mailbox intelligence-based impersonation protection.</li>\n<li>Click If email is sent by an impersonated user. Set to Quarantine the message.</li>\n<li>Save</li>\n</ol>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Protecting-email-against-phishing-attacks-GCOOUsSBT" target="_self">https://www.gitbit.org/course/ms-500/learn/Protecting-email-against-phishing-attacks-GCOOUsSBT</a></p>\n<p><a href="https://support.office.com/en-us/article/protect-against-phishing-attempts-in-microsoft-365-86c425e1-1686-430a-9151-f7176cce4f2c#ID0EAABAAA=Try_it" target="_self">https://support.office.com/en-us/article/protect-against-phishing-attempts-in-microsoft-365-86c425e1-1686-430a-9151-f7176cce4f2c#ID0EAABAAA=Try_it</a></p>\n<p><a href="https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/set-up-anti-phishing-policies?view=o365-worldwide#example-anti-phishing-policy-to-" target="_self">https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/set-up-anti-phishing-policies?view=o365-worldwide#example-anti-phishing-policy-to- protect-a-user-and-a-domain</a></p>\n', slug: 'phishing-email-messages-m-7er7ccfts', title: 'Phishing email messages must be quarantined if the messages are sent from a spoofed domain', type: 'build-list'}, a_jgp3riu: {answerOptions: {'5maes1eop': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'fjmng', text: 'Integrate Office 365 Threat Intelligence and Microsoft Defender ATP', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Integrate Office 365 Threat Intelligence and Microsoft Defender ATP</p>\n', id: '5maes1eop'}, _bgw0eup8: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8n8qh', text: 'Configure Office 365 Advanced Threat Protection (ATP)', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Configure Office 365 Advanced Threat Protection (ATP)</p>\n', id: '_bgw0eup8'}, ayl6ht8jc: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'binrr', text: 'Create a Conditional Access App Control policy for accessing Office 365', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Create a Conditional Access App Control policy for accessing Office 365</p>\n', id: 'ayl6ht8jc'}, 'qj-4ct42p': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'da2f4', text: 'Be a member of the global admins role', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Be a member of the global admins role</p>\n', id: 'qj-4ct42p'}}, id: 'a_jgp3riu', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4iesv', text: 'You have a Microsoft 365 Enterprise E5 subscription.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ab2ur', text: 'You use Microsoft Defender Advanced Threat Protection (Microsoft Defender ATP). You plan to use Microsoft Office 365 Attack simulator.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'f9gm1', text: 'What is a prerequisite for running an Attack simulator?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>You have a Microsoft 365 Enterprise E5 subscription.</p>\n<p>You use Microsoft Defender Advanced Threat Protection (Microsoft Defender ATP). You plan to use Microsoft Office 365 Attack simulator.</p>\n<p>What is a prerequisite for running an Attack simulator?</p>\n', questionText: 'You have a Microsoft 365 Enterprise E5 subscription. You use Microsoft Defender Advanced Threat Protection (Microsoft Defender ATP). You plan to use Microsoft Office 365 Attack simulator. What is a prerequisite for running an Attack simulator?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2i507', text: 'To setup the attack simulator you need to be part of one of the following roles:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ae3ot', text: 'Global Administrator', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ah1lg', text: 'Security Administrator', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'a4ef5', text: 'Attack Simulation Administrators', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ekgrb', text: 'Attack Payload Author', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 90, offset: 0}], inlineStyleRanges: [], key: 'rmqk', text: 'https://www.gitbit.org/course/ms-500/learn/Simulating-attacks-with-Microsoft-365-GG4cMY8pK', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 78, offset: 0}], inlineStyleRanges: [], key: 'ccho2', text: 'https://docs.microsoft.com/en-us/office365/securitycompliance/attack-simulator', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Simulating-attacks-with-Microsoft-365-GG4cMY8pK', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Simulating-attacks-with-Microsoft-365-GG4cMY8pK'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/office365/securitycompliance/attack-simulator', target: '_blank', url: 'https://docs.microsoft.com/en-us/office365/securitycompliance/attack-simulator'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>To setup the attack simulator you need to be part of one of the following roles:</p>\n<ul>\n<li>Global Administrator</li>\n<li>Security Administrator</li>\n<li>Attack Simulation Administrators</li>\n<li>Attack Payload Author</li>\n</ul>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Simulating-attacks-with-Microsoft-365-GG4cMY8pK" target="_self">https://www.gitbit.org/course/ms-500/learn/Simulating-attacks-with-Microsoft-365-GG4cMY8pK</a></p>\n<p><a href="https://docs.microsoft.com/en-us/office365/securitycompliance/attack-simulator" target="_self">https://docs.microsoft.com/en-us/office365/securitycompliance/attack-simulator</a></p>\n', slug: 'what-is-a-prerequisite-fo-a_jgp3riu', title: 'What is a prerequisite for running an Attack simulator', type: 'multiple-choice'}, bneaoi75l: {answerOptions: {'1odjdcybu': {answer: 'Disable Do not track when users click protected links in Office 365 apps', answerHtml: '', id: '1odjdcybu'}, blnoy81b1: {answer: 'Safe links', answerHtml: '', id: 'blnoy81b1'}, 'btbzo-rdy': {answer: 'Global settings', answerHtml: '', id: 'btbzo-rdy'}, eljrx72kf: {answer: 'Policies & rules', answerHtml: '', id: 'eljrx72kf'}, gnzfehbto: {answer: 'Go to Microsoft 365 Defender admin center', answerHtml: '', id: 'gnzfehbto'}, nabiyung3: {answer: 'Click Save', answerHtml: '', id: 'nabiyung3'}, oz1ttc_ky: {answer: 'Threat policies', answerHtml: '', id: 'oz1ttc_ky'}}, id: 'bneaoi75l', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8qtr9', text: 'You\'ve been tasked with updating the safe links policy. Your manager gives you the following requirement:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2j5q', text: 'Track user clicks on any links to gitbit.org.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1hnot', text: 'What steps need to be completed to fulfill the requirements?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>You\'ve been tasked with updating the safe links policy. Your manager gives you the following requirement:</p>\n<ul>\n<li>Track user clicks on any links to gitbit.org.</li>\n</ul>\n<p>What steps need to be completed to fulfill the requirements?</p>\n', questionText: 'You\'ve been tasked with updating the safe links policy. Your manager gives you the following requirement: Track user clicks on any links to gitbit.org. What steps need to be completed to fulfill the requirements?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5faia', text: 'To set up tracking:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4hf6j', text: 'Go to Microsoft 365 Defender admin center', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'f6can', text: 'Policies & rules', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6g3if', text: 'Threat policies', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'gp2c', text: 'Safe links', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6l7uv', text: 'Global settings.', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'e0u8h', text: 'Disable Do not track when users click protected links in Office 365 apps.', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3ovod', text: 'Click Save.', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 105, offset: 0}], inlineStyleRanges: [], key: 'cbitt', text: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 89, offset: 0}], inlineStyleRanges: [], key: '3cl1l', text: 'https://www.iorad.com/player/1797489/MS-500---Block-access-to-a-domain-named-fabrikam-com', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', url: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://www.iorad.com/player/1797489/MS-500---Block-access-to-a-domain-named-fabrikam-com', url: 'https://www.iorad.com/player/1797489/MS-500---Block-access-to-a-domain-named-fabrikam-com'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>To set up tracking:</p>\n<ol>\n<li>Go to Microsoft 365 Defender admin center</li>\n<li>Policies &amp; rules</li>\n<li>Threat policies</li>\n<li>Safe links</li>\n<li>Global settings.</li>\n<li>Disable Do not track when users click protected links in Office 365 apps.</li>\n<li>Click Save.</li>\n</ol>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL" target="_self">https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL</a></p>\n<p><a href="https://www.iorad.com/player/1797489/MS-500---Block-access-to-a-domain-named-fabrikam-com" target="_self">https://www.iorad.com/player/1797489/MS-500---Block-access-to-a-domain-named-fabrikam-com</a></p>\n', slug: 'track-user-clicks-on-any--bneaoi75l', title: 'Track user clicks on any links to gitbit.org', type: 'build-list'}, hbv5zrkux: {answerOptions: {'gg_n-0c9c': {answerHtml: '', answers: {'-jv1ufwxu': {id: '-jv1ufwxu', text: 'ATP quarantine'}, 'gmadq-i60': {id: 'gmadq-i60', text: 'the user\'s junk email folder'}, uofnxhwi5: {id: 'uofnxhwi5', text: 'user\'s focused inbox'}}, id: 'gg_n-0c9c', text: 'Messages that are flagged as high confidence phishing go to the'}, yczm0jujm: {answerHtml: '', answers: {'8fjsbkaz7': {id: '8fjsbkaz7', text: 'the ATP quarantine'}, dxmcmyxyu: {id: 'dxmcmyxyu', text: 'the user\'s junk email folder'}, fck3kbcns: {id: 'fck3kbcns', text: 'user\'s focused inbox'}}, id: 'yczm0jujm', text: 'Message that contain word-filtered content go to'}}, answerText: 'ATP quarantine. the user\'s junk email folder.', id: 'hbv5zrkux', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2048q', text: 'Your organization has a Microsoft 365 tenant with all users hosted in Exchange Online. It\'s a new tenant and all the defaults are still in place.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'et3f', text: 'You manage email security. Where do suspicious emails go?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant with all users hosted in Exchange Online. It\'s a new tenant and all the defaults are still in place.</p>\n<p>You manage email security. Where do suspicious emails go?</p>\n', questionText: 'Your organization has a Microsoft 365 tenant with all users hosted in Exchange Online. It\'s a new tenant and all the defaults are still in place. You manage email security. Where do suspicious emails go?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '23sdn', text: 'By default emails that contain word-filtered content is considered spam and are directed to the user\'s junk email folder.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '45jqp', text: 'Phishing messages are directed to the junk folder or the quarantine depending on the confidence level. High confidence phishing emails, in other words, emails that Microsoft 365 is confident it is phishing will go to the quarantine while messages that Microsoft 365 is not 100% positive is phishing will go to the junk email folder.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 105, offset: 0}], inlineStyleRanges: [], key: 'bud4b', text: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>By default emails that contain word-filtered content is considered spam and are directed to the user\'s junk email folder.</p>\n<p>Phishing messages are directed to the junk folder or the quarantine depending on the confidence level. High confidence phishing emails, in other words, emails that Microsoft 365 is confident it is phishing will go to the quarantine while messages that Microsoft 365 is not 100% positive is phishing will go to the junk email folder.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL" target="_self">https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL</a></p>\n', slug: 'where-do-suspicious-email-hbv5zrkux', title: 'Where do suspicious emails go', type: 'hot-area'}, 'ir-uduemy': {answerOptions: {'2jv5pvgvc': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6e2m9', text: 'DKIM', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>DKIM</p>\n', id: '2jv5pvgvc'}, fw9yn47ch: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8dbjs', text: 'Anti-spam', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Anti-spam</p>\n', id: 'fw9yn47ch'}, oegnzlvuh: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '55kb2', text: 'Anti-malware', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Anti-malware</p>\n', id: 'oegnzlvuh'}, rwticbdwn: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'c32fu', text: 'ATP anti-phishing', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>ATP anti-phishing</p>\n', id: 'rwticbdwn'}}, answerText: 'Anti-spam.', id: 'ir-uduemy', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'futq5', text: 'Your organization has a Microsoft 365 tenant and you\'ve already created a Microsoft Defender Safe Attachments policy. You\'ve configured the policy to quarantine malware.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'asdmu', text: 'You\'ve been asked to change the retention duration for the attachments that end up in the quarantine.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '97r0t', text: 'Which threat management policy should you update from the Microsoft Defender admin center?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant and you\'ve already created a Microsoft Defender Safe Attachments policy. You\'ve configured the policy to quarantine malware.</p>\n<p>You\'ve been asked to change the retention duration for the attachments that end up in the quarantine.</p>\n<p>Which threat management policy should you update from the Microsoft Defender admin center?</p>\n', questionText: 'Your organization has a Microsoft 365 tenant and you\'ve already created a Microsoft Defender Safe Attachments policy. You\'ve configured the policy to quarantine malware. You\'ve been asked to change the retention duration for the attachments that end up in the quarantine. Which threat management policy should you update from the Microsoft Defender admin center?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'dh3r5', text: 'In the anti-spam policies > Anti-spam inbound policy (default). The actions section will tell Microsoft 365 what to do when it finds a message that\'s spam, phishing, or bulk email. For example, you may want the email to go to the user\'s junk email folder or you may want the email to go to the quarantine. The actions section is where you\'ll find the retain spam in quarantine for this many days setting.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 105, offset: 0}], inlineStyleRanges: [], key: '2v4jr', text: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>In the anti-spam policies &gt; Anti-spam inbound policy (default). The actions section will tell Microsoft 365 what to do when it finds a message that\'s spam, phishing, or bulk email. For example, you may want the email to go to the user\'s junk email folder or you may want the email to go to the quarantine. The actions section is where you\'ll find the retain spam in quarantine for this many days setting.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL" target="_self">https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL</a></p>\n', slug: 'which-threat-management-p-ir-uduemy', title: 'Which threat management policy should you update from the Microsoft Defender admin center', type: 'multiple-choice'}, jsen6jm3b: {answerOptions: {a3jgvawzf: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '97fm8', text: 'User2', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>User2</p>\n', id: 'a3jgvawzf'}, etbqiossh: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '20hei', text: 'User4', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>User4</p>\n', id: 'etbqiossh'}, gpi59ulcs: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'et405', text: 'User1', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>User1</p>\n', id: 'gpi59ulcs'}, oejuxhxaw: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ch4i5', text: 'User3', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>User3</p>\n', id: 'oejuxhxaw'}}, id: 'jsen6jm3b', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6aghh', text: 'Your organization has a hybrid Microsoft 365 tenant with an Exchange on-premises server.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: '5mdop', text: '📷', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3soat', text: 'You\'ve been asked to implement Microsoft 365 Attack Simulator but before you do your manager needs to know who can receive the fake threats.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3bnks', text: 'Which users should you tell your boss can receive the attack simulation fake threats?', type: 'unstyled'}], entityMap: {0: {data: {alt: 'User Mailbox MFA Chart', src: 'https://i.ibb.co/SKq0RCg/user-mailbox-mfa.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>Your organization has a hybrid Microsoft 365 tenant with an Exchange on-premises server.</p>\n<p><img src="https://i.ibb.co/SKq0RCg/user-mailbox-mfa.png" alt="User Mailbox MFA Chart" style="height: undefined;width: undefined"/></p>\n<p>You\'ve been asked to implement Microsoft 365 Attack Simulator but before you do your manager needs to know who can receive the fake threats.</p>\n<p>Which users should you tell your boss can receive the attack simulation fake threats?</p>\n', questionText: 'Your organization has a hybrid Microsoft 365 tenant with an Exchange on-premises server. 📷 You\'ve been asked to implement Microsoft 365 Attack Simulator but before you do your manager needs to know who can receive the fake threats. Which users should you tell your boss can receive the attack simulation fake threats?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '47j8i', text: 'Each targeted recipient must have an Exchange Online mailbox.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 90, offset: 0}], inlineStyleRanges: [], key: '78vig', text: 'https://www.gitbit.org/course/ms-500/learn/Simulating-attacks-with-Microsoft-365-GG4cMY8pK', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 112, offset: 0}], inlineStyleRanges: [], key: 'e6d15', text: 'https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/attack-simulator?view=o365-worldwide', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Simulating-attacks-with-Microsoft-365-GG4cMY8pK', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Simulating-attacks-with-Microsoft-365-GG4cMY8pK'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/attack-simulator?view=o365-worldwide', target: '_blank', url: 'https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/attack-simulator?view=o365-worldwide'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>Each targeted recipient must have an Exchange Online mailbox.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Simulating-attacks-with-Microsoft-365-GG4cMY8pK" target="_self">https://www.gitbit.org/course/ms-500/learn/Simulating-attacks-with-Microsoft-365-GG4cMY8pK</a></p>\n<p><a href="https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/attack-simulator?view=o365-worldwide" target="_self">https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/attack-simulator?view=o365-worldwide</a></p>\n', slug: 'which-users-should-you-te-jsen6jm3b', title: 'Which users should you tell your boss can receive the attack simulation fake threats', type: 'multiple-choice'}, lfyrmsyv6: {answerOptions: {aofc6y_1y: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9b8to', text: 'Purchase a Enterprise Mobility + Security E5 license for every user.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Purchase a Enterprise Mobility + Security E5 license for every user.</p>\n', id: 'aofc6y_1y'}, 'bhx5-2mtj': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9o7v3', text: 'Migrate all of the mailboxes hosted on-premises Microsoft 365', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Migrate all of the mailboxes hosted on-premises Microsoft 365</p>\n', id: 'bhx5-2mtj'}, heoc676rq: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4vble', text: 'Open Microsoft Azure Active Directory Connect (Azure AD Connect) and configure attribute filtering.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Open Microsoft Azure Active Directory Connect (Azure AD Connect) and configure attribute filtering.</p>\n', id: 'heoc676rq'}, wusjeymg4: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7ab69', text: 'Open Microsoft Azure Active Directory Connect (Azure AD Connect) and select Directory extension attribute sync.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Open Microsoft Azure Active Directory Connect (Azure AD Connect) and select Directory extension attribute sync.</p>\n', id: 'wusjeymg4'}}, answerText: 'Migrate all of the mailboxes hosted on-premises Microsoft 365.', id: 'lfyrmsyv6', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7iiih', text: 'All user users have a Microsoft 365 E5 license. You have a hybrid Microsoft Exchange Server. Some of your user\'s mailboxes are located in Microsoft 365 while others are located in the on-premises Exchange server', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8f4c9', text: 'You are tasked with setting up and configuring Microsoft Defender for Office 365 anti-phishing policy.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'aauub', text: 'Management has asked you to enable mailbox intelligence for all users.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7q4mi', text: 'What do you need to do to verify all mailboxes have mailbox intelligence enabled and working?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>All user users have a Microsoft 365 E5 license. You have a hybrid Microsoft Exchange Server. Some of your user\'s mailboxes are located in Microsoft 365 while others are located in the on-premises Exchange server</p>\n<p>You are tasked with setting up and configuring Microsoft Defender for Office 365 anti-phishing policy.</p>\n<p>Management has asked you to enable mailbox intelligence for all users.</p>\n<p>What do you need to do to verify all mailboxes have mailbox intelligence enabled and working?</p>\n', questionText: 'All user users have a Microsoft 365 E5 license. You have a hybrid Microsoft Exchange Server. Some of your user\'s mailboxes are located in Microsoft 365 while others are located in the on-premises Exchange server You are tasked with setting up and configuring Microsoft Defender for Office 365 anti-phishing policy. Management has asked you to enable mailbox intelligence for all users. What do you need to do to verify all mailboxes have mailbox intelligence enabled and working?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3aimu', text: 'Mailbox intelligence will scan a user\'s mailbox to see if the user has sent or received emails from the sender of an email before. For mailbox intelligence to scan a mailbox then mailbox must be located in Microsoft 365\'s Exchange Online', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 94, offset: 0}], inlineStyleRanges: [], key: '67rgm', text: 'https://www.gitbit.org/course/ms-500/learn/Protecting-email-against-phishing-attacks-GCOOUsSBT', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Protecting-email-against-phishing-attacks-GCOOUsSBT', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Protecting-email-against-phishing-attacks-GCOOUsSBT'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>Mailbox intelligence will scan a user\'s mailbox to see if the user has sent or received emails from the sender of an email before. For mailbox intelligence to scan a mailbox then mailbox must be located in Microsoft 365\'s Exchange Online</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Protecting-email-against-phishing-attacks-GCOOUsSBT" target="_self">https://www.gitbit.org/course/ms-500/learn/Protecting-email-against-phishing-attacks-GCOOUsSBT</a></p>\n', slug: 'verify-all-mailboxes-have-lfyrmsyv6', title: 'Verify all mailboxes have mailbox intelligence enabled and working', type: 'multiple-choice'}, lguagnb4a: {answerOptions: {'05mjahec4': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8vld2', text: 'Outlook on the web', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Outlook on the web</p>\n', id: '05mjahec4'}, ae1fqnyee: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '777l2', text: 'The Exchange admin center', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>The Exchange admin center</p>\n', id: 'ae1fqnyee'}, h_aaa6uz0: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'cgo0l', text: 'Microsoft Azure Security Center', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Microsoft Azure Security Center</p>\n', id: 'h_aaa6uz0'}, rw4b7tsul: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'q872', text: 'Microsoft 365 Defender admin center', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Microsoft 365 Defender admin center</p>\n', id: 'rw4b7tsul'}, zqfgufznv: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '24o7', text: 'The Azure ATP admin center', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>The Azure ATP admin center</p>\n', id: 'zqfgufznv'}}, answerText: 'Microsoft 365 Defender admin center. The Exchange admin center.', id: 'lguagnb4a', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5gpdb', text: 'Several users in your organization have called in reporting they received an email that should have had an attachment but there was no attachment.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2c2fr', text: 'You\'ve been tasked with tracking down why the email attachment has been removed.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'km2t', text: 'What two places can you go to review the missing attachments?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Several users in your organization have called in reporting they received an email that should have had an attachment but there was no attachment.</p>\n<p>You\'ve been tasked with tracking down why the email attachment has been removed.</p>\n<p>What two places can you go to review the missing attachments?</p>\n', questionText: 'Several users in your organization have called in reporting they received an email that should have had an attachment but there was no attachment. You\'ve been tasked with tracking down why the email attachment has been removed. What two places can you go to review the missing attachments?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'b8bf3', text: 'There are two places to see what happens to emails/attachments. The first is the Message Trace in the Exchange admin center. The second is in the reports section of the Microsoft Defender admin center.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 105, offset: 0}], inlineStyleRanges: [], key: '1crqu', text: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 99, offset: 0}], inlineStyleRanges: [], key: '5g0i3', text: 'https://docs.microsoft.com/en-us/office365/securitycompliance/manage-quarantined-messages-and-files', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/office365/securitycompliance/manage-quarantined-messages-and-files', target: '_self', url: 'https://docs.microsoft.com/en-us/office365/securitycompliance/manage-quarantined-messages-and-files'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>There are two places to see what happens to emails/attachments. The first is the Message Trace in the Exchange admin center. The second is in the reports section of the Microsoft Defender admin center.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL" target="_self">https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL</a></p>\n<p><a href="https://docs.microsoft.com/en-us/office365/securitycompliance/manage-quarantined-messages-and-files" target="_self">https://docs.microsoft.com/en-us/office365/securitycompliance/manage-quarantined-messages-and-files</a></p>\n', slug: 'what-two-places-can-you-g-lguagnb4a', title: 'What two places can you go to review the missing attachments', type: 'multiple-choice'}, nmek5r25f: {answerOptions: {'7yckmvpec': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '401m9', text: 'Set the action to Dynamic Delivery', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Set the action to Dynamic Delivery</p>\n', id: '7yckmvpec'}, dpejpakgm: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '78el9', text: 'Add a condition', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Add a condition</p>\n', id: 'dpejpakgm'}, hnps2vxbq: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4hffe', text: 'Set the action to block current and future messages and attachments with detected malware.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Set the action to block current and future messages and attachments with detected malware.</p>\n', id: 'hnps2vxbq'}, mywxw0c1c: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2o4lo', text: 'Add an exception for emails coming from gitbit.org', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Add an exception for emails coming from gitbit.org</p>\n', id: 'mywxw0c1c'}}, answerText: 'Set the action to Dynamic Delivery.', id: 'nmek5r25f', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1fcap', text: 'Your organization has a Microsoft 365 tenant with Microsoft 365 E5 licenses.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'dh32p', text: 'You\'ve just implemented a Defender for Office 365 safe attachments policy for your entire organization.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '87a92', text: 'Your help desk is getting calls that emails containing attachments are taking a long to be received.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1kkrs', text: 'You need to reconfigure the safe attachments policy so emails are received more quickly but the attachments still need to be scanned for malware and any attachments with malware must be blocked.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5inhs', text: 'How should you reconfigure the safe attachment policy?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant with Microsoft 365 E5 licenses.</p>\n<p>You\'ve just implemented a Defender for Office 365 safe attachments policy for your entire organization.</p>\n<p>Your help desk is getting calls that emails containing attachments are taking a long to be received.</p>\n<p>You need to reconfigure the safe attachments policy so emails are received more quickly but the attachments still need to be scanned for malware and any attachments with malware must be blocked.</p>\n<p>How should you reconfigure the safe attachment policy?</p>\n', questionText: 'Your organization has a Microsoft 365 tenant with Microsoft 365 E5 licenses. You\'ve just implemented a Defender for Office 365 safe attachments policy for your entire organization. Your help desk is getting calls that emails containing attachments are taking a long to be received. You need to reconfigure the safe attachments policy so emails are received more quickly but the attachments still need to be scanned for malware and any attachments with malware must be blocked. How should you reconfigure the safe attachment policy?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'b32a6', text: 'Sometimes safe attachments cause a delay in email delivery. When you\'re users complain that there is a delay when receiving emails with attachments then this option may be for you. In short, the email will be delivered automatically to the user\'s inbox and then after the scanning is complete the attachment will show up.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 105, offset: 0}], inlineStyleRanges: [], key: 'fl3q5', text: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 93, offset: 0}], inlineStyleRanges: [], key: 'fdui9', text: 'https://docs.microsoft.com/en-us/office365/securitycompliance/dynamic-delivery-and-previewing', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/office365/securitycompliance/dynamic-delivery-and-previewing', target: '_blank', url: 'https://docs.microsoft.com/en-us/office365/securitycompliance/dynamic-delivery-and-previewing'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>Sometimes safe attachments cause a delay in email delivery. When you\'re users complain that there is a delay when receiving emails with attachments then this option may be for you. In short, the email will be delivered automatically to the user\'s inbox and then after the scanning is complete the attachment will show up.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL" target="_self">https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL</a></p>\n<p><a href="https://docs.microsoft.com/en-us/office365/securitycompliance/dynamic-delivery-and-previewing" target="_self">https://docs.microsoft.com/en-us/office365/securitycompliance/dynamic-delivery-and-previewing</a></p>\n', slug: 'how-should-you-reconfigur-nmek5r25f', title: 'How should you reconfigure the safe attachment policy', type: 'multiple-choice'}, 'srhswkuj-': {answerOptions: {'7xw3za-np': {answerHtml: '', answers: {eg4iuu61y: {id: 'eg4iuu61y', text: 'Safe Links'}, fbrox8jq5: {id: 'fbrox8jq5', text: 'Anti-malware'}, fc8svunnu: {id: 'fc8svunnu', text: 'Anti-spam'}, 'zo62sc-cb': {id: 'zo62sc-cb', text: 'Safe attachments'}}, id: '7xw3za-np', text: 'Policy to create'}, x9fnlb0ft: {answerHtml: '', answers: {'0mdsarney': {id: '0mdsarney', text: 'Monitor'}, '4etg5avvj': {id: '4etg5avvj', text: 'Replace'}, '5vswviwaj': {id: '5vswviwaj', text: 'Off'}, d1fghw4dc: {id: 'd1fghw4dc', text: 'Dynamic delivery'}}, id: 'x9fnlb0ft', text: 'Option to configure'}}, answerText: 'Safe attachments. Replace.', id: 'srhswkuj-', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '17cbg', text: 'Your organization has a Microsoft 365 tenant with Microsoft 365 E5 licenses.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'egvfb', text: '', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'hosr', text: 'Your manager has asked you to reconfigure the email filter to deliver any emails that contain malware without the attachment.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '52o8h', text: '', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6hb5i', text: 'What two options do you need to configure?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant with Microsoft 365 E5 licenses.</p>\n<p></p>\n<p>Your manager has asked you to reconfigure the email filter to deliver any emails that contain malware without the attachment.</p>\n<p></p>\n<p>What two options do you need to configure?</p>\n', questionText: 'Your organization has a Microsoft 365 tenant with Microsoft 365 E5 licenses. Your manager has asked you to reconfigure the email filter to deliver any emails that contain malware without the attachment. What two options do you need to configure?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8557h', text: 'You\'ll need to create a safe attachments policy with the replace option.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 105, offset: 0}], inlineStyleRanges: [], key: '9tpu7', text: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>You\'ll need to create a safe attachments policy with the replace option.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL" target="_self">https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL</a></p>\n', slug: 'reconfigure-the-email-fil-srhswkuj-', title: 'reconfigure the email filter to deliver any emails that contain malware without the attachment', type: 'hot-area'}, w6qjhx1dk: {answerOptions: {'-w9ka6sl-': {answer: 'Click Threat policies', answerHtml: '', id: '-w9ka6sl-'}, '0ndvo21un': {answer: 'Click Tenant Allow/Block List', answerHtml: '', id: '0ndvo21un'}, '3y_hknryp': {answer: 'Add the URL to the "Add URLs with wildcards" section', answerHtml: '', id: '3y_hknryp'}, iikluxhxh: {answer: 'Go to Microsoft 365 Defender admin center', answerHtml: '', id: 'iikluxhxh'}, iikvgdj2v: {answer: 'Click URLs then click Block', answerHtml: '', id: 'iikvgdj2v'}, t45zdjv4j: {answer: 'Click Policies & rules', answerHtml: '', id: 't45zdjv4j'}, vq9hc9tzc: {answer: 'Set the Remove block entry after to the number of days to block the URL', answerHtml: '', id: 'vq9hc9tzc'}}, id: 'w6qjhx1dk', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8k7s5', text: 'You\'ve been tasked with updating the safe links policy. Your manager gives you the following 2 requirements:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8fen5', text: 'Block any access to the GitBit.org domain', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'aju35', text: 'Track user clicks on any links to gitbit.org.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5ujgo', text: 'What steps need to be completed to fulfill the requirements?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>You\'ve been tasked with updating the safe links policy. Your manager gives you the following 2 requirements:</p>\n<ul>\n<li>Block any access to the GitBit.org domain</li>\n<li>Track user clicks on any links to gitbit.org.</li>\n</ul>\n<p>What steps need to be completed to fulfill the requirements?</p>\n', questionText: 'You\'ve been tasked with updating the safe links policy. Your manager gives you the following 2 requirements: Block any access to the GitBit.org domain Track user clicks on any links to gitbit.org. What steps need to be completed to fulfill the requirements?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8rlui', text: 'To block URLs: Go to Microsoft 365 Defender admin center > Policies & rules > Threat policies > Tenant Allow/Block List > URLs > Block. Add the URL to the "Add URLs with wildcards" section. Set the Remove block entry after to the number of days to block the URL. Click Add.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'av7lo', text: 'To set up tracking: Go to Microsoft 365 Defender admin center > Policies & rules > Threat policies > Safe links > Global settings. Disable Do not track when users click protected links in Office 365 apps. Click Save.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 105, offset: 0}], inlineStyleRanges: [], key: '1g13s', text: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 89, offset: 0}], inlineStyleRanges: [], key: 'ckof0', text: 'https://www.iorad.com/player/1797489/MS-500---Block-access-to-a-domain-named-fabrikam-com', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://www.iorad.com/player/1797489/MS-500---Block-access-to-a-domain-named-fabrikam-com', target: '_blank', url: 'https://www.iorad.com/player/1797489/MS-500---Block-access-to-a-domain-named-fabrikam-com'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>To block URLs: Go to Microsoft 365 Defender admin center &gt; Policies &amp; rules &gt; Threat policies &gt; Tenant Allow/Block List &gt; URLs &gt; Block. Add the URL to the "Add URLs with wildcards" section. Set the Remove block entry after to the number of days to block the URL. Click Add.</p>\n<p>To set up tracking: Go to Microsoft 365 Defender admin center &gt; Policies &amp; rules &gt; Threat policies &gt; Safe links &gt; Global settings. Disable Do not track when users click protected links in Office 365 apps. Click Save.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL" target="_self">https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL</a></p>\n<p><a href="https://www.iorad.com/player/1797489/MS-500---Block-access-to-a-domain-named-fabrikam-com" target="_self">https://www.iorad.com/player/1797489/MS-500---Block-access-to-a-domain-named-fabrikam-com</a></p>\n', slug: 'block-and-track-any-acces-w6qjhx1dk', title: 'Block and track any access to the GitBit.org domain', type: 'build-list'}, 'zggn-nwun': {answerOptions: {'7pucnt2u0': {answer: 'Click URLs', answerHtml: '', id: '7pucnt2u0'}, '9ix_wg3-l': {answer: 'Open the Microsoft 365 Defender admin center', answerHtml: '', id: '9ix_wg3-l'}, g035nlpt7: {answer: 'Click Policies & rules', answerHtml: '', id: 'g035nlpt7'}, k1gjnfcjo: {answer: 'Click Tenant Allow/Block List', answerHtml: '', id: 'k1gjnfcjo'}, u0zz5kyo0: {answer: 'Select Threat policies', answerHtml: '', id: 'u0zz5kyo0'}}, id: 'zggn-nwun', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'e32gs', text: 'Your manager has asked you to block any access to the site malware.gitbit.org. He wants to ensure you block the site from being opened from within an email or any Microsoft Office application.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'd4rpq', text: 'How can you fulfill his request?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your manager has asked you to block any access to the site malware.gitbit.org. He wants to ensure you block the site from being opened from within an email or any Microsoft Office application.</p>\n<p>How can you fulfill his request?</p>\n', questionText: 'Your manager has asked you to block any access to the site malware.gitbit.org. He wants to ensure you block the site from being opened from within an email or any Microsoft Office application. How can you fulfill his request?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'dsc3s', text: 'Go to Microsoft 365 Defender admin center > Policies & rules > Threat policies > Tenant Allow/Block List > URLs > Block. Add the URL to the "Add URLs with wildcards" section. Set the Remove block entry after the number of days to block the URL. Click Add.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 105, offset: 0}], inlineStyleRanges: [], key: '2c5re', text: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 126, offset: 0}], inlineStyleRanges: [], key: 'aru56', text: 'https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/set-up-atp-safe-links-policies?view=o365-worldwide', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/set-up-atp-safe-links-policies?view=o365-worldwide', target: '_blank', url: 'https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/set-up-atp-safe-links-policies?view=o365-worldwide'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>Go to Microsoft 365 Defender admin center &gt; Policies &amp; rules &gt; Threat policies &gt; Tenant Allow/Block List &gt; URLs &gt; Block. Add the URL to the "Add URLs with wildcards" section. Set the Remove block entry after the number of days to block the URL. Click Add.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL" target="_self">https://www.gitbit.org/course/ms-500/learn/Protect-your-email-environment-from-malicious-actors-6HUOr7qbL</a></p>\n<p><a href="https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/set-up-atp-safe-links-policies?view=o365-worldwide" target="_self">https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/set-up-atp-safe-links-policies?view=o365-worldwide</a></p>\n', slug: 'block-malwaregitbitorg-fr-zggn-nwun', title: 'Block malware.gitbit.org from being opened from within an email or any Office app', type: 'build-list'}}, sectionId: 'QScYfSu74', slug: 'defending-exchange-online-avdet1sxv', title: 'Defending Exchange Online', type: 'test'},
      questionsShown: false
    }

    this.state.userAcct = {tests: {
      [this.state.test.id]: {
        [this.state.question.id]: {answers: {}}
      }
    }}

    this.state.questionIdx = Object.keys(this.state.test.questions).indexOf(this.state.question.id)
    this.state.previousQuestionSlug = this.state.questionIdx > 0 ? Object.values(this.state.test.questions)[this.state.questionIdx-1].slug : ''
    this.state.nextQuestionSlug = Object.values(this.state.test.questions).length-1 == this.state.questionIdx ? '' : Object.values(this.state.test.questions)[this.state.questionIdx+1].slug

    this.state.jsonLd = {
      datePublished: this.state.test.datePublished,
      keywords: [
        'Microsoft',
        'Microsoft 365',
        'Office 365',
        'MS-500',
        'Microsoft 365 Security Administration'
      ],
      mainEntity: {
        '@type': 'Question',
        name: this.state.question.title,
        text: this.state.question.questionText,
        answerCount: this.state.test.answers ? Object.keys(this.state.test.answers[this.state.question.id]).length : 0,
        dateCreated: this.state.test.datePublished,
        author: {
          '@type': 'Person',
          name: 'John Gruber',
          url: 'https://twitter.com/gruberjl'
        }
      }
    }

    if (this.state.test.answers) {
      this.state.jsonLd.mainEntity.acceptedAnswer = {
        '@type': 'Answer',
        url: `https://www.gitbit.org/course/ms-500/test/${this.state.test.slug}/question/${this.state.question.slug}`,
        author: {
          type: 'Person',
          name: 'John Gruber',
          url: 'https://twitter.com/gruberjl'
        },
        upvoteCount: 1,
        dateCreated: this.state.test.datePublished
      }

      this.state.jsonLd.mainEntity.acceptedAnswer.text = 'None'
    }
  }

  componentDidMount() {
    if (isBrowser()) {
      this.onAuthStateChangedListener = onAuthStateChanged(this.setUid)
      window.addEventListener('beforeunload', this.beforeUnload)
    }
  }

  componentWillUnmount() {
    this.onAuthStateChangedListener()
    window.removeEventListener('beforeunload', this.beforeUnload)
  }

  setUid(user) {
    if (user) {
      this.setState({
        uid: user.uid
      })

      getDoc('courses/MS-500/users', user.uid).then((userAcct) => {
        if (!userAcct.tests)
          userAcct.tests = {}

        if (!userAcct.tests[this.state.test.id])
          userAcct.tests[this.state.test.id] = {}

        if (!userAcct.tests[this.state.test.id][this.state.question.id]) {
          userAcct.tests[this.state.test.id][this.state.question.id] = {
            id: this.state.question.id,
            answers: {}
          }
        }

        this.setState({userAcct})
      })
    }
  }

  toggleEndExam() {
    const endExamShown = !this.state.endExamShown
    this.setState({endExamShown})
  }

  toggleShowAnswer() {
    const answerShown = !this.state.answerShown
    this.setState({answerShown})
  }

  toggleQuestionList() {
    const showQuestionList = !this.state.showQuestionList
    this.setState({showQuestionList})
  }

  gotoQuestion(question) {
    return () => {
      this.navigateTo(`/course/ms-500/test/${this.state.test.slug}/question/${question.slug}`)()
    }
  }

  setAnswer(answers) {
    const userAcct = clone(this.state.userAcct)
    userAcct.tests[this.state.test.id][this.state.question.id].answers = answers

    this.setState({userAcct, unsavedChanges: true})
    if (!this.debounceSave)
      this.debounceSave = debounce(this.save, 5000)

    this.debounceSave()
  }

  beforeUnload() {
    if (this.state.unsavedChanges) {
      const s = 'You have unsaved changes. Really leave?'
      this.save()

      event = event || window.event // eslint-disable-line no-global-assign
      if (event)
        event.returnValue = s

      return s
    }
  }

  save() {
    if (this.state.uid) {
      return saveDoc(`courses/MS-500/users`, this.state.userAcct, false).then(() => {
        return new Promise((resolve, reject) => {
          this.setState({
            alert: 'Content saved',
            unsavedChanges: false
          }, () => {
            return resolve()
          })

          setTimeout(() => {
            this.setState({alert: ''})
          }, 3000)
        })
      })
    } return new Promise((res) => res())
  }

  endExam() {
    this.navigateTo(`/course/ms-500/test/${this.state.test.slug}/summary`)()
  }

  navigateTo(url) {
    return (ev) => {
      if (this.state.unsavedChanges) {
        if (ev)
          ev.preventDefault()

        this.save().then(() => {
          window.location.href = url
        })
      } else
        window.location.href = url
    }
  }

  render() {
    return (
      <Page jsonLdType={'QAPage'} jsonLd={this.state.jsonLd} title={this.state.question.title} description={this.state.question.questionText}>
        <main>
          <Container>
            <Header uid={this.state.uid} questionIdx={this.state.questionIdx} previousQuestionSlug={this.state.previousQuestionSlug} nextQuestionSlug={this.state.nextQuestionSlug} testSlug={this.state.test.slug} toggleEndExam={this.toggleEndExam} numOfQuestions={Object.values(this.state.test.questions).length} navigateTo={this.navigateTo} />
            {
              {
                'multiple-choice': <Choice question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />,
                'hot-area': <HotArea question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />,
                'build-list': <BuildList question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />,
                'drag-drop': <DragDrop question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />
              }[this.state.question.type]
            }
            <Grid container>
              <Grid item xs={12} style={{display: this.state.answerShown ? 'block' : 'none'}} >
                <Typography variant="h5" component="h3" gutterBottom>Answer Explanation</Typography>
              </Grid>
              <Grid item xs={12}>
                <div dangerouslySetInnerHTML={{__html: this.state.question.referencesHtml}} style={{display: this.state.answerShown ? 'block' : 'none'}} />
              </Grid>
            </Grid>
            <Footer uid={this.state.uid} previousQuestionSlug={this.state.previousQuestionSlug} nextQuestionSlug={this.state.nextQuestionSlug} testSlug={this.state.test.slug} toggleEndExam={this.toggleEndExam} toggleShowAnswer={this.toggleShowAnswer} toggleQuestionList={this.toggleQuestionList} navigateTo={this.navigateTo} />
          </Container>

          <Dialog onClose={this.toggleQuestionList} open={this.state.showQuestionList}>
            <DialogTitle>Test Questions</DialogTitle>
            <TableContainer>
              <Table striped bordered hover>
                <TableHead>
                  <TableRow>
                    <TableCell>#</TableCell>
                    <TableCell>Answered</TableCell>
                    <TableCell>Question</TableCell>
                  </TableRow>
                </TableHead>
                <TableBody>
                  { Object.values(this.state.test.questions).map((question, idx) => (
                    <TableRow hover key={idx} onClick={this.gotoQuestion(question)} style={{cursor: 'pointer'}}>
                      <TableCell>{idx+1}</TableCell>
                      <TableCell><Checkbox checked={Object.values(this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers).length > 0} /></TableCell>
                      <TableCell>{question.title}</TableCell>
                    </TableRow>
                  ))}
                </TableBody>
              </Table>
            </TableContainer>
          </Dialog>

          <Dialog onClose={this.toggleEndExam} open={this.state.endExamShown}>
            <DialogTitle>Are you sure?</DialogTitle>
            <DialogContent>
              <DialogContentText>Are you sure you want to end the exam?</DialogContentText>
            </DialogContent>
            <DialogActions>
              <Button variant="contained" onClick={this.endExam}>
                Yes
              </Button>
              <Button variant="outlined" onClick={this.toggleEndExam}>
                No
              </Button>
            </DialogActions>
          </Dialog>
        </main>
        <Snackbar message={this.state.alert} open={this.state.alert !== ''} />
      </Page>
    )
  }
}

export default EditPage
