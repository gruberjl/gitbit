import {h, Component} from 'preact'
import Page from '../../../../../../components/page'
import {onAuthStateChanged} from '../../../../../../components/firebase/on-auth-state-changed'
import {getDoc} from '../../../../../../components/firebase/get-doc'
import saveDoc from '../../../../../../components/firebase/save-doc'
import Header from '../../../../../../components/test-question/header'
import Footer from '../../../../../../components/test-question/footer'
import Choice from '../../../../../../components/test-question/choice'
import HotArea from '../../../../../../components/test-question/hot-area'
import BuildList from '../../../../../../components/test-question/build-list'
import DragDrop from '../../../../../../components/test-question/drag-drop'
import Container from '@mui/material/Container'
import Grid from '@mui/material/Grid'
import Button from '@mui/material/Button'
import DialogTitle from '@mui/material/DialogTitle'
import Dialog from '@mui/material/Dialog'
import DialogContent from '@mui/material/DialogContent'
import DialogContentText from '@mui/material/DialogContentText'
import DialogActions from '@mui/material/DialogActions'
import Table from '@mui/material/Table'
import TableBody from '@mui/material/TableBody'
import TableCell from '@mui/material/TableCell'
import TableContainer from '@mui/material/TableContainer'
import TableHead from '@mui/material/TableHead'
import TableRow from '@mui/material/TableRow'
import debounce from 'debounce'
import Snackbar from '@mui/material/Snackbar'
import Checkbox from '@mui/material/Checkbox'
import Typography from '@mui/material/Typography'
const clone = require('clone')

const isBrowser = () => typeof window !== 'undefined'

class EditPage extends Component {
  constructor(props) {
    super(props)
    this.setUid = this.setUid.bind(this)
    this.toggleEndExam = this.toggleEndExam.bind(this)
    this.toggleShowAnswer = this.toggleShowAnswer.bind(this)
    this.toggleQuestionList = this.toggleQuestionList.bind(this)
    this.gotoQuestion = this.gotoQuestion.bind(this)
    this.setAnswer = this.setAnswer.bind(this)
    this.beforeUnload = this.beforeUnload.bind(this)
    this.save = this.save.bind(this)
    this.endExam = this.endExam.bind(this)
    this.navigateTo = this.navigateTo.bind(this)

    this.state = {
      uid: '',
      unsavedChanges: false,
      alert: '',
      answerShown: false,
      showQuestionList: false,
      question: {answerOptions: {'1ztr1jk9c': {answerHtml: '', answers: {'8hqbtsygg': {id: '8hqbtsygg', text: 'Yes'}, wv84eyi0t: {id: 'wv84eyi0t', text: 'No'}}, id: '1ztr1jk9c', text: 'The users in gigtbit.org can access File2'}, cctozrrav: {answerHtml: '', answers: {'6vjtcqquc': {id: '6vjtcqquc', text: 'Yes'}, lcl4xxuwi: {id: 'lcl4xxuwi', text: 'No'}}, id: 'cctozrrav', text: 'External users can access File1'}, v8c8loihx: {answerHtml: '', answers: {dfkffpft4: {id: 'dfkffpft4', text: 'No'}, g8o0ley9g: {id: 'g8o0ley9g', text: 'Yes'}}, id: 'v8c8loihx', text: 'External users can access File3'}}, answerText: 'No. No. No.', id: 'y2xargzdq', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'a9nth', text: 'Your organization has a Microsoft 365 tenant with the primary domain of gitbit.org', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '249ri', text: 'OneDrive contains the following files that are shared externally.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: 'd1413', text: 'ðŸ“·', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3mru7', text: 'You create a data loss prevention (DLP) policy and apply it to OneDrive. You configure the DLP policy with the following rules', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [{length: 6, offset: 0, style: 'BOLD'}], key: '9cl0a', text: 'Rule 1:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'fa4aq', text: 'Applies when content is marked with Label1 and shared with people outside my organization', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'a7vv5', text: 'Cde your organization.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '73btm', text: 'Notify the user who shared or last modified the content.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '832ak', text: 'Allow overrides from Microsoft 365 services.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ald2a', text: 'Priority: 0', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [{length: 5, offset: 0, style: 'BOLD'}], key: '9qgsl', text: 'Rule2:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9ovhp', text: 'Applies when content is marked with Label1 or Label2', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5r8t8', text: 'Block everyone from accessing the content excluding the owner and last modifier', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '85kno', text: 'Priority: 1', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [{length: 5, offset: 0, style: 'BOLD'}], key: 'b1pu4', text: 'Rule3:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4vnbk', text: 'Applies when content is marked with Label2 and shared with people outside my organization', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5sf71', text: 'Restrict access by blocking people outside your organization.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'cedh9', text: 'Notify the user who shared or last modified the content.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4cvcd', text: 'Allow overrides from Microsoft 365 services.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6fgg1', text: 'Priority: 2', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9g4et', text: 'Click yes if the statement is true. If the statement is false select No.', type: 'unstyled'}], entityMap: {0: {data: {alt: 'Files and labels chart', src: 'https://i.ibb.co/rMYDH1g/file-labels.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant with the primary domain of gitbit.org</p>\n<p>OneDrive contains the following files that are shared externally.</p>\n<p><img src="https://i.ibb.co/rMYDH1g/file-labels.png" alt="Files and labels chart" style="height: undefined;width: undefined"/></p>\n<p>You create a data loss prevention (DLP) policy and apply it to OneDrive. You configure the DLP policy with the following rules</p>\n<p><strong>Rule 1</strong>:</p>\n<ul>\n<li>Applies when content is marked with Label1 and shared with people outside my organization</li>\n<li>Cde your organization.</li>\n<li>Notify the user who shared or last modified the content.</li>\n<li>Allow overrides from Microsoft 365 services.</li>\n<li>Priority: 0</li>\n</ul>\n<p><strong>Rule2</strong>:</p>\n<ul>\n<li>Applies when content is marked with Label1 or Label2</li>\n<li>Block everyone from accessing the content excluding the owner and last modifier</li>\n<li>Priority: 1</li>\n</ul>\n<p><strong>Rule3</strong>:</p>\n<ul>\n<li>Applies when content is marked with Label2 and shared with people outside my organization</li>\n<li>Restrict access by blocking people outside your organization.</li>\n<li>Notify the user who shared or last modified the content.</li>\n<li>Allow overrides from Microsoft 365 services.</li>\n<li>Priority: 2</li>\n</ul>\n<p>Click yes if the statement is true. If the statement is false select No.</p>\n', questionText: 'Your organization has a Microsoft 365 tenant with the primary domain of gitbit.org OneDrive contains the following files that are shared externally. ðŸ“· You create a data loss prevention (DLP) policy and apply it to OneDrive. You configure the DLP policy with the following rules Rule 1: Applies when content is marked with Label1 and shared with people outside my organization Cde your organization. Notify the user who shared or last modified the content. Allow overrides from Microsoft 365 services. Priority: 0 Rule2: Applies when content is marked with Label1 or Label2 Block everyone from accessing the content excluding the owner and last modifier Priority: 1 Rule3: Applies when content is marked with Label2 and shared with people outside my organization Restrict access by blocking people outside your organization. Notify the user who shared or last modified the content. Allow overrides from Microsoft 365 services. Priority: 2 Click yes if the statement is true. If the statement is false select No.', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7b780', text: 'All of them will match Rule2 because it is the most restrictive.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 116, offset: 0}], inlineStyleRanges: [], key: '5cdso', text: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>All of them will match Rule2 because it is the most restrictive.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w" target="_self">https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w</a></p>\n', slug: 'who-can-access-the-files-y2xargzdq', title: 'Who can access the files?', type: 'hot-area'},
      test: {answers: {'1zgfli-tz': {nxql9udibd: {id: 'nxql9udibd', idx: 1}, rhnjqygfx: {id: 'rhnjqygfx', idx: 0}, 'uk-xagsug': {id: 'uk-xagsug', idx: 2}, vz_kiywso: {id: 'vz_kiywso', idx: 3}}, '4qltylydk': {_1jhx5xet: {id: '_1jhx5xet', isCorrect: true}, brlgkykuh: {id: 'brlgkykuh', isCorrect: false}, hj2uegkmp: {id: 'hj2uegkmp', isCorrect: false}, rwvbuvcsu: {id: 'rwvbuvcsu', isCorrect: false}}, '6xxnk5yq3': {'2-dr9jfgd': {id: '2-dr9jfgd', idx: 2}, ktbunt6tm: {id: 'ktbunt6tm', idx: 1}, lf_svcl7w: {id: 'lf_svcl7w', idx: 3}, mdfggbo8g: {id: 'mdfggbo8g', idx: 6}, oah53593g: {id: 'oah53593g', idx: 4}, 'q7kai2-xx': {id: 'q7kai2-xx', idx: 0}, xqmwirjs0: {id: 'xqmwirjs0', idx: 5}}, 'btlwc-k7f': {glrej3cgg: {id: 'glrej3cgg', isCorrect: false}, uxx8uxzfn: {id: 'uxx8uxzfn', isCorrect: false}, xeykbgw92: {id: 'xeykbgw92', isCorrect: false}, xlzrp98cr: {id: 'xlzrp98cr', isCorrect: true}}, hslwcywai: {'4i0yttju3': {id: '4i0yttju3', isCorrect: true}, iirh50wn_: {id: 'iirh50wn_', isCorrect: false}, 'o8szpmv8-': {id: 'o8szpmv8-', isCorrect: false}}, phqvu8r7y: {'9g7xgcum3': {id: '9g7xgcum3', isCorrect: false}, _dpf4qxno: {id: '_dpf4qxno', isCorrect: false}, _qffllcy0: {id: '_qffllcy0', isCorrect: false}, zepeosdkt: {id: 'zepeosdkt', isCorrect: true}}, x5dyz5fwo: {'7jpp7lnhc': {id: '7jpp7lnhc', isCorrect: false}, gvlmwxea3: {id: 'gvlmwxea3', isCorrect: false}, jreggld5w: {id: 'jreggld5w', isCorrect: false}, xp2y3kouw: {id: 'xp2y3kouw', isCorrect: true}, zogggvw9f: {id: 'zogggvw9f', isCorrect: true}}, y2xargzdq: {'1ztr1jk9c': {'8hqbtsygg': {id: '8hqbtsygg', isCorrect: false}, id: '1ztr1jk9c', wv84eyi0t: {id: 'wv84eyi0t', isCorrect: true}}, cctozrrav: {'6vjtcqquc': {id: '6vjtcqquc', isCorrect: false}, id: 'cctozrrav', lcl4xxuwi: {id: 'lcl4xxuwi', isCorrect: true}}, v8c8loihx: {dfkffpft4: {id: 'dfkffpft4', isCorrect: true}, g8o0ley9g: {id: 'g8o0ley9g', isCorrect: false}, id: 'v8c8loihx'}}, ynxs_s2tg: {'2f1bxbwbs': {'-0gq0bhyn': {id: '-0gq0bhyn', isCorrect: false}, '2nu4rbvxu': {id: '2nu4rbvxu', isCorrect: false}, '906wjumin': {id: '906wjumin', isCorrect: false}, id: '2f1bxbwbs', 'xn2-pdzjf': {id: 'xn2-pdzjf', isCorrect: true}}, '7wah2zh_y': {'1uahtceaq': {id: '1uahtceaq', isCorrect: false}, id: '7wah2zh_y', jy9yb3ka6: {id: 'jy9yb3ka6', isCorrect: true}, xnnbomvht: {id: 'xnnbomvht', isCorrect: false}}}}, datePublished: '2022/10/3', description: 'View all MS-500 exam questions, answers and explanations for free. MS-500 Microsoft 365 Security Administration related to Data Loss Prevention policies (DLP)', featuredImage: 'https://i.ibb.co/74B4X8H/DLP.png', id: 'hwkqi18rz', images: ['https://i.ibb.co/74B4X8H/DLP.png'], publish: true, questions: {'1zgfli-tz': {answerOptions: {nxql9udibd: {answer: 'Export the current rules as an XML file', answerHtml: '', id: 'nxql9udibd'}, rhnjqygfx: {answer: 'Connect to the Security & Compliance admin center using PowerShell', answerHtml: '', id: 'rhnjqygfx'}, 'uk-xagsug': {answer: 'Modify the file', answerHtml: '', id: 'uk-xagsug'}, vz_kiywso: {answer: 'Upload the file', answerHtml: '', id: 'vz_kiywso'}}, id: '1zgfli-tz', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3v02p', text: 'Your organization has a Microsoft 365 tenant.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '21jra', text: 'You need to include a sensitive information type in Data Subject Request cases.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'bkfpl', text: 'Which four actions should you perform in sequence?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant.</p>\n<p>You need to include a sensitive information type in Data Subject Request cases.</p>\n<p>Which four actions should you perform in sequence?</p>\n', questionText: 'Your organization has a Microsoft 365 tenant. You need to include a sensitive information type in Data Subject Request cases. Which four actions should you perform in sequence?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'dlivk', text: '1. Connect to the Security & Compliance admin center using PowerShell. The command is "Connect-IPPSSession"', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'f468v', text: '2. Export the current rules as an XML file. The command is "Get-DlpSensitiveInformationTypeRulePackage | Export-Clixml .\\rules.xml"', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '74i26', text: '3. Modify the file making the changes you desire', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2e98r', text: '4. Upload the file. The command is "New-DlpSensitiveInformationTypeRulePackage -FileData ([System.IO.File]::ReadAllBytes(\'PathToXml.xml\'))"', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 116, offset: 0}], inlineStyleRanges: [], key: '9tfm9', text: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 125, offset: 0}], inlineStyleRanges: [], key: '16mt7', text: 'https://docs.microsoft.com/en-us/microsoft-365/compliance/customize-a-built-in-sensitive-information-type?view=o365-worldwide', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/microsoft-365/compliance/customize-a-built-in-sensitive-information-type?view=o365-worldwide', target: '_blank', url: 'https://docs.microsoft.com/en-us/microsoft-365/compliance/customize-a-built-in-sensitive-information-type?view=o365-worldwide'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>1. Connect to the Security &amp; Compliance admin center using PowerShell. The command is "Connect-IPPSSession"</p>\n<p>2. Export the current rules as an XML file. The command is "Get-DlpSensitiveInformationTypeRulePackage | Export-Clixml .\\\\rules.xml"</p>\n<p>3. Modify the file making the changes you desire</p>\n<p>4. Upload the file. The command is "New-DlpSensitiveInformationTypeRulePackage -FileData ([System.IO.File]::ReadAllBytes(\'PathToXml.xml\'))"</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w" target="_self">https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w</a></p>\n<p><a href="https://docs.microsoft.com/en-us/microsoft-365/compliance/customize-a-built-in-sensitive-information-type?view=o365-worldwide" target="_self">https://docs.microsoft.com/en-us/microsoft-365/compliance/customize-a-built-in-sensitive-information-type?view=o365-worldwide</a></p>\n', slug: 'how-do-you-include-a-sens-1zgfli-tz', title: 'How do you include a sensitive information type in Data Subject Request cases?', type: 'build-list'}, '4qltylydk': {answerOptions: {_1jhx5xet: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'djd8e', text: 'The user can send the email but will be notified.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>The user can send the email but will be notified.</p>\n', id: '_1jhx5xet'}, brlgkykuh: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ea7h4', text: 'The user can send the email and won\'t be notified.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>The user can send the email and won\'t be notified.</p>\n', id: 'brlgkykuh'}, hj2uegkmp: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '28s3u', text: 'The user cannot send the email and will be notified.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>The user cannot send the email and will be notified.</p>\n', id: 'hj2uegkmp'}, rwvbuvcsu: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'd8f6i', text: 'The user cannot send the email and won\'t be notified.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>The user cannot send the email and won\'t be notified.</p>\n', id: 'rwvbuvcsu'}}, id: '4qltylydk', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '49cih', text: 'Your organization has the DLP policy shown below.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: 'nf87', text: 'ðŸ“·', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'a97pc', text: 'What will happen if a user sends an email that contains a credit card number?', type: 'unstyled'}], entityMap: {0: {data: {alt: 'DLP Rules', src: 'https://i.ibb.co/Pj5sngf/DLP-Rules.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>Your organization has the DLP policy shown below.</p>\n<p><img src="https://i.ibb.co/Pj5sngf/DLP-Rules.png" alt="DLP Rules" style="height: undefined;width: undefined"/></p>\n<p>What will happen if a user sends an email that contains a credit card number?</p>\n', questionText: 'Your organization has the DLP policy shown below. ðŸ“· What will happen if a user sends an email that contains a credit card number?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'd4b2v', text: 'Under actions you\'ll notice Notify users with email and policy tips is selected but no blocked action is listed.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 116, offset: 0}], inlineStyleRanges: [], key: '52b58', text: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 91, offset: 0}], inlineStyleRanges: [], key: '1n222', text: 'https://docs.microsoft.com/en-us/office365/securitycompliance/data-loss-prevention-policies', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/office365/securitycompliance/data-loss-prevention-policies', target: '_blank', url: 'https://docs.microsoft.com/en-us/office365/securitycompliance/data-loss-prevention-policies'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>Under actions you\'ll notice Notify users with email and policy tips is selected but no blocked action is listed.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w" target="_self">https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w</a></p>\n<p><a href="https://docs.microsoft.com/en-us/office365/securitycompliance/data-loss-prevention-policies" target="_self">https://docs.microsoft.com/en-us/office365/securitycompliance/data-loss-prevention-policies</a></p>\n', slug: 'what-will-happen-if-a-use-4qltylydk', title: 'What will happen if a user sends an email that contains a credit card number?', type: 'multiple-choice'}, '6xxnk5yq3': {answerOptions: {'2-dr9jfgd': {answer: 'Click Data loss prevention then click Policies', answerHtml: '', id: '2-dr9jfgd'}, ktbunt6tm: {answer: 'Go to policies', answerHtml: '', id: 'ktbunt6tm'}, lf_svcl7w: {answer: 'Click Create policies', answerHtml: '', id: 'lf_svcl7w'}, mdfggbo8g: {answer: 'Add an exception and block email from going outbound', answerHtml: '', id: 'mdfggbo8g'}, oah53593g: {answer: 'Select U.S. Health Insurance Act (HIPAA)', answerHtml: '', id: 'oah53593g'}, 'q7kai2-xx': {answer: 'Open the Microsoft 365 Compliance admin center', answerHtml: '', id: 'q7kai2-xx'}, xqmwirjs0: {answer: 'Disable all locations except Exchange email', answerHtml: '', id: 'xqmwirjs0'}}, id: '6xxnk5yq3', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7io8v', text: 'You need to prevent any emails that contain information covered by the U.S. Health Insurance Act (HIPAA) from being sent to people outside of your organization unless the messages are sent to an external domain named gitbit.org.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'enegn', text: 'What should you do to set it up?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>You need to prevent any emails that contain information covered by the U.S. Health Insurance Act (HIPAA) from being sent to people outside of your organization unless the messages are sent to an external domain named gitbit.org.</p>\n<p>What should you do to set it up?</p>\n', questionText: 'You need to prevent any emails that contain information covered by the U.S. Health Insurance Act (HIPAA) from being sent to people outside of your organization unless the messages are sent to an external domain named gitbit.org. What should you do to set it up?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ek2t4', text: 'A Data loss prevention (DLP) policy would prevent data from leaving the company that is covered under the U.K. Data Protection Act.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 116, offset: 0}], inlineStyleRanges: [], key: '590tg', text: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 130, offset: 0}], inlineStyleRanges: [], key: '8k9tq', text: 'https://www.iorad.com/player/1801811/MS-500---Prevent-any-email-messages-that-contain-data-covered-by-the-U-K--Data-Protection-Act', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9ocla', text: 'Open the Microsoft 365 Compliance admin center > Policies > Data loss prevention > Policies > Create policy > Medical and health > U.S. Health Insurance Act (HIPAA) Enhanced > Next > Disable all locations except Exchange email > Create or customize advanced DLP rules > add an exception and block emails from going outbound > Save your new policy.', type: 'ordered-list-item'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://www.iorad.com/player/1801811/MS-500---Prevent-any-email-messages-that-contain-data-covered-by-the-U-K--Data-Protection-Act', target: '_blank', url: 'https://www.iorad.com/player/1801811/MS-500---Prevent-any-email-messages-that-contain-data-covered-by-the-U-K--Data-Protection-Act'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>A Data loss prevention (DLP) policy would prevent data from leaving the company that is covered under the U.K. Data Protection Act.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w" target="_self">https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w</a></p>\n<p><a href="https://www.iorad.com/player/1801811/MS-500---Prevent-any-email-messages-that-contain-data-covered-by-the-U-K--Data-Protection-Act" target="_self">https://www.iorad.com/player/1801811/MS-500---Prevent-any-email-messages-that-contain-data-covered-by-the-U-K--Data-Protection-Act</a></p>\n<ol>\n<li>Open the Microsoft 365 Compliance admin center &gt; Policies &gt; Data loss prevention &gt; Policies &gt; Create policy &gt; Medical and health &gt; U.S. Health Insurance Act (HIPAA) Enhanced &gt; Next &gt; Disable all locations except Exchange email &gt; Create or customize advanced DLP rules &gt; add an exception and block emails from going outbound &gt; Save your new policy.</li>\n</ol>\n', slug: 'prevent-any-emails-that-c-6xxnk5yq3', title: 'Prevent any emails that contain information covered by HIPAA', type: 'build-list'}, 'btlwc-k7f': {answerOptions: {glrej3cgg: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2iocm', text: 'From the Microsoft Compliance admin center, create a new content search using the new sensitive information type', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>From the Microsoft Compliance admin center, create a new content search using the new sensitive information type</p>\n', id: 'glrej3cgg'}, uxx8uxzfn: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'aastp', text: 'From the Microsoft Compliance admin center, create a new eDiscovery case', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>From the Microsoft Compliance admin center, create a new eDiscovery case</p>\n', id: 'uxx8uxzfn'}, xeykbgw92: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'd1v6r', text: 'Modify the search dictionary in SiteA', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Modify the search dictionary in SiteA</p>\n', id: 'xeykbgw92'}, xlzrp98cr: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5ve8a', text: 'Initiate a re-indexing of SiteA', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Initiate a re-indexing of SiteA</p>\n', id: 'xlzrp98cr'}}, answerText: 'Initiate a re-indexing of SiteA.', id: 'btlwc-k7f', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'e3p2o', text: 'Your organization has a Microsoft 365 tenant with a Microsoft SharePoint Online site named SiteA.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1cr2', text: 'An admin has created an eDiscovery case named CaseA that searches SiteA.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '652gn', text: 'You have created a new sensitive information type but when you look at CaseA the new sensitive information type is not returning any documents.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2pa1q', text: 'What do you need to do to fix the case?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant with a Microsoft SharePoint Online site named SiteA.</p>\n<p>An admin has created an eDiscovery case named CaseA that searches SiteA.</p>\n<p>You have created a new sensitive information type but when you look at CaseA the new sensitive information type is not returning any documents.</p>\n<p>What do you need to do to fix the case?</p>\n', questionText: 'Your organization has a Microsoft 365 tenant with a Microsoft SharePoint Online site named SiteA. An admin has created an eDiscovery case named CaseA that searches SiteA. You have created a new sensitive information type but when you look at CaseA the new sensitive information type is not returning any documents. What do you need to do to fix the case?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'bttq4', text: 'For SharePoint files to be found with the new sensitive info type you will need to reindex your sites.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 116, offset: 0}], inlineStyleRanges: [], key: 'l3o7', text: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>For SharePoint files to be found with the new sensitive info type you will need to reindex your sites.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w" target="_self">https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w</a></p>\n', slug: 'what-do-you-need-to-do-to-btlwc-k7f', title: 'What do you need to do to ensure CaseA returns all the documents', type: 'multiple-choice'}, hslwcywai: {answerOptions: {'4i0yttju3': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8ke0q', text: 'From the Microsoft 365 compliance center create a new Data loss prevention policy with a customized alert notification', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>From the Microsoft 365 compliance center create a new Data loss prevention policy with a customized alert notification</p>\n', id: '4i0yttju3'}, iirh50wn_: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1vc0u', text: 'From the Azure AD admin center > Sharing > Block sharing > Customize alert notifications.', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>From the Azure AD admin center &gt; Sharing &gt; Block sharing &gt; Customize alert notifications.</p>\n', id: 'iirh50wn_'}, 'o8szpmv8-': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8b95t', text: 'From the Microsoft 365 admin center edit the default Data loss prevention policy with custom notification to Joe Gruber', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>From the Microsoft 365 admin center edit the default Data loss prevention policy with custom notification to Joe Gruber</p>\n', id: 'o8szpmv8-'}}, id: 'hslwcywai', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'd1gid', text: 'You need to ensure that a user named Joe Gruber receives incident reports when email messages that contain data covered by the Canada Health Information Act (HIA) are sent outside of your organization.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2rd3f', text: 'What steps should you take to complete the task?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>You need to ensure that a user named Joe Gruber receives incident reports when email messages that contain data covered by the Canada Health Information Act (HIA) are sent outside of your organization.</p>\n<p>What steps should you take to complete the task?</p>\n', questionText: 'You need to ensure that a user named Joe Gruber receives incident reports when email messages that contain data covered by the Canada Health Information Act (HIA) are sent outside of your organization. What steps should you take to complete the task?', references: {blocks: [{data: {}, depth: 0, entityRanges: [{key: 0, length: 116, offset: 0}], inlineStyleRanges: [], key: '1dgca', text: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 127, offset: 0}], inlineStyleRanges: [], key: '81lvl', text: 'https://www.iorad.com/player/1802115/MS-500---ensure-that-a-user-named-Joe-Gruber-receives-incident-reports-when-email-messages', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '82m7n', text: 'Open the Microsoft 365 compliance center.', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'dfg4j', text: 'Go to Policies > Data loss prevention > Policies > Create policy.', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '310r2', text: 'Select the Canada Health Information Act (HIA)', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6ihf1', text: 'Unselect every location except Exchange email.', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8ld0n', text: 'Customize the alert configuration > add Joe Gruber and remove John Gruber.', type: 'ordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9csk6', text: 'Save the changes.', type: 'ordered-list-item'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://www.iorad.com/player/1802115/MS-500---ensure-that-a-user-named-Joe-Gruber-receives-incident-reports-when-email-messages', target: '_blank', url: 'https://www.iorad.com/player/1802115/MS-500---ensure-that-a-user-named-Joe-Gruber-receives-incident-reports-when-email-messages'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p><a href="https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w" target="_self">https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w</a></p>\n<p><a href="https://www.iorad.com/player/1802115/MS-500---ensure-that-a-user-named-Joe-Gruber-receives-incident-reports-when-email-messages" target="_self">https://www.iorad.com/player/1802115/MS-500---ensure-that-a-user-named-Joe-Gruber-receives-incident-reports-when-email-messages</a></p>\n<ol>\n<li>Open the Microsoft 365 compliance center.</li>\n<li>Go to Policies &gt; Data loss prevention &gt; Policies &gt; Create policy.</li>\n<li>Select the Canada Health Information Act (HIA)</li>\n<li>Unselect every location except Exchange email.</li>\n<li>Customize the alert configuration &gt; add Joe Gruber and remove John Gruber.</li>\n<li>Save the changes.</li>\n</ol>\n', slug: 'what-do-you-need-to-do-to-hslwcywai', title: 'What do you need to do to receive incident reports from DLP policies?', type: 'multiple-choice'}, phqvu8r7y: {answerOptions: {'9g7xgcum3': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1i1ir', text: 'The user receives a notification and cannot send the email message', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>The user receives a notification and cannot send the email message</p>\n', id: '9g7xgcum3'}, _dpf4qxno: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'cbjbm', text: 'The email message is sent without a notification', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>The email message is sent without a notification</p>\n', id: '_dpf4qxno'}, _qffllcy0: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'chv3h', text: 'The email message is blocked silently', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>The email message is blocked silently</p>\n', id: '_qffllcy0'}, zepeosdkt: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'b5blq', text: 'The user receives a notification and can send the email message', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>The user receives a notification and can send the email message</p>\n', id: 'zepeosdkt'}}, answerText: 'The user receives a notification and can send the email message.', id: 'phqvu8r7y', images: ['https://i.ibb.co/74B4X8H/DLP.png'], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5f71k', text: 'You create a data loss prevention (DLP) policy as shown in the following exhibit:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: '9uvqu', text: ' ', type: 'atomic'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'esbqb', text: '', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5s2lg', text: 'What happens when a user attempts to send an email message that contains sensitive information?', type: 'unstyled'}], entityMap: {0: {data: {alt: 'Data Loss Prevention (DLP) Policy', src: 'https://i.ibb.co/74B4X8H/DLP.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>You create a data loss prevention (DLP) policy as shown in the following exhibit:</p>\n<img src="https://i.ibb.co/74B4X8H/DLP.png" alt="Data Loss Prevention (DLP) Policy" style="height: undefined;width: undefined"/>\n<p></p>\n<p>What happens when a user attempts to send an email message that contains sensitive information?</p>\n', questionText: 'You create a data loss prevention (DLP) policy as shown in the following exhibit: What happens when a user attempts to send an email message that contains sensitive information?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '30s4v', text: 'Since "use notifications to inform your users" is enabled the user will receive a notification. Since "Let people who see the tip override the policy" is enabled the users can still send the email.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 116, offset: 0}], inlineStyleRanges: [], key: '8lj2', text: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 91, offset: 0}], inlineStyleRanges: [], key: 'ca4qr', text: 'https://docs.microsoft.com/en-us/office365/securitycompliance/data-loss-prevention-policies', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/office365/securitycompliance/data-loss-prevention-policies', target: '_blank', url: 'https://docs.microsoft.com/en-us/office365/securitycompliance/data-loss-prevention-policies'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>Since "use notifications to inform your users" is enabled the user will receive a notification. Since "Let people who see the tip override the policy" is enabled the users can still send the email.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w" target="_self">https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w</a></p>\n<p><a href="https://docs.microsoft.com/en-us/office365/securitycompliance/data-loss-prevention-policies" target="_self">https://docs.microsoft.com/en-us/office365/securitycompliance/data-loss-prevention-policies</a></p>\n', slug: 'what-is-the-effect-of-the-phqvu8r7y', title: 'What is the effect of the policy when a user attempts to send an email message that contains sensitive information?', type: 'multiple-choice'}, x5dyz5fwo: {answerOptions: {'7jpp7lnhc': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '68nc', text: 'Mail flow rule', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Mail flow rule</p>\n', id: '7jpp7lnhc'}, gvlmwxea3: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9bmfj', text: 'Sensitivity label', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Sensitivity label</p>\n', id: 'gvlmwxea3'}, jreggld5w: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'et7ls', text: 'Retention label', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Retention label</p>\n', id: 'jreggld5w'}, xp2y3kouw: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'a87pt', text: 'DLP policy', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>DLP policy</p>\n', id: 'xp2y3kouw'}, zogggvw9f: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8mdmp', text: 'Sensitive information type', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Sensitive information type</p>\n', id: 'zogggvw9f'}}, id: 'x5dyz5fwo', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'fmcdr', text: 'Your organization has a Microsoft 365 tenant and a database that stores client information. Each client has a unique 10-digit ID field that starts with Git- and then has the 10-digit ID.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ds01m', text: 'Your manager has asked you to implement a data loss prevention (DLP) policy that meets the following security requirements:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2rpn8', text: 'Emails that contain a single client ID can be sent to anyone, including those outside the company.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'c8uaa', text: 'Emails that contain more than 2 client IDs must not be sent until the company\'s compliance/security team approves them.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9ml2s', text: 'Which two components should you configure?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant and a database that stores client information. Each client has a unique 10-digit ID field that starts with Git- and then has the 10-digit ID.</p>\n<p>Your manager has asked you to implement a data loss prevention (DLP) policy that meets the following security requirements:</p>\n<ul>\n<li>Emails that contain a single client ID can be sent to anyone, including those outside the company.</li>\n<li>Emails that contain more than 2 client IDs must not be sent until the company\'s compliance/security team approves them.</li>\n</ul>\n<p>Which two components should you configure?</p>\n', questionText: 'Your organization has a Microsoft 365 tenant and a database that stores client information. Each client has a unique 10-digit ID field that starts with Git- and then has the 10-digit ID. Your manager has asked you to implement a data loss prevention (DLP) policy that meets the following security requirements: Emails that contain a single client ID can be sent to anyone, including those outside the company. Emails that contain more than 2 client IDs must not be sent until the company\'s compliance/security team approves them. Which two components should you configure?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2m9sd', text: 'A sensitive info type is required to be created to match the 10-digit ID. Microsoft has a number of sensitive info types built-in to search for credit card numbers, social security numbers, etc. The company\'s custom ID field would not be covered by a built-in policy. Therefore, you would need to create a custom sensitive information type to be used by a DLP policy.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'e6dsj', text: '', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'eb9s9', text: 'A data loss prevention (DLP) policy is then required to block the messages from leaving the company. The DLP policies tell your Microsoft 365 what to do when sensitive information types are found. In this case, you\'ll need a DLP policy using the custom sensitive information type that looks for multiple entries, when they are found, send the email to the group for approval.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 116, offset: 0}], inlineStyleRanges: [], key: 'enecm', text: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 123, offset: 0}], inlineStyleRanges: [], key: 'aef38', text: 'https://docs.microsoft.com/en-us/microsoft-365/compliance/sensitive-information-type-entity-definitions?view=o365-worldwide', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/microsoft-365/compliance/sensitive-information-type-entity-definitions?view=o365-worldwide', target: '_blank', url: 'https://docs.microsoft.com/en-us/microsoft-365/compliance/sensitive-information-type-entity-definitions?view=o365-worldwide'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>A sensitive info type is required to be created to match the 10-digit ID. Microsoft has a number of sensitive info types built-in to search for credit card numbers, social security numbers, etc. The company\'s custom ID field would not be covered by a built-in policy. Therefore, you would need to create a custom sensitive information type to be used by a DLP policy.</p>\n<p></p>\n<p>A data loss prevention (DLP) policy is then required to block the messages from leaving the company. The DLP policies tell your Microsoft 365 what to do when sensitive information types are found. In this case, you\'ll need a DLP policy using the custom sensitive information type that looks for multiple entries, when they are found, send the email to the group for approval.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w" target="_self">https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w</a></p>\n<p><a href="https://docs.microsoft.com/en-us/microsoft-365/compliance/sensitive-information-type-entity-definitions?view=o365-worldwide" target="_self">https://docs.microsoft.com/en-us/microsoft-365/compliance/sensitive-information-type-entity-definitions?view=o365-worldwide</a></p>\n', slug: 'implement-a-dlp-policy--x5dyz5fwo', title: 'Implement a DLP policy ', type: 'multiple-choice'}, y2xargzdq: {answerOptions: {'1ztr1jk9c': {answerHtml: '', answers: {'8hqbtsygg': {id: '8hqbtsygg', text: 'Yes'}, wv84eyi0t: {id: 'wv84eyi0t', text: 'No'}}, id: '1ztr1jk9c', text: 'The users in gigtbit.org can access File2'}, cctozrrav: {answerHtml: '', answers: {'6vjtcqquc': {id: '6vjtcqquc', text: 'Yes'}, lcl4xxuwi: {id: 'lcl4xxuwi', text: 'No'}}, id: 'cctozrrav', text: 'External users can access File1'}, v8c8loihx: {answerHtml: '', answers: {dfkffpft4: {id: 'dfkffpft4', text: 'No'}, g8o0ley9g: {id: 'g8o0ley9g', text: 'Yes'}}, id: 'v8c8loihx', text: 'External users can access File3'}}, answerText: 'No. No. No.', id: 'y2xargzdq', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'a9nth', text: 'Your organization has a Microsoft 365 tenant with the primary domain of gitbit.org', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '249ri', text: 'OneDrive contains the following files that are shared externally.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: 'd1413', text: 'ðŸ“·', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3mru7', text: 'You create a data loss prevention (DLP) policy and apply it to OneDrive. You configure the DLP policy with the following rules', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [{length: 6, offset: 0, style: 'BOLD'}], key: '9cl0a', text: 'Rule 1:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'fa4aq', text: 'Applies when content is marked with Label1 and shared with people outside my organization', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'a7vv5', text: 'Cde your organization.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '73btm', text: 'Notify the user who shared or last modified the content.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '832ak', text: 'Allow overrides from Microsoft 365 services.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ald2a', text: 'Priority: 0', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [{length: 5, offset: 0, style: 'BOLD'}], key: '9qgsl', text: 'Rule2:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9ovhp', text: 'Applies when content is marked with Label1 or Label2', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5r8t8', text: 'Block everyone from accessing the content excluding the owner and last modifier', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '85kno', text: 'Priority: 1', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [{length: 5, offset: 0, style: 'BOLD'}], key: 'b1pu4', text: 'Rule3:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4vnbk', text: 'Applies when content is marked with Label2 and shared with people outside my organization', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5sf71', text: 'Restrict access by blocking people outside your organization.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'cedh9', text: 'Notify the user who shared or last modified the content.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4cvcd', text: 'Allow overrides from Microsoft 365 services.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6fgg1', text: 'Priority: 2', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9g4et', text: 'Click yes if the statement is true. If the statement is false select No.', type: 'unstyled'}], entityMap: {0: {data: {alt: 'Files and labels chart', src: 'https://i.ibb.co/rMYDH1g/file-labels.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant with the primary domain of gitbit.org</p>\n<p>OneDrive contains the following files that are shared externally.</p>\n<p><img src="https://i.ibb.co/rMYDH1g/file-labels.png" alt="Files and labels chart" style="height: undefined;width: undefined"/></p>\n<p>You create a data loss prevention (DLP) policy and apply it to OneDrive. You configure the DLP policy with the following rules</p>\n<p><strong>Rule 1</strong>:</p>\n<ul>\n<li>Applies when content is marked with Label1 and shared with people outside my organization</li>\n<li>Cde your organization.</li>\n<li>Notify the user who shared or last modified the content.</li>\n<li>Allow overrides from Microsoft 365 services.</li>\n<li>Priority: 0</li>\n</ul>\n<p><strong>Rule2</strong>:</p>\n<ul>\n<li>Applies when content is marked with Label1 or Label2</li>\n<li>Block everyone from accessing the content excluding the owner and last modifier</li>\n<li>Priority: 1</li>\n</ul>\n<p><strong>Rule3</strong>:</p>\n<ul>\n<li>Applies when content is marked with Label2 and shared with people outside my organization</li>\n<li>Restrict access by blocking people outside your organization.</li>\n<li>Notify the user who shared or last modified the content.</li>\n<li>Allow overrides from Microsoft 365 services.</li>\n<li>Priority: 2</li>\n</ul>\n<p>Click yes if the statement is true. If the statement is false select No.</p>\n', questionText: 'Your organization has a Microsoft 365 tenant with the primary domain of gitbit.org OneDrive contains the following files that are shared externally. ðŸ“· You create a data loss prevention (DLP) policy and apply it to OneDrive. You configure the DLP policy with the following rules Rule 1: Applies when content is marked with Label1 and shared with people outside my organization Cde your organization. Notify the user who shared or last modified the content. Allow overrides from Microsoft 365 services. Priority: 0 Rule2: Applies when content is marked with Label1 or Label2 Block everyone from accessing the content excluding the owner and last modifier Priority: 1 Rule3: Applies when content is marked with Label2 and shared with people outside my organization Restrict access by blocking people outside your organization. Notify the user who shared or last modified the content. Allow overrides from Microsoft 365 services. Priority: 2 Click yes if the statement is true. If the statement is false select No.', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7b780', text: 'All of them will match Rule2 because it is the most restrictive.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 116, offset: 0}], inlineStyleRanges: [], key: '5cdso', text: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>All of them will match Rule2 because it is the most restrictive.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w" target="_self">https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w</a></p>\n', slug: 'who-can-access-the-files-y2xargzdq', title: 'Who can access the files?', type: 'hot-area'}, ynxs_s2tg: {answerOptions: {'2f1bxbwbs': {answerHtml: '', answers: {'-0gq0bhyn': {id: '-0gq0bhyn', text: '1'}, '2nu4rbvxu': {id: '2nu4rbvxu', text: '2'}, '906wjumin': {id: '906wjumin', text: '4'}, 'xn2-pdzjf': {id: 'xn2-pdzjf', text: '3'}}, id: '2f1bxbwbs', text: 'How many rules will be required?'}, '7wah2zh_y': {answerHtml: '', answers: {'1uahtceaq': {id: '1uahtceaq', text: '1'}, jy9yb3ka6: {id: 'jy9yb3ka6', text: '2'}, xnnbomvht: {id: 'xnnbomvht', text: '3'}}, id: '7wah2zh_y', text: 'How many policies will be required?'}}, id: 'ynxs_s2tg', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4ckdf', text: 'You have a Microsoft 365 subscription.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3o1jf', text: 'You identify the following data loss prevention (DLP) requirements:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ah5hq', text: 'Send notifications to users if they attempt to send attachments that contain EU Social Security Numbers (SSN) or Equivalent ID.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'c5lei', text: 'Prevent any email messages that contain credit card numbers from being sent outside your organization.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '63g74', text: 'Block the external sharing of Microsoft OneDrive content that contains EU passport numbers.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'bhbv3', text: 'Send administrators email alerts if any rule matches occur.', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'c4qfj', text: 'What is the minimum number of DLP policies and rules you must create to meet the requirements? To answer, select the appropriate options in the answer area.', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>You have a Microsoft 365 subscription.</p>\n<p>You identify the following data loss prevention (DLP) requirements:</p>\n<ul>\n<li>Send notifications to users if they attempt to send attachments that contain EU Social Security Numbers (SSN) or Equivalent ID.</li>\n<li>Prevent any email messages that contain credit card numbers from being sent outside your organization.</li>\n<li>Block the external sharing of Microsoft OneDrive content that contains EU passport numbers.</li>\n<li>Send administrators email alerts if any rule matches occur.</li>\n</ul>\n<p>What is the minimum number of DLP policies and rules you must create to meet the requirements? To answer, select the appropriate options in the answer area.</p>\n', questionText: 'You have a Microsoft 365 subscription. You identify the following data loss prevention (DLP) requirements: Send notifications to users if they attempt to send attachments that contain EU Social Security Numbers (SSN) or Equivalent ID. Prevent any email messages that contain credit card numbers from being sent outside your organization. Block the external sharing of Microsoft OneDrive content that contains EU passport numbers. Send administrators email alerts if any rule matches occur. What is the minimum number of DLP policies and rules you must create to meet the requirements? To answer, select the appropriate options in the answer area.', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8irs8', text: 'Policy 1 will have Exchange selected as a location.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'f7nua', text: 'Rule 1: Condition contains EU Social Security number. Action Notify the user and admin', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'uige', text: 'Rule 2: Condition contains Credit card numbers. Action Restrict access to the content for external users. Notify admin', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3e49r', text: 'Policy 2 Will have OneDrive selected as a location.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5oh3c', text: 'Rule 3: Condition contains EU passport numbers. Action Restrict access to the content for external users. Notify admin', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 116, offset: 0}], inlineStyleRanges: [], key: '8qdcj', text: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>Policy 1 will have Exchange selected as a location.</p>\n<ul>\n<li>Rule 1: Condition contains EU Social Security number. Action Notify the user and admin</li>\n<li>Rule 2: Condition contains Credit card numbers. Action Restrict access to the content for external users. Notify admin</li>\n</ul>\n<p>Policy 2 Will have OneDrive selected as a location.</p>\n<ul>\n<li>Rule 3: Condition contains EU passport numbers. Action Restrict access to the content for external users. Notify admin</li>\n</ul>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w" target="_self">https://www.gitbit.org/course/ms-500/learn/Preventing-accidental-and-malicious-data-loss-with-DLP-policies-IsPGsme8w</a></p>\n', slug: 'what-is-the-minimum-numbe-ynxs_s2tg', title: 'What is the minimum number of DLP policies and rules you must create to meet the requirements?', type: 'hot-area'}}, sectionId: 'YhftdGIRX', slug: 'data-loss-prevention-policies-dlp-hwkqi18rz', title: 'Data Loss Prevention policies (DLP)', type: 'test'},
      questionsShown: false
    }

    this.state.userAcct = {tests: {
      [this.state.test.id]: {
        [this.state.question.id]: {answers: {}}
      }
    }}

    this.state.questionIdx = Object.keys(this.state.test.questions).indexOf(this.state.question.id)
    this.state.previousQuestionSlug = this.state.questionIdx > 0 ? Object.values(this.state.test.questions)[this.state.questionIdx-1].slug : ''
    this.state.nextQuestionSlug = Object.values(this.state.test.questions).length-1 == this.state.questionIdx ? '' : Object.values(this.state.test.questions)[this.state.questionIdx+1].slug

    this.state.jsonLd = {
      datePublished: this.state.test.datePublished,
      keywords: [
        'Microsoft',
        'Microsoft 365',
        'Office 365',
        'MS-500',
        'Microsoft 365 Security Administration'
      ],
      mainEntity: {
        '@type': 'Question',
        name: this.state.question.title,
        text: this.state.question.questionText,
        answerCount: this.state.test.answers ? Object.keys(this.state.test.answers[this.state.question.id]).length : 0,
        dateCreated: this.state.test.datePublished,
        author: {
          '@type': 'Person',
          name: 'John Gruber',
          url: 'https://twitter.com/gruberjl'
        }
      }
    }

    if (this.state.test.answers) {
      this.state.jsonLd.mainEntity.acceptedAnswer = {
        '@type': 'Answer',
        url: `https://www.gitbit.org/course/ms-500/test/${this.state.test.slug}/question/${this.state.question.slug}`,
        author: {
          type: 'Person',
          name: 'John Gruber',
          url: 'https://twitter.com/gruberjl'
        },
        upvoteCount: 1,
        dateCreated: this.state.test.datePublished
      }

      this.state.jsonLd.mainEntity.acceptedAnswer.text = 'None'
    }
  }

  componentDidMount() {
    if (isBrowser()) {
      this.onAuthStateChangedListener = onAuthStateChanged(this.setUid)
      window.addEventListener('beforeunload', this.beforeUnload)
    }
  }

  componentWillUnmount() {
    this.onAuthStateChangedListener()
    window.removeEventListener('beforeunload', this.beforeUnload)
  }

  setUid(user) {
    if (user) {
      this.setState({
        uid: user.uid
      })

      getDoc('courses/MS-500/users', user.uid).then((userAcct) => {
        if (!userAcct.tests)
          userAcct.tests = {}

        if (!userAcct.tests[this.state.test.id])
          userAcct.tests[this.state.test.id] = {}

        if (!userAcct.tests[this.state.test.id][this.state.question.id]) {
          userAcct.tests[this.state.test.id][this.state.question.id] = {
            id: this.state.question.id,
            answers: {}
          }
        }

        this.setState({userAcct})
      })
    }
  }

  toggleEndExam() {
    const endExamShown = !this.state.endExamShown
    this.setState({endExamShown})
  }

  toggleShowAnswer() {
    const answerShown = !this.state.answerShown
    this.setState({answerShown})
  }

  toggleQuestionList() {
    const showQuestionList = !this.state.showQuestionList
    this.setState({showQuestionList})
  }

  gotoQuestion(question) {
    return () => {
      this.navigateTo(`/course/ms-500/test/${this.state.test.slug}/question/${question.slug}`)()
    }
  }

  setAnswer(answers) {
    const userAcct = clone(this.state.userAcct)
    userAcct.tests[this.state.test.id][this.state.question.id].answers = answers

    this.setState({userAcct, unsavedChanges: true})
    if (!this.debounceSave)
      this.debounceSave = debounce(this.save, 5000)

    this.debounceSave()
  }

  beforeUnload() {
    if (this.state.unsavedChanges) {
      const s = 'You have unsaved changes. Really leave?'
      this.save()

      event = event || window.event // eslint-disable-line no-global-assign
      if (event)
        event.returnValue = s

      return s
    }
  }

  save() {
    if (this.state.uid) {
      return saveDoc(`courses/MS-500/users`, this.state.userAcct, false).then(() => {
        return new Promise((resolve, reject) => {
          this.setState({
            alert: 'Content saved',
            unsavedChanges: false
          }, () => {
            return resolve()
          })

          setTimeout(() => {
            this.setState({alert: ''})
          }, 3000)
        })
      })
    } return new Promise((res) => res())
  }

  endExam() {
    this.navigateTo(`/course/ms-500/test/${this.state.test.slug}/summary`)()
  }

  navigateTo(url) {
    return (ev) => {
      if (this.state.unsavedChanges) {
        if (ev)
          ev.preventDefault()

        this.save().then(() => {
          window.location.href = url
        })
      } else
        window.location.href = url
    }
  }

  render() {
    return (
      <Page jsonLdType={'QAPage'} jsonLd={this.state.jsonLd} title={this.state.question.title} description={this.state.question.questionText}>
        <main>
          <Container>
            <Header uid={this.state.uid} questionIdx={this.state.questionIdx} previousQuestionSlug={this.state.previousQuestionSlug} nextQuestionSlug={this.state.nextQuestionSlug} testSlug={this.state.test.slug} toggleEndExam={this.toggleEndExam} numOfQuestions={Object.values(this.state.test.questions).length} navigateTo={this.navigateTo} />
            {
              {
                'multiple-choice': <Choice question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />,
                'hot-area': <HotArea question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />,
                'build-list': <BuildList question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />,
                'drag-drop': <DragDrop question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />
              }[this.state.question.type]
            }
            <Grid container>
              <Grid item xs={12} style={{display: this.state.answerShown ? 'block' : 'none'}} >
                <Typography variant="h5" component="h3" gutterBottom>Answer Explanation</Typography>
              </Grid>
              <Grid item xs={12}>
                <div dangerouslySetInnerHTML={{__html: this.state.question.referencesHtml}} style={{display: this.state.answerShown ? 'block' : 'none'}} />
              </Grid>
            </Grid>
            <Footer uid={this.state.uid} previousQuestionSlug={this.state.previousQuestionSlug} nextQuestionSlug={this.state.nextQuestionSlug} testSlug={this.state.test.slug} toggleEndExam={this.toggleEndExam} toggleShowAnswer={this.toggleShowAnswer} toggleQuestionList={this.toggleQuestionList} navigateTo={this.navigateTo} />
          </Container>

          <Dialog onClose={this.toggleQuestionList} open={this.state.showQuestionList}>
            <DialogTitle>Test Questions</DialogTitle>
            <TableContainer>
              <Table striped bordered hover>
                <TableHead>
                  <TableRow>
                    <TableCell>#</TableCell>
                    <TableCell>Answered</TableCell>
                    <TableCell>Question</TableCell>
                  </TableRow>
                </TableHead>
                <TableBody>
                  { Object.values(this.state.test.questions).map((question, idx) => (
                    <TableRow hover key={idx} onClick={this.gotoQuestion(question)} style={{cursor: 'pointer'}}>
                      <TableCell>{idx+1}</TableCell>
                      <TableCell><Checkbox checked={Object.values(this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers).length > 0} /></TableCell>
                      <TableCell>{question.title}</TableCell>
                    </TableRow>
                  ))}
                </TableBody>
              </Table>
            </TableContainer>
          </Dialog>

          <Dialog onClose={this.toggleEndExam} open={this.state.endExamShown}>
            <DialogTitle>Are you sure?</DialogTitle>
            <DialogContent>
              <DialogContentText>Are you sure you want to end the exam?</DialogContentText>
            </DialogContent>
            <DialogActions>
              <Button variant="contained" onClick={this.endExam}>
                Yes
              </Button>
              <Button variant="outlined" onClick={this.toggleEndExam}>
                No
              </Button>
            </DialogActions>
          </Dialog>
        </main>
        <Snackbar message={this.state.alert} open={this.state.alert !== ''} />
      </Page>
    )
  }
}

export default EditPage
