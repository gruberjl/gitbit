import {h, Component} from 'preact'
import Page from '../../../../../../components/page'
import {onAuthStateChanged} from '../../../../../../components/firebase/on-auth-state-changed'
import {getDoc} from '../../../../../../components/firebase/get-doc'
import saveDoc from '../../../../../../components/firebase/save-doc'
import Header from '../../../../../../components/test-question/header'
import Footer from '../../../../../../components/test-question/footer'
import Choice from '../../../../../../components/test-question/choice'
import HotArea from '../../../../../../components/test-question/hot-area'
import BuildList from '../../../../../../components/test-question/build-list'
import DragDrop from '../../../../../../components/test-question/drag-drop'
import Container from '@mui/material/Container'
import Grid from '@mui/material/Grid'
import Button from '@mui/material/Button'
import DialogTitle from '@mui/material/DialogTitle'
import Dialog from '@mui/material/Dialog'
import DialogContent from '@mui/material/DialogContent'
import DialogContentText from '@mui/material/DialogContentText'
import DialogActions from '@mui/material/DialogActions'
import Table from '@mui/material/Table'
import TableBody from '@mui/material/TableBody'
import TableCell from '@mui/material/TableCell'
import TableContainer from '@mui/material/TableContainer'
import TableHead from '@mui/material/TableHead'
import TableRow from '@mui/material/TableRow'
import debounce from 'debounce'
import Snackbar from '@mui/material/Snackbar'
import Checkbox from '@mui/material/Checkbox'
import Typography from '@mui/material/Typography'
const clone = require('clone')

const isBrowser = () => typeof window !== 'undefined'

class EditPage extends Component {
  constructor(props) {
    super(props)
    this.setUid = this.setUid.bind(this)
    this.toggleEndExam = this.toggleEndExam.bind(this)
    this.toggleShowAnswer = this.toggleShowAnswer.bind(this)
    this.toggleQuestionList = this.toggleQuestionList.bind(this)
    this.gotoQuestion = this.gotoQuestion.bind(this)
    this.setAnswer = this.setAnswer.bind(this)
    this.beforeUnload = this.beforeUnload.bind(this)
    this.save = this.save.bind(this)
    this.endExam = this.endExam.bind(this)
    this.navigateTo = this.navigateTo.bind(this)

    this.state = {
      uid: '',
      unsavedChanges: false,
      alert: '',
      answerShown: false,
      showQuestionList: false,
      question: {answerOptions: {mci4akafv: {answerHtml: '', answers: {i6zgxum6z: {id: 'i6zgxum6z', text: 'DeviceC only'}, ku2iai_qbn: {id: 'ku2iai_qbn', text: 'None'}, q96tduson: {id: 'q96tduson', text: 'DeviceA only'}, txkc7yssn: {id: 'txkc7yssn', text: 'DeviceA and DeviceC only'}, ynmybw0es: {id: 'ynmybw0es', text: 'DeviceA, DeviceB, and DeviceC'}}, id: 'mci4akafv', text: 'PolicyA'}, pjevo1zih: {answerHtml: '', answers: {'0fronux17': {id: '0fronux17', text: 'None'}, kc8rq3avn: {id: 'kc8rq3avn', text: 'DeviceB and DeviceD only'}, 'o8txlw-ch': {id: 'o8txlw-ch', text: 'DeviceB, DeviceC, and DeviceD only'}, oupjtmijd: {id: 'oupjtmijd', text: 'DeviceD only'}}, id: 'pjevo1zih', text: 'PolicyB'}}, answerText: 'DeviceD only. DeviceA and DeviceC only.', id: 'b4n2sr_hb', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6rhjo', text: 'You have a Microsoft 365 tenant with the following devices enrolled in Intune.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: '1qm6c', text: 'ðŸ“·', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'a1hh5', text: 'You\'ve configured the following compliance policies in Intune including the groups they are assigned to:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 1, offset: 0}], inlineStyleRanges: [], key: '5bf6n', text: 'ðŸ“·', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'atjie', text: 'What policies will apply to which devices?', type: 'unstyled'}], entityMap: {0: {data: {alt: 'Devices and group memberships', src: 'https://i.ibb.co/zNwz1nM/Device-Group-Membership.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}, 1: {data: {alt: 'Policy assignments', src: 'https://i.ibb.co/LQ99dsG/Policy-assignments.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>You have a Microsoft 365 tenant with the following devices enrolled in Intune.</p>\n<p><img src="https://i.ibb.co/zNwz1nM/Device-Group-Membership.png" alt="Devices and group memberships" style="height: undefined;width: undefined"/></p>\n<p>You\'ve configured the following compliance policies in Intune including the groups they are assigned to:</p>\n<p><img src="https://i.ibb.co/LQ99dsG/Policy-assignments.png" alt="Policy assignments" style="height: undefined;width: undefined"/></p>\n<p>What policies will apply to which devices?</p>\n', questionText: 'You have a Microsoft 365 tenant with the following devices enrolled in Intune. ðŸ“· You\'ve configured the following compliance policies in Intune including the groups they are assigned to: ðŸ“· What policies will apply to which devices?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'dvf8a', text: 'PolicyA includes Group3 and only affects Android devices so it only affects DeviceA and DeviceC.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'd6b6a', text: 'PolicyB includes Group2 and excludes Group3 and only affects Windows 10 devices so it only affects DeviceD.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 87, offset: 0}], inlineStyleRanges: [], key: '4pu59', text: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>PolicyA includes Group3 and only affects Android devices so it only affects DeviceA and DeviceC.</p>\n<p>PolicyB includes Group2 and excludes Group3 and only affects Windows 10 devices so it only affects DeviceD.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO" target="_self">https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO</a></p>\n', slug: 'what-policies-will-apply--b4n2sr_hb', title: 'What policies will apply to which devices?', type: 'hot-area'},
      test: {answers: {b4n2sr_hb: {mci4akafv: {i6zgxum6z: {id: 'i6zgxum6z', isCorrect: false}, id: 'mci4akafv', ku2iai_qbn: {id: 'ku2iai_qbn', isCorrect: false}, q96tduson: {id: 'q96tduson', isCorrect: false}, txkc7yssn: {id: 'txkc7yssn', isCorrect: true}, ynmybw0es: {id: 'ynmybw0es', isCorrect: false}}, pjevo1zih: {'0fronux17': {id: '0fronux17', isCorrect: false}, id: 'pjevo1zih', kc8rq3avn: {id: 'kc8rq3avn', isCorrect: false}, 'o8txlw-ch': {id: 'o8txlw-ch', isCorrect: false}, oupjtmijd: {id: 'oupjtmijd', isCorrect: true}}}, hgwp50u6i: {bbclru0zn: {id: 'bbclru0zn', isCorrect: false}, h0qzvo7vn: {id: 'h0qzvo7vn', isCorrect: true}, 'rtg7-7yzb': {id: 'rtg7-7yzb', isCorrect: false}, txdzvuydbg: {id: 'txdzvuydbg', isCorrect: false}}, mb1zd0h2m: {'4zyziathq': {id: '4zyziathq', isCorrect: false}, ac0d7iiioc: {id: 'ac0d7iiioc', isCorrect: false}, daojdg8ty: {id: 'daojdg8ty', isCorrect: false}, fmoa3lcgo: {id: 'fmoa3lcgo', isCorrect: true}}, nnup6mvry: {etlbvw84i: {id: 'etlbvw84i', isCorrect: true}, ygtmvgdy7: {id: 'ygtmvgdy7', isCorrect: true}, ytt2ybyuo: {id: 'ytt2ybyuo', isCorrect: false}}, 'pwbwlx-fw': {jpeojaqrj: {i2hwdl6yu: {id: 'i2hwdl6yu', isCorrect: false}, id: 'jpeojaqrj', jk3oqewve: {id: 'jk3oqewve', isCorrect: true}, rkreyf2t3: {id: 'rkreyf2t3', isCorrect: false}, 'xs-fks0cp': {id: 'xs-fks0cp', isCorrect: false}}, 'vu_d-htvc': {_lytkgezv: {id: '_lytkgezv', isCorrect: false}, gmcgry63n: {id: 'gmcgry63n', isCorrect: false}, id: 'vu_d-htvc', neo3jw61c: {id: 'neo3jw61c', isCorrect: true}, rdcps2jpd: {id: 'rdcps2jpd', isCorrect: false}}}, qinpocpcr: {'9dvhkw-f-o': {id: '9dvhkw-f-o', isCorrect: false}, enbqrhb5v: {id: 'enbqrhb5v', isCorrect: true}, gt4beadzj: {id: 'gt4beadzj', isCorrect: false}, wi6eej5st: {id: 'wi6eej5st', isCorrect: false}}, vd2rcs8ng: {'9o0d_oa0o': {id: '9o0d_oa0o', isCorrect: false}, aimcecnko: {id: 'aimcecnko', isCorrect: false}, blzp3fuyw: {id: 'blzp3fuyw', isCorrect: true}, gr6mqdru7l: {id: 'gr6mqdru7l', isCorrect: false}}, wnqkaopkl: {ckr36lps6: {id: 'ckr36lps6', idx: 3}, ddbmv2cfc: {id: 'ddbmv2cfc', idx: 0}, lgyaewxkz: {id: 'lgyaewxkz', idx: 2}}, x6xvi1brv: {'6injnosja': {id: '6injnosja', isCorrect: false}, o0q0miox1: {id: 'o0q0miox1', isCorrect: true}, 'rhn-gveksk': {id: 'rhn-gveksk', isCorrect: false}}, xooagjtsu: {kvsdtb1cn: {'aolmuej8-': {id: 'aolmuej8-', isCorrect: true}, id: 'kvsdtb1cn', oees9mvki: {id: 'oees9mvki', isCorrect: false}, shgxvnh2t: {id: 'shgxvnh2t', isCorrect: false}}, 'z4wu7-7gc': {h3uwobxbz: {id: 'h3uwobxbz', isCorrect: false}, id: 'z4wu7-7gc', v_efa6qg8: {id: 'v_efa6qg8', isCorrect: true}, w38x1fozv: {id: 'w38x1fozv', isCorrect: false}}}, zp50exmma: {f7unwy3fm: {'4hxcqgcjpm': {id: '4hxcqgcjpm', isCorrect: false}, bwglkc9yt: {id: 'bwglkc9yt', isCorrect: false}, id: 'f7unwy3fm', yo2p084qe: {id: 'yo2p084qe', isCorrect: true}}, wixzdg8gj: {'9n-vcsest': {id: '9n-vcsest', isCorrect: false}, id: 'wixzdg8gj', m5gd_nxtu: {id: 'm5gd_nxtu', isCorrect: true}, yqij35vdye: {id: 'yqij35vdye', isCorrect: false}}}}, datePublished: '2022/10/4', description: 'Passing the Microsoft 365 Security Administrator (MS-500) is no easy feet. Use the following test to prepare for the Intune portion of the test.', featuredImage: 'https://i.ibb.co/g4d75rX/endpoint-security.png', id: 'bzzocmdmd', images: ['https://i.ibb.co/h85Bsdc/Device-Bit-Locker-Chart.png', 'https://i.ibb.co/RbhYwsM/user-member-of-chart.png', 'https://i.ibb.co/CQHM2Rh/User-platform-chart.png', 'https://i.ibb.co/2dSLJ6r/device-platform-chart.png', 'https://i.ibb.co/g4d75rX/endpoint-security.png'], publish: true, questions: {b4n2sr_hb: {answerOptions: {mci4akafv: {answerHtml: '', answers: {i6zgxum6z: {id: 'i6zgxum6z', text: 'DeviceC only'}, ku2iai_qbn: {id: 'ku2iai_qbn', text: 'None'}, q96tduson: {id: 'q96tduson', text: 'DeviceA only'}, txkc7yssn: {id: 'txkc7yssn', text: 'DeviceA and DeviceC only'}, ynmybw0es: {id: 'ynmybw0es', text: 'DeviceA, DeviceB, and DeviceC'}}, id: 'mci4akafv', text: 'PolicyA'}, pjevo1zih: {answerHtml: '', answers: {'0fronux17': {id: '0fronux17', text: 'None'}, kc8rq3avn: {id: 'kc8rq3avn', text: 'DeviceB and DeviceD only'}, 'o8txlw-ch': {id: 'o8txlw-ch', text: 'DeviceB, DeviceC, and DeviceD only'}, oupjtmijd: {id: 'oupjtmijd', text: 'DeviceD only'}}, id: 'pjevo1zih', text: 'PolicyB'}}, answerText: 'DeviceD only. DeviceA and DeviceC only.', id: 'b4n2sr_hb', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6rhjo', text: 'You have a Microsoft 365 tenant with the following devices enrolled in Intune.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: '1qm6c', text: 'ðŸ“·', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'a1hh5', text: 'You\'ve configured the following compliance policies in Intune including the groups they are assigned to:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 1, offset: 0}], inlineStyleRanges: [], key: '5bf6n', text: 'ðŸ“·', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'atjie', text: 'What policies will apply to which devices?', type: 'unstyled'}], entityMap: {0: {data: {alt: 'Devices and group memberships', src: 'https://i.ibb.co/zNwz1nM/Device-Group-Membership.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}, 1: {data: {alt: 'Policy assignments', src: 'https://i.ibb.co/LQ99dsG/Policy-assignments.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>You have a Microsoft 365 tenant with the following devices enrolled in Intune.</p>\n<p><img src="https://i.ibb.co/zNwz1nM/Device-Group-Membership.png" alt="Devices and group memberships" style="height: undefined;width: undefined"/></p>\n<p>You\'ve configured the following compliance policies in Intune including the groups they are assigned to:</p>\n<p><img src="https://i.ibb.co/LQ99dsG/Policy-assignments.png" alt="Policy assignments" style="height: undefined;width: undefined"/></p>\n<p>What policies will apply to which devices?</p>\n', questionText: 'You have a Microsoft 365 tenant with the following devices enrolled in Intune. ðŸ“· You\'ve configured the following compliance policies in Intune including the groups they are assigned to: ðŸ“· What policies will apply to which devices?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'dvf8a', text: 'PolicyA includes Group3 and only affects Android devices so it only affects DeviceA and DeviceC.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'd6b6a', text: 'PolicyB includes Group2 and excludes Group3 and only affects Windows 10 devices so it only affects DeviceD.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 87, offset: 0}], inlineStyleRanges: [], key: '4pu59', text: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>PolicyA includes Group3 and only affects Android devices so it only affects DeviceA and DeviceC.</p>\n<p>PolicyB includes Group2 and excludes Group3 and only affects Windows 10 devices so it only affects DeviceD.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO" target="_self">https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO</a></p>\n', slug: 'what-policies-will-apply--b4n2sr_hb', title: 'What policies will apply to which devices?', type: 'hot-area'}, hgwp50u6i: {answerOptions: {bbclru0zn: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4onp8', text: 'A device compliance policy that has the Device Health settings configured', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>A device compliance policy that has the Device Health settings configured</p>\n', id: 'bbclru0zn'}, h0qzvo7vn: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4ofs3', text: 'A device configuration profile that has device restrictions configured', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>A device configuration profile that has device restrictions configured</p>\n', id: 'h0qzvo7vn'}, 'rtg7-7yzb': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'e4cjb', text: 'A device configuration profile that has the Endpoint Protection settings configured', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>A device configuration profile that has the Endpoint Protection settings configured</p>\n', id: 'rtg7-7yzb'}, txdzvuydbg: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '52df8', text: 'A device configuration policy that has the System Security settings configured', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>A device configuration policy that has the System Security settings configured</p>\n', id: 'txdzvuydbg'}}, id: 'hgwp50u6i', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'g5b0', text: 'You have a Microsoft 365 subscription.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'aqvsl', text: 'All computers run Windows 10 Enterprise and are managed by using Microsoft Intune.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'dp0co', text: 'You plan to view only security-related Windows telemetry data.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2p87k', text: 'You need to ensure that only Windows security data is sent to Microsoft.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9jtd', text: 'What should you create from the Intune admin center?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>You have a Microsoft 365 subscription.</p>\n<p>All computers run Windows 10 Enterprise and are managed by using Microsoft Intune.</p>\n<p>You plan to view only security-related Windows telemetry data.</p>\n<p>You need to ensure that only Windows security data is sent to Microsoft.</p>\n<p>What should you create from the Intune admin center?</p>\n', questionText: 'You have a Microsoft 365 subscription. All computers run Windows 10 Enterprise and are managed by using Microsoft Intune. You plan to view only security-related Windows telemetry data. You need to ensure that only Windows security data is sent to Microsoft. What should you create from the Intune admin center?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9p6qe', text: 'Go to Microsoft Endpoint Manager admin center > Devices > Windows > Configuration profiles. Click Create profile. Set the platform to Windows 10 and later. Set the profile type to templates. Select Device restriction under Template name. Click Create.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 87, offset: 0}], inlineStyleRanges: [], key: '6j4ip', text: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 94, offset: 0}], inlineStyleRanges: [], key: 'ce9ji', text: 'https://docs.microsoft.com/en-us/intune/device-restrictions-windows-10#reporting-and-telemetry', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/intune/device-restrictions-windows-10#reporting-and-telemetry', target: '_blank', url: 'https://docs.microsoft.com/en-us/intune/device-restrictions-windows-10#reporting-and-telemetry'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>Go to Microsoft Endpoint Manager admin center &gt; Devices &gt; Windows &gt; Configuration profiles. Click Create profile. Set the platform to Windows 10 and later. Set the profile type to templates. Select Device restriction under Template name. Click Create.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO" target="_self">https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO</a></p>\n<p><a href="https://docs.microsoft.com/en-us/intune/device-restrictions-windows-10#reporting-and-telemetry" target="_self">https://docs.microsoft.com/en-us/intune/device-restrictions-windows-10#reporting-and-telemetry</a></p>\n', slug: 'only-windows-security-dat-hgwp50u6i', title: 'Only Windows security data is sent to Microsoft', type: 'multiple-choice'}, mb1zd0h2m: {answerOptions: {'4zyziathq': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'bpema', text: 'A conditional access policy in Microsoft Azure Active Directory (Azure AD) that has a client apps condition', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>A conditional access policy in Microsoft Azure Active Directory (Azure AD) that has a client apps condition</p>\n', id: '4zyziathq'}, ac0d7iiioc: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7gvs', text: 'A device compliance policy in Microsoft Endpoint Manager', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>A device compliance policy in Microsoft Endpoint Manager</p>\n', id: 'ac0d7iiioc'}, daojdg8ty: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4gm16', text: 'A conditional access policy in Microsoft Azure Active Directory (Azure AD) that has a device state condition', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>A conditional access policy in Microsoft Azure Active Directory (Azure AD) that has a device state condition</p>\n', id: 'daojdg8ty'}, fmoa3lcgo: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2f36', text: 'An app protection policy in Microsoft Endpoint Manager', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>An app protection policy in Microsoft Endpoint Manager</p>\n', id: 'fmoa3lcgo'}}, id: 'mb1zd0h2m', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'd9bl', text: 'Your company has a Microsoft 365 subscription.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'aa50v', text: 'The company does not permit users to enroll personal devices in mobile device management (MDM).', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4bvgn', text: 'Users in the sales department have personal iOS devices.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1u8vd', text: 'You need to ensure that the sales department users can use the Microsoft Power BI app from iOS devices to access the Power BI data in your tenant.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9u49n', text: 'The users must be prevented from backing up the app data to iCloud.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7d7qr', text: 'What should you create?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your company has a Microsoft 365 subscription.</p>\n<p>The company does not permit users to enroll personal devices in mobile device management (MDM).</p>\n<p>Users in the sales department have personal iOS devices.</p>\n<p>You need to ensure that the sales department users can use the Microsoft Power BI app from iOS devices to access the Power BI data in your tenant.</p>\n<p>The users must be prevented from backing up the app data to iCloud.</p>\n<p>What should you create?</p>\n', questionText: 'Your company has a Microsoft 365 subscription. The company does not permit users to enroll personal devices in mobile device management (MDM). Users in the sales department have personal iOS devices. You need to ensure that the sales department users can use the Microsoft Power BI app from iOS devices to access the Power BI data in your tenant. The users must be prevented from backing up the app data to iCloud. What should you create?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 's5s4', text: 'App protection policies that apply to Microsoft 365 apps, for example, Power BI, will protect apps even if the user is on an unmanaged device.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 98, offset: 0}], inlineStyleRanges: [], key: '73o0v', text: 'https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>App protection policies that apply to Microsoft 365 apps, for example, Power BI, will protect apps even if the user is on an unmanaged device.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx" target="_self">https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx</a></p>\n', slug: 'users-must-be-prevented-f-mb1zd0h2m', title: 'Users must be prevented from backing up the app data to iCloud', type: 'multiple-choice'}, nnup6mvry: {answerOptions: {etlbvw84i: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2tmdp', text: 'From DeviceB, User2 can copy data from AppA to AppC', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>From DeviceB, User2 can copy data from AppA to AppC</p>\n', id: 'etlbvw84i'}, ygtmvgdy7: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6jqvk', text: 'From DeviceB, User1 can copy data from AppA to AppB', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>From DeviceB, User1 can copy data from AppA to AppB</p>\n', id: 'ygtmvgdy7'}, ytt2ybyuo: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5fj6', text: 'From DeviceB, User1 can copy data from AppA to AppC', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>From DeviceB, User1 can copy data from AppA to AppC</p>\n', id: 'ytt2ybyuo'}}, id: 'nnup6mvry', images: ['https://i.ibb.co/RbhYwsM/user-member-of-chart.png', 'https://i.ibb.co/CQHM2Rh/User-platform-chart.png', 'https://i.ibb.co/2dSLJ6r/device-platform-chart.png'], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ct3iv', text: 'Your organization has a Microsoft 365 tenant with a default domain of gitbit.org', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9ptu4', text: 'Your organization\'s Azure AD contains the following users.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: '1lqj9', text: ' ', type: 'atomic'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'h7fu', text: 'Your organization\'s Microsoft Endpoint Manager admin center shows the following devices enrolled.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 1, offset: 0}], inlineStyleRanges: [], key: '8790n', text: ' ', type: 'atomic'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'fr9h4', text: 'Both devices have three apps named AppA, AppB, and AppC installed.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4aic4', text: 'You create an app protection policy named ProtectionPolicyA that has the following settings:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7j5j9', text: 'Protected apps: AppA', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'fdjf5', text: 'Exempt apps: AppB', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ccgm0', text: 'Windows Information Protection mode: Block', type: 'unordered-list-item'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3s2p4', text: 'You apply ProtectionPolicyA to GroupA and GroupC. You exclude GroupB from ProtectionPolicyA.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1nvs7', text: 'Check the box next to each true statement', type: 'unstyled'}], entityMap: {0: {data: {alt: 'User member of chart', src: 'https://i.ibb.co/RbhYwsM/user-member-of-chart.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}, 1: {data: {alt: 'Device platform chart', src: 'https://i.ibb.co/2dSLJ6r/device-platform-chart.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant with a default domain of gitbit.org</p>\n<p>Your organization\'s Azure AD contains the following users.</p>\n<img src="https://i.ibb.co/RbhYwsM/user-member-of-chart.png" alt="User member of chart" style="height: undefined;width: undefined"/>\n<p>Your organization\'s Microsoft Endpoint Manager admin center shows the following devices enrolled.</p>\n<img src="https://i.ibb.co/2dSLJ6r/device-platform-chart.png" alt="Device platform chart" style="height: undefined;width: undefined"/>\n<p>Both devices have three apps named AppA, AppB, and AppC installed.</p>\n<p>You create an app protection policy named ProtectionPolicyA that has the following settings:</p>\n<ul>\n<li>Protected apps: AppA</li>\n<li>Exempt apps: AppB</li>\n<li>Windows Information Protection mode: Block</li>\n</ul>\n<p>You apply ProtectionPolicyA to GroupA and GroupC. You exclude GroupB from ProtectionPolicyA.</p>\n<p>Check the box next to each true statement</p>\n', questionText: 'Your organization has a Microsoft 365 tenant with a default domain of gitbit.org Your organization\'s Azure AD contains the following users. Your organization\'s Microsoft Endpoint Manager admin center shows the following devices enrolled. Both devices have three apps named AppA, AppB, and AppC installed. You create an app protection policy named ProtectionPolicyA that has the following settings: Protected apps: AppA Exempt apps: AppB Windows Information Protection mode: Block You apply ProtectionPolicyA to GroupA and GroupC. You exclude GroupB from ProtectionPolicyA. Check the box next to each true statement', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '58o7s', text: 'Since User2 is a member of Group2 and Group2 is excluded from the policy User2 can copy data from AppA to AppC.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4snmr', text: 'Since AppB is exempt from the policy User1 can copy data from AppA to AppB.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9vqv0', text: 'Since User1 is a member of Group1 and Group1 is included in the app protection policy and User1 is not a member of Group2. And since AppA is protected by the app protection policy and AppC is not exempt User1 cannot copy data from AppA to AppC.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 98, offset: 0}], inlineStyleRanges: [], key: 'a4t9q', text: 'https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>Since User2 is a member of Group2 and Group2 is excluded from the policy User2 can copy data from AppA to AppC.</p>\n<p>Since AppB is exempt from the policy User1 can copy data from AppA to AppB.</p>\n<p>Since User1 is a member of Group1 and Group1 is included in the app protection policy and User1 is not a member of Group2. And since AppA is protected by the app protection policy and AppC is not exempt User1 cannot copy data from AppA to AppC.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx" target="_self">https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx</a></p>\n', slug: 'which-apps-apply-to-which-nnup6mvry', title: 'Which apps apply to which devices', type: 'multiple-choice'}, 'pwbwlx-fw': {answerOptions: {jpeojaqrj: {answerHtml: '', answers: {i2hwdl6yu: {id: 'i2hwdl6yu', text: 'DeviceA and DeviceB'}, jk3oqewve: {id: 'jk3oqewve', text: 'DeviceA and DeviceC'}, rkreyf2t3: {id: 'rkreyf2t3', text: 'DeviceA, DeviceB, and DeviceC only'}, 'xs-fks0cp': {id: 'xs-fks0cp', text: 'DeviceA, DeviceB, DeviceC, and DeviceD'}}, id: 'jpeojaqrj', text: 'Auto-unlock'}, 'vu_d-htvc': {answerHtml: '', answers: {_lytkgezv: {id: '_lytkgezv', text: 'DeviceA, DeviceB, and DeviceC only'}, gmcgry63n: {id: 'gmcgry63n', text: 'DeviceA and DeviceB only'}, neo3jw61c: {id: 'neo3jw61c', text: 'DeviceA, DeviceB, DeviceC, and DeviceD'}, rdcps2jpd: {id: 'rdcps2jpd', text: 'DeviceA only'}}, id: 'vu_d-htvc', text: 'BitLocker to Go'}}, answerText: 'DeviceA, DeviceB, DeviceC, and DeviceD. DeviceA and DeviceC.', id: 'pwbwlx-fw', images: ['https://i.ibb.co/h85Bsdc/Device-Bit-Locker-Chart.png'], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '80oa9', text: 'Your organization has a Microsoft 365 tenant with a primary domain of gitbit.org', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'bs6kv', text: 'The following Windows 10 devices are joined to Azure AD.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: 'alnci', text: ' ', type: 'atomic'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2b2c5', text: 'What devices can you use BitLocker to Go?', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'acoo7', text: 'What devices can you turn on auto-unlock?', type: 'unstyled'}], entityMap: {0: {data: {alt: 'Device BitLocker chart', src: 'https://i.ibb.co/h85Bsdc/Device-Bit-Locker-Chart.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant with a primary domain of gitbit.org</p>\n<p>The following Windows 10 devices are joined to Azure AD.</p>\n<img src="https://i.ibb.co/h85Bsdc/Device-Bit-Locker-Chart.png" alt="Device BitLocker chart" style="height: undefined;width: undefined"/>\n<p>What devices can you use BitLocker to Go?</p>\n<p>What devices can you turn on auto-unlock?</p>\n', questionText: 'Your organization has a Microsoft 365 tenant with a primary domain of gitbit.org The following Windows 10 devices are joined to Azure AD. What devices can you use BitLocker to Go? What devices can you turn on auto-unlock?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'cqc58', text: 'Bitlocker to Go is Bitlocker for removable media. It is possible to encrypt removable media with Intune. You don\'t even need TPM on the Windows device. In short, you use Intune to protect removable media and then configure Bitlocker to require a passcode.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '93ger', text: 'Bitlocker auto-unlock is also available through Intune. Bitlocker auto-unlock will automatically unlock data drives (for example a D: drive) when the OS drive (for example a C: drive) is unlocked. Bitlocker auto-unlock does not require TPM but it does require the OS drive to be encrypted.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 87, offset: 0}], inlineStyleRanges: [], key: '11voa', text: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>Bitlocker to Go is Bitlocker for removable media. It is possible to encrypt removable media with Intune. You don\'t even need TPM on the Windows device. In short, you use Intune to protect removable media and then configure Bitlocker to require a passcode.</p>\n<p>Bitlocker auto-unlock is also available through Intune. Bitlocker auto-unlock will automatically unlock data drives (for example a D: drive) when the OS drive (for example a C: drive) is unlocked. Bitlocker auto-unlock does not require TPM but it does require the OS drive to be encrypted.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO" target="_self">https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO</a></p>\n', slug: 'what-devices-can-you-turn-pwbwlx-fw', title: 'What devices can you turn on auto-unlock or BitLocker to Go?', type: 'hot-area'}, qinpocpcr: {answerOptions: {'9dvhkw-f-o': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '2s74s', text: 'Run tdadm.exe on all the computers', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Run tdadm.exe on all the computers</p>\n', id: '9dvhkw-f-o'}, enbqrhb5v: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'bi2vb', text: 'Configure a registry value on all the computers', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Configure a registry value on all the computers</p>\n', id: 'enbqrhb5v'}, gt4beadzj: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'c20kv', text: 'On ServerA, run readiness-report-creator.exe', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>On ServerA, run readiness-report-creator.exe</p>\n', id: 'gt4beadzj'}, wi6eej5st: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9r72n', text: 'Configure a registry value on ServerA', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Configure a registry value on ServerA</p>\n', id: 'wi6eej5st'}}, id: 'qinpocpcr', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9g88m', text: 'Your organization has Microsoft 365 tenant configured with a hybrid on-premises Exchange server.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'f7bhl', text: 'All computers in the organization run Windows 10 Enterprise, are joined to the domain, and use Microsoft Office 365 ProPlus.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ceu5d', text: 'You have a server named ServerA that runs Windows Server 2016 and hosts the telemetry database. You\'ve been tasked with preventing private details in the telemetry data from being sent to Microsoft.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '25ck2', text: 'What should you do?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your organization has Microsoft 365 tenant configured with a hybrid on-premises Exchange server.</p>\n<p>All computers in the organization run Windows 10 Enterprise, are joined to the domain, and use Microsoft Office 365 ProPlus.</p>\n<p>You have a server named ServerA that runs Windows Server 2016 and hosts the telemetry database. You\'ve been tasked with preventing private details in the telemetry data from being sent to Microsoft.</p>\n<p>What should you do?</p>\n', questionText: 'Your organization has Microsoft 365 tenant configured with a hybrid on-premises Exchange server. All computers in the organization run Windows 10 Enterprise, are joined to the domain, and use Microsoft Office 365 ProPlus. You have a server named ServerA that runs Windows Server 2016 and hosts the telemetry database. You\'ve been tasked with preventing private details in the telemetry data from being sent to Microsoft. What should you do?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'bmm0j', text: 'To obscure files / telemetry data sent to Microsoft create the following registry dword on each computer:', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'e0ggu', text: 'Path: HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\16.0\\osm', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8cstp', text: 'Value Name: EnableFileObfuscation', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '4hpmu', text: 'Value: 00000001', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 87, offset: 0}], inlineStyleRanges: [], key: '5184v', text: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 112, offset: 0}], inlineStyleRanges: [], key: '65gh4', text: 'https://docs.microsoft.com/en-us/deployoffice/compat/manage-the-privacy-of-data-monitored-by-telemetry-in-office', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/deployoffice/compat/manage-the-privacy-of-data-monitored-by-telemetry-in-office', target: '_blank', url: 'https://docs.microsoft.com/en-us/deployoffice/compat/manage-the-privacy-of-data-monitored-by-telemetry-in-office'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>To obscure files / telemetry data sent to Microsoft create the following registry dword on each computer:</p>\n<p>Path: HKEY_CURRENT_USER\\\\Software\\\\Policies\\\\Microsoft\\\\Office\\\\16.0\\\\osm</p>\n<p>Value Name: EnableFileObfuscation</p>\n<p>Value: 00000001</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO" target="_self">https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO</a></p>\n<p><a href="https://docs.microsoft.com/en-us/deployoffice/compat/manage-the-privacy-of-data-monitored-by-telemetry-in-office" target="_self">https://docs.microsoft.com/en-us/deployoffice/compat/manage-the-privacy-of-data-monitored-by-telemetry-in-office</a></p>\n', slug: 'prevent-private-details-i-qinpocpcr', title: 'Prevent private details in the telemetry data from being sent to Microsoft', type: 'multiple-choice'}, vd2rcs8ng: {answerOptions: {'9o0d_oa0o': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '244g6', text: 'Device configuration profile > Windows Defender for Endpoint', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Device configuration profile &gt; Windows Defender for Endpoint</p>\n', id: '9o0d_oa0o'}, aimcecnko: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ck6sm', text: 'Device configuration profile > Device restrictions', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Device configuration profile &gt; Device restrictions</p>\n', id: 'aimcecnko'}, blzp3fuyw: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'c667v', text: 'Device configuration profile > Endpoint protection', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Device configuration profile &gt; Endpoint protection</p>\n', id: 'blzp3fuyw'}, gr6mqdru7l: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'duq25', text: 'Device configuration profile > Identity protection', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>Device configuration profile &gt; Identity protection</p>\n', id: 'gr6mqdru7l'}}, id: 'vd2rcs8ng', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1gtbg', text: 'Your organization has a Microsoft 365 tenant with devices registered in Azure AD. The devices are managed by using Microsoft Intune.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '7fv9b', text: 'Your manager asks you to enable and configure Windows Defender Exploit Guard (Windows Defender EG) on the devices.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '6l4k0', text: 'Which type of device configuration profile should you use?', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant with devices registered in Azure AD. The devices are managed by using Microsoft Intune.</p>\n<p>Your manager asks you to enable and configure Windows Defender Exploit Guard (Windows Defender EG) on the devices.</p>\n<p>Which type of device configuration profile should you use?</p>\n', questionText: 'Your organization has a Microsoft 365 tenant with devices registered in Azure AD. The devices are managed by using Microsoft Intune. Your manager asks you to enable and configure Windows Defender Exploit Guard (Windows Defender EG) on the devices. Which type of device configuration profile should you use?', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'cmsij', text: 'You need to create an endpoint protection configuration policy to configure Windows Defender Exploit Guard', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 87, offset: 0}], inlineStyleRanges: [], key: '2plic', text: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 82, offset: 0}], inlineStyleRanges: [], key: '4kpsp', text: 'https://docs.microsoft.com/en-us/mem/intune/protect/endpoint-protection-windows-10', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/mem/intune/protect/endpoint-protection-windows-10', target: '_blank', url: 'https://docs.microsoft.com/en-us/mem/intune/protect/endpoint-protection-windows-10'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>You need to create an endpoint protection configuration policy to configure Windows Defender Exploit Guard</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO" target="_self">https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO</a></p>\n<p><a href="https://docs.microsoft.com/en-us/mem/intune/protect/endpoint-protection-windows-10" target="_self">https://docs.microsoft.com/en-us/mem/intune/protect/endpoint-protection-windows-10</a></p>\n', slug: 'enable-windows-defender-e-vd2rcs8ng', title: 'Enable Windows Defender Exploit Guard on the devices', type: 'multiple-choice'}, wnqkaopkl: {answerOptions: {ckr36lps6: {answer: 'Click Device Settings', answerHtml: '', id: 'ckr36lps6'}, ddbmv2cfc: {answer: 'Open the Microsoft Azure AD Admin Center', answerHtml: '', id: 'ddbmv2cfc'}, lgyaewxkz: {answer: 'Go to Devices', answerHtml: '', id: 'lgyaewxkz'}}, id: 'wnqkaopkl', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '17egh', text: 'Your manager has asked you to set up the Microsoft 365 tenant so users can only join 5 devices to the tenant.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '24p0v', text: 'What do you need to do to configure it?', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ce8qm', text: 'Put the answers in the correct order', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your manager has asked you to set up the Microsoft 365 tenant so users can only join 5 devices to the tenant.</p>\n<p>What do you need to do to configure it?</p>\n<p>Put the answers in the correct order</p>\n', questionText: 'Your manager has asked you to set up the Microsoft 365 tenant so users can only join 5 devices to the tenant. What do you need to do to configure it? Put the answers in the correct order', references: {blocks: [{data: {}, depth: 0, entityRanges: [{key: 0, length: 69, offset: 0}], inlineStyleRanges: [], key: '6cdg6', text: 'https://www.iorad.com/player/1795886/MS-500---Limit-user-devices-to-5', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5c8sh', text: 'Go to Azure AD admin center > Devices > Device Settings. Set the Maximum number of devices setting to 5. Click Save.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 75, offset: 0}], inlineStyleRanges: [], key: '1eeot', text: 'https://www.gitbit.org/course/ms-500/learn/Introduction-to-Intune-7gR3L122b', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 2, length: 222, offset: 0}], inlineStyleRanges: [], key: '6kdk0', text: 'https://docs.microsoft.com/en-us/azure/active-directory/devices/device-management-azure-portal https://docs.microsoft.com/en-us/microsoft-365/compliance/use-your-free-azure-ad-subscription-in-office-365?view=o365-worldwide', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.iorad.com/player/1795886/MS-500---Limit-user-devices-to-5', target: '_blank', url: 'https://www.iorad.com/player/1795886/MS-500---Limit-user-devices-to-5'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Introduction-to-Intune-7gR3L122b', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Introduction-to-Intune-7gR3L122b'}, mutability: 'MUTABLE', type: 'LINK'}, 2: {data: {href: 'https://docs.microsoft.com/en-us/azure/active-directory/devices/device-management-azure-portal', target: '_blank', url: 'https://docs.microsoft.com/en-us/azure/active-directory/devices/device-management-azure-portal'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p><a href="https://www.iorad.com/player/1795886/MS-500---Limit-user-devices-to-5" target="_self">https://www.iorad.com/player/1795886/MS-500---Limit-user-devices-to-5</a></p>\n<p>Go to Azure AD admin center &gt; Devices &gt; Device Settings. Set the Maximum number of devices setting to 5. Click Save.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Introduction-to-Intune-7gR3L122b" target="_self">https://www.gitbit.org/course/ms-500/learn/Introduction-to-Intune-7gR3L122b</a></p>\n<p><a href="https://docs.microsoft.com/en-us/azure/active-directory/devices/device-management-azure-portal" target="_self">https://docs.microsoft.com/en-us/azure/active-directory/devices/device-management-azure-portal https://docs.microsoft.com/en-us/microsoft-365/compliance/use-your-free-azure-ad-subscription-in-office-365?view=o365-worldwide</a></p>\n', slug: 'set-up-the-microsoft-365--wnqkaopkl', title: 'Set up the Microsoft 365 tenant so users can only join 5 devices to the tenant', type: 'build-list'}, x6xvi1brv: {answerOptions: {'6injnosja': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'ds097', text: 'If UserA uses DeviceA, PolicyC applies', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>If UserA uses DeviceA, PolicyC applies</p>\n', id: '6injnosja'}, o0q0miox1: {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1gbs3', text: 'When UserB uses DeviceA, PolicyB applies', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>When UserB uses DeviceA, PolicyB applies</p>\n', id: 'o0q0miox1'}, 'rhn-gveksk': {answer: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'c5oho', text: 'When UserB uses DeviceB, PolicyD applies', type: 'unstyled'}], entityMap: {}}, answerHtml: '<p>When UserB uses DeviceB, PolicyD applies</p>\n', id: 'rhn-gveksk'}}, answerText: 'When UserB uses DeviceA, PolicyB applies.', id: 'x6xvi1brv', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5qo5j', text: 'Your organization has a Microsoft 365 tenant named GitBit.org that contains the following users.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: 'bkpn4', text: 'ðŸ“·', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'e5bfs', text: 'Your organization has registered the following devices in Azure AD.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 1, offset: 0}], inlineStyleRanges: [], key: '6h1oo', text: 'ðŸ“·', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'atces', text: 'You create the app protection policies in the Microsoft Endpoint Manager admin center as shown below.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 2, length: 1, offset: 0}], inlineStyleRanges: [], key: '3onib', text: 'ðŸ“·', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5lmnn', text: 'Check the box next to each true statement below.', type: 'unstyled'}], entityMap: {0: {data: {alt: 'Chart showing 2 users with their group membership', src: 'https://i.ibb.co/Lk75D86/user-and-group-membership.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}, 1: {data: {alt: 'Chart showing devices, platform, and membership', src: 'https://i.ibb.co/cTP8vKV/device-chart.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}, 2: {data: {alt: 'Chart showing the app protection policies and their assignments', src: 'https://i.ibb.co/GnwXkhx/App-Protection-Policies-Assignment.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant named GitBit.org that contains the following users.</p>\n<p><img src="https://i.ibb.co/Lk75D86/user-and-group-membership.png" alt="Chart showing 2 users with their group membership" style="height: undefined;width: undefined"/></p>\n<p>Your organization has registered the following devices in Azure AD.</p>\n<p><img src="https://i.ibb.co/cTP8vKV/device-chart.png" alt="Chart showing devices, platform, and membership" style="height: undefined;width: undefined"/></p>\n<p>You create the app protection policies in the Microsoft Endpoint Manager admin center as shown below.</p>\n<p><img src="https://i.ibb.co/GnwXkhx/App-Protection-Policies-Assignment.png" alt="Chart showing the app protection policies and their assignments" style="height: undefined;width: undefined"/></p>\n<p>Check the box next to each true statement below.</p>\n', questionText: 'Your organization has a Microsoft 365 tenant named GitBit.org that contains the following users. ðŸ“· Your organization has registered the following devices in Azure AD. ðŸ“· You create the app protection policies in the Microsoft Endpoint Manager admin center as shown below. ðŸ“· Check the box next to each true statement below.', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1ih2u', text: 'Since PolicyC applies to iOS and DeviceA is a Windows 10 device PolicyC does not apply.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'f8u5m', text: 'Since UserB is a member of GroupB and PolicyB does apply to Windows 10 devices, PolicyB applies to UserB on DeviceA.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '8ojr9', text: 'UserB isn\'t a member of GroupB and since you need to have users as part of the protected group PolicyD does not apply to DeviceB / UserB.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 98, offset: 0}], inlineStyleRanges: [], key: 'e341p', text: 'https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 66, offset: 0}], inlineStyleRanges: [], key: '5cc44', text: 'https://docs.microsoft.com/en-us/intune/apps/app-protection-policy', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/intune/apps/app-protection-policy', target: '_blank', url: 'https://docs.microsoft.com/en-us/intune/apps/app-protection-policy'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>Since PolicyC applies to iOS and DeviceA is a Windows 10 device PolicyC does not apply.</p>\n<p>Since UserB is a member of GroupB and PolicyB does apply to Windows 10 devices, PolicyB applies to UserB on DeviceA.</p>\n<p>UserB isn\'t a member of GroupB and since you need to have users as part of the protected group PolicyD does not apply to DeviceB / UserB.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx" target="_self">https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx</a></p>\n<p><a href="https://docs.microsoft.com/en-us/intune/apps/app-protection-policy" target="_self">https://docs.microsoft.com/en-us/intune/apps/app-protection-policy</a></p>\n', slug: 'create-the-app-protection-x6xvi1brv', title: 'Create the app protection policies in the Microsoft Endpoint Manager', type: 'multiple-choice'}, xooagjtsu: {answerOptions: {kvsdtb1cn: {answerHtml: '', answers: {'aolmuej8-': {id: 'aolmuej8-', text: 'the user will receive a security warning'}, oees9mvki: {id: 'oees9mvki', text: 'the webpage will be blocked from opening'}, shgxvnh2t: {id: 'shgxvnh2t', text: 'the webpage will open without warning'}}, id: 'kvsdtb1cn', text: 'When a member of the Intune Endpoint Protection group opens a site that\'s flagged as dangerous,'}, 'z4wu7-7gc': {answerHtml: '', answers: {h3uwobxbz: {id: 'h3uwobxbz', text: 'the user will receive a security warning'}, v_efa6qg8: {id: 'v_efa6qg8', text: 'the webpage will open without warning'}, w38x1fozv: {id: 'w38x1fozv', text: 'the webpage will be blocked from opening'}}, id: 'z4wu7-7gc', text: 'When a member of the Intune Help Desk Operators group opens a site that\'s flagged as dangerous,'}}, id: 'xooagjtsu', images: ['https://i.ibb.co/g4d75rX/endpoint-security.png'], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'b0fhq', text: 'You have a Microsoft 365 tenant with Defender for Endpoint. Intune is set up and installed on your Windows 10 devices.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '5po7u', text: 'You open the Microsoft Endpoint Manager admin center and create an attack surface reduction policy. The policy is shown in the image below.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 1, offset: 0}], inlineStyleRanges: [], key: '1v3fb', text: ' ', type: 'atomic'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'behtm', text: 'Use the dropdowns below to complete the statement.', type: 'unstyled'}], entityMap: {0: {data: {alt: 'Endpoint security', src: 'https://i.ibb.co/g4d75rX/endpoint-security.png'}, mutability: 'IMMUTABLE', type: 'IMAGE'}}}, questionHtml: '<p>You have a Microsoft 365 tenant with Defender for Endpoint. Intune is set up and installed on your Windows 10 devices.</p>\n<p>You open the Microsoft Endpoint Manager admin center and create an attack surface reduction policy. The policy is shown in the image below.</p>\n<img src="https://i.ibb.co/g4d75rX/endpoint-security.png" alt="Endpoint security" style="height: undefined;width: undefined"/>\n<p>Use the dropdowns below to complete the statement.</p>\n', questionText: 'You have a Microsoft 365 tenant with Defender for Endpoint. Intune is set up and installed on your Windows 10 devices. You open the Microsoft Endpoint Manager admin center and create an attack surface reduction policy. The policy is shown in the image below. Use the dropdowns below to complete the statement.', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '1n9ej', text: 'The Intune EndPoint Protection group is included in the policy so SmartScreen will be enabled and display a warning.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'mh9r', text: 'The Intune Help Desk Operators group is excluded from the policy so SmartScreen will be disabled so no warning will be displayed.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 87, offset: 0}], inlineStyleRanges: [], key: '21m42', text: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>The Intune EndPoint Protection group is included in the policy so SmartScreen will be enabled and display a warning.</p>\n<p>The Intune Help Desk Operators group is excluded from the policy so SmartScreen will be disabled so no warning will be displayed.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO" target="_self">https://www.gitbit.org/course/ms-500/learn/How-to-manage-devices-using-Intune-_LL9VqGZO</a></p>\n', slug: 'create-an-attack-surface--xooagjtsu', title: 'Create an attack surface reduction policy', type: 'hot-area'}, zp50exmma: {answerOptions: {f7unwy3fm: {answerHtml: '', answers: {'4hxcqgcjpm': {id: '4hxcqgcjpm', text: 'New-ClientAccessRule and Test-ClientAccessRule'}, bwglkc9yt: {id: 'bwglkc9yt', text: 'Get-CASMailbox and Set-CASMailbox'}, yo2p084qe: {id: 'yo2p084qe', text: 'New-OwaMailboxPolicy and Set-OwaMailboxPolicy'}}, id: 'f7unwy3fm', text: 'From PowerShell connect to Exchange Online and run:'}, wixzdg8gj: {answerHtml: '', answers: {'9n-vcsest': {id: '9n-vcsest', text: 'The group, the cloud app, and set the conditions settings'}, m5gd_nxtu: {id: 'm5gd_nxtu', text: 'The group, the cloud app, and enable app enforced restrictions'}, yqij35vdye: {id: 'yqij35vdye', text: 'The group, the conditions settings, and enable app enforced'}}, id: 'wixzdg8gj', text: 'From the Azure AD admin center, create a conditional access policy and configure:'}}, id: 'zp50exmma', images: [], question: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '3vkio', text: 'Your organization has a Microsoft 365 tenant. Your manager has asked you to set up app-enforced restrictions for 20 users so they can\'t download attachments unless they are on a compliant device. From the Azure AD admin center, you create a security group called GroupA.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: 'f9964', text: 'What are the next two steps you need to take?', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '9ngfm', text: 'Select the correct options below.', type: 'unstyled'}], entityMap: {}}, questionHtml: '<p>Your organization has a Microsoft 365 tenant. Your manager has asked you to set up app-enforced restrictions for 20 users so they can\'t download attachments unless they are on a compliant device. From the Azure AD admin center, you create a security group called GroupA.</p>\n<p>What are the next two steps you need to take?</p>\n<p>Select the correct options below.</p>\n', questionText: 'Your organization has a Microsoft 365 tenant. Your manager has asked you to set up app-enforced restrictions for 20 users so they can\'t download attachments unless they are on a compliant device. From the Azure AD admin center, you create a security group called GroupA. What are the next two steps you need to take? Select the correct options below.', references: {blocks: [{data: {}, depth: 0, entityRanges: [], inlineStyleRanges: [], key: '73ht9', text: 'First, you need to create a conditional access policy that will set app-enforced restrictions in the sessions section. Then create an OWA Mailbox Policy and set the OWA Mailbox Policy. Finally, you assign the OWA Mailbox Policy to users.', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 0, length: 98, offset: 0}], inlineStyleRanges: [], key: 'abti2', text: 'https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx', type: 'unstyled'}, {data: {}, depth: 0, entityRanges: [{key: 1, length: 103, offset: 0}], inlineStyleRanges: [], key: '6fjvs', text: 'https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/app-based-conditional-access', type: 'unstyled'}], entityMap: {0: {data: {href: 'https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx', target: '_blank', url: 'https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx'}, mutability: 'MUTABLE', type: 'LINK'}, 1: {data: {href: 'https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/app-based-conditional-access', target: '_blank', url: 'https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/app-based-conditional-access'}, mutability: 'MUTABLE', type: 'LINK'}}}, referencesHtml: '<p>First, you need to create a conditional access policy that will set app-enforced restrictions in the sessions section. Then create an OWA Mailbox Policy and set the OWA Mailbox Policy. Finally, you assign the OWA Mailbox Policy to users.</p>\n<p><a href="https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx" target="_self">https://www.gitbit.org/course/ms-500/learn/Restricting-and-managing-apps-on-user-devices-62t_7oiZx</a></p>\n<p><a href="https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/app-based-conditional-access" target="_self">https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/app-based-conditional-access</a></p>\n', slug: 'how-to-setup-appenforced--zp50exmma', title: 'How to setup app-enforced restrictions', type: 'hot-area'}}, sectionId: 'l0DxUuonW', slug: 'protecting-user-devices-using-intune-bzzocmdmd', title: 'Protecting user devices using Intune', type: 'test'},
      questionsShown: false
    }

    this.state.userAcct = {tests: {
      [this.state.test.id]: {
        [this.state.question.id]: {answers: {}}
      }
    }}

    this.state.questionIdx = Object.keys(this.state.test.questions).indexOf(this.state.question.id)
    this.state.previousQuestionSlug = this.state.questionIdx > 0 ? Object.values(this.state.test.questions)[this.state.questionIdx-1].slug : ''
    this.state.nextQuestionSlug = Object.values(this.state.test.questions).length-1 == this.state.questionIdx ? '' : Object.values(this.state.test.questions)[this.state.questionIdx+1].slug

    this.state.jsonLd = {
      datePublished: this.state.test.datePublished,
      keywords: [
        'Microsoft',
        'Microsoft 365',
        'Office 365',
        'MS-500',
        'Microsoft 365 Security Administration'
      ],
      mainEntity: {
        '@type': 'Question',
        name: this.state.question.title,
        text: this.state.question.questionText,
        answerCount: this.state.test.answers ? Object.keys(this.state.test.answers[this.state.question.id]).length : 0,
        dateCreated: this.state.test.datePublished,
        author: {
          '@type': 'Person',
          name: 'John Gruber',
          url: 'https://twitter.com/gruberjl'
        }
      }
    }

    if (this.state.test.answers) {
      this.state.jsonLd.mainEntity.acceptedAnswer = {
        '@type': 'Answer',
        url: `https://www.gitbit.org/course/ms-500/test/${this.state.test.slug}/question/${this.state.question.slug}`,
        author: {
          type: 'Person',
          name: 'John Gruber',
          url: 'https://twitter.com/gruberjl'
        },
        upvoteCount: 1,
        dateCreated: this.state.test.datePublished
      }

      this.state.jsonLd.mainEntity.acceptedAnswer.text = 'None'
    }
  }

  componentDidMount() {
    if (isBrowser()) {
      this.onAuthStateChangedListener = onAuthStateChanged(this.setUid)
      window.addEventListener('beforeunload', this.beforeUnload)
    }
  }

  componentWillUnmount() {
    this.onAuthStateChangedListener()
    window.removeEventListener('beforeunload', this.beforeUnload)
  }

  setUid(user) {
    if (user) {
      this.setState({
        uid: user.uid
      })

      getDoc('courses/MS-500/users', user.uid).then((userAcct) => {
        if (!userAcct.tests)
          userAcct.tests = {}

        if (!userAcct.tests[this.state.test.id])
          userAcct.tests[this.state.test.id] = {}

        if (!userAcct.tests[this.state.test.id][this.state.question.id]) {
          userAcct.tests[this.state.test.id][this.state.question.id] = {
            id: this.state.question.id,
            answers: {}
          }
        }

        this.setState({userAcct})
      })
    }
  }

  toggleEndExam() {
    const endExamShown = !this.state.endExamShown
    this.setState({endExamShown})
  }

  toggleShowAnswer() {
    const answerShown = !this.state.answerShown
    this.setState({answerShown})
  }

  toggleQuestionList() {
    const showQuestionList = !this.state.showQuestionList
    this.setState({showQuestionList})
  }

  gotoQuestion(question) {
    return () => {
      this.navigateTo(`/course/ms-500/test/${this.state.test.slug}/question/${question.slug}`)()
    }
  }

  setAnswer(answers) {
    const userAcct = clone(this.state.userAcct)
    userAcct.tests[this.state.test.id][this.state.question.id].answers = answers

    this.setState({userAcct, unsavedChanges: true})
    if (!this.debounceSave)
      this.debounceSave = debounce(this.save, 5000)

    this.debounceSave()
  }

  beforeUnload() {
    if (this.state.unsavedChanges) {
      const s = 'You have unsaved changes. Really leave?'
      this.save()

      event = event || window.event // eslint-disable-line no-global-assign
      if (event)
        event.returnValue = s

      return s
    }
  }

  save() {
    if (this.state.uid) {
      return saveDoc(`courses/MS-500/users`, this.state.userAcct, false).then(() => {
        return new Promise((resolve, reject) => {
          this.setState({
            alert: 'Content saved',
            unsavedChanges: false
          }, () => {
            return resolve()
          })

          setTimeout(() => {
            this.setState({alert: ''})
          }, 3000)
        })
      })
    } return new Promise((res) => res())
  }

  endExam() {
    this.navigateTo(`/course/ms-500/test/${this.state.test.slug}/summary`)()
  }

  navigateTo(url) {
    return (ev) => {
      if (this.state.unsavedChanges) {
        if (ev)
          ev.preventDefault()

        this.save().then(() => {
          window.location.href = url
        })
      } else
        window.location.href = url
    }
  }

  render() {
    return (
      <Page jsonLdType={'QAPage'} jsonLd={this.state.jsonLd} title={this.state.question.title} description={this.state.question.questionText}>
        <main>
          <Container>
            <Header uid={this.state.uid} questionIdx={this.state.questionIdx} previousQuestionSlug={this.state.previousQuestionSlug} nextQuestionSlug={this.state.nextQuestionSlug} testSlug={this.state.test.slug} toggleEndExam={this.toggleEndExam} numOfQuestions={Object.values(this.state.test.questions).length} navigateTo={this.navigateTo} />
            {
              {
                'multiple-choice': <Choice question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />,
                'hot-area': <HotArea question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />,
                'build-list': <BuildList question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />,
                'drag-drop': <DragDrop question={this.state.question} setAnswer={this.setAnswer} answers={this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers} testAnswers={this.state.test.answers[this.state.question.id]} showAnswers={this.state.answerShown} />
              }[this.state.question.type]
            }
            <Grid container>
              <Grid item xs={12} style={{display: this.state.answerShown ? 'block' : 'none'}} >
                <Typography variant="h5" component="h3" gutterBottom>Answer Explanation</Typography>
              </Grid>
              <Grid item xs={12}>
                <div dangerouslySetInnerHTML={{__html: this.state.question.referencesHtml}} style={{display: this.state.answerShown ? 'block' : 'none'}} />
              </Grid>
            </Grid>
            <Footer uid={this.state.uid} previousQuestionSlug={this.state.previousQuestionSlug} nextQuestionSlug={this.state.nextQuestionSlug} testSlug={this.state.test.slug} toggleEndExam={this.toggleEndExam} toggleShowAnswer={this.toggleShowAnswer} toggleQuestionList={this.toggleQuestionList} navigateTo={this.navigateTo} />
          </Container>

          <Dialog onClose={this.toggleQuestionList} open={this.state.showQuestionList}>
            <DialogTitle>Test Questions</DialogTitle>
            <TableContainer>
              <Table striped bordered hover>
                <TableHead>
                  <TableRow>
                    <TableCell>#</TableCell>
                    <TableCell>Answered</TableCell>
                    <TableCell>Question</TableCell>
                  </TableRow>
                </TableHead>
                <TableBody>
                  { Object.values(this.state.test.questions).map((question, idx) => (
                    <TableRow hover key={idx} onClick={this.gotoQuestion(question)} style={{cursor: 'pointer'}}>
                      <TableCell>{idx+1}</TableCell>
                      <TableCell><Checkbox checked={Object.values(this.state.userAcct.tests[this.state.test.id][this.state.question.id].answers).length > 0} /></TableCell>
                      <TableCell>{question.title}</TableCell>
                    </TableRow>
                  ))}
                </TableBody>
              </Table>
            </TableContainer>
          </Dialog>

          <Dialog onClose={this.toggleEndExam} open={this.state.endExamShown}>
            <DialogTitle>Are you sure?</DialogTitle>
            <DialogContent>
              <DialogContentText>Are you sure you want to end the exam?</DialogContentText>
            </DialogContent>
            <DialogActions>
              <Button variant="contained" onClick={this.endExam}>
                Yes
              </Button>
              <Button variant="outlined" onClick={this.toggleEndExam}>
                No
              </Button>
            </DialogActions>
          </Dialog>
        </main>
        <Snackbar message={this.state.alert} open={this.state.alert !== ''} />
      </Page>
    )
  }
}

export default EditPage
